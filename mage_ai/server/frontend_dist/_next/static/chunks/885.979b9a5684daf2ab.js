(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[885],{39584:function(e){"use strict";function t(e,t,r){e instanceof RegExp&&(e=i(e,r)),t instanceof RegExp&&(t=i(t,r));var o=n(e,t,r);return o&&{start:o[0],end:o[1],pre:r.slice(0,o[0]),body:r.slice(o[0]+e.length,o[1]),post:r.slice(o[1]+t.length)}}function i(e,t){var i=t.match(e);return i?i[0]:null}function n(e,t,i){var n,r,o,s,a,c=i.indexOf(e),u=i.indexOf(t,c+1),l=c;if(c>=0&&u>0){if(e===t)return[c,u];for(n=[],o=i.length;l>=0&&!a;)l==c?(n.push(l),c=i.indexOf(e,l+1)):1==n.length?a=[n.pop(),u]:((r=n.pop())<o&&(o=r,s=u),u=i.indexOf(t,l+1)),l=c<u&&c>=0?c:u;n.length&&(a=[o,s])}return a}e.exports=t,t.range=n},77562:function(e,t,i){var n=i(39584);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return m(function(e){return e.split("\\\\").join(r).split("\\{").join(o).split("\\}").join(s).split("\\,").join(a).split("\\.").join(c)}(e),!0).map(l)};var r="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",s="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function l(e){return e.split(r).join("\\").split(o).join("{").split(s).join("}").split(a).join(",").split(c).join(".")}function d(e){if(!e)return[""];var t=[],i=n("{","}",e);if(!i)return e.split(",");var r=i.pre,o=i.body,s=i.post,a=r.split(",");a[a.length-1]+="{"+o+"}";var c=d(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),t.push.apply(t,a),t}function h(e){return"{"+e+"}"}function g(e){return/^-?0\d/.test(e)}function f(e,t){return e<=t}function p(e,t){return e>=t}function m(e,t){var i=[],r=n("{","}",e);if(!r)return[e];var o=r.pre,a=r.post.length?m(r.post,!1):[""];if(/\$$/.test(r.pre))for(var c=0;c<a.length;c++){var l=o+"{"+r.body+"}"+a[c];i.push(l)}else{var v,y,C=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),w=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),S=C||w,R=r.body.indexOf(",")>=0;if(!S&&!R)return r.post.match(/,.*\}/)?m(e=r.pre+"{"+r.body+s+r.post):[e];if(S)v=r.body.split(/\.\./);else if(1===(v=d(r.body)).length&&1===(v=m(v[0],!1).map(h)).length)return a.map((function(e){return r.pre+v[0]+e}));if(S){var _=u(v[0]),b=u(v[1]),k=Math.max(v[0].length,v[1].length),D=3==v.length?Math.abs(u(v[2])):1,T=f;b<_&&(D*=-1,T=p);var E=v.some(g);y=[];for(var P=_;T(P,b);P+=D){var O;if(w)"\\"===(O=String.fromCharCode(P))&&(O="");else if(O=String(P),E){var x=k-O.length;if(x>0){var I=new Array(x+1).join("0");O=P<0?"-"+I+O.slice(1):I+O}}y.push(O)}}else{y=[];for(var M=0;M<v.length;M++)y.push.apply(y,m(v[M],!1))}for(M=0;M<y.length;M++)for(c=0;c<a.length;c++){l=o+y[M]+a[c];(!t||S||l)&&i.push(l)}}return i}},60502:function(e,t,i){"use strict";e.exports=i(78603)},78603:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0;i(26187).default.install();const o=i(34489);r(i(34489),t);class s extends o.AbstractMessageReader{constructor(e){super(),this._onData=new o.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=s;class a extends o.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=a,t.createMessageConnection=function(e,t,i,n){return void 0===i&&(i=o.NullLogger),o.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,o.createMessageConnection)(e,t,i,n)}},26187:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(34489);class r extends n.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return r.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}r.emptyBuffer=new Uint8Array(0);class o{constructor(e){this.socket=e,this._onData=new n.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,n.RAL)().console.error("Converting blob to array buffer failed.")}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),n.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),n.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),n.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class s{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),n.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),n.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),n.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,c=Object.freeze({messageBuffer:Object.freeze({create:e=>new r(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(a.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new o(e),asWritableStream:e=>new s(e)}),console:console,timer:Object.freeze({setTimeout(e,t,...i){const n=setTimeout(e,t,...i);return{dispose:()=>clearTimeout(n)}},setImmediate(e,...t){const i=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(i)}},setInterval(e,t,...i){const n=setInterval(e,t,...i);return{dispose:()=>clearInterval(n)}}})});function u(){return c}!function(e){e.install=function(){n.RAL.install(c)}}(u||(u={})),t.default=u},34489:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const n=i(1146);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return n.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return n.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return n.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return n.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return n.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return n.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return n.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return n.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return n.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return n.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return n.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return n.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return n.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return n.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return n.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return n.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return n.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return n.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return n.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return n.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return n.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return n.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return n.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return n.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return n.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return n.ParameterStructures}});const r=i(94428);Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return r.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return r.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return r.Touch}});const o=i(49306);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const s=i(64430);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const a=i(52098);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const c=i(31865);Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return c.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return c.SharedArrayReceiverStrategy}});const u=i(69167);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return u.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return u.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return u.ReadableStreamMessageReader}});const l=i(90673);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const d=i(46041);Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const h=i(94754);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return h.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return h.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return h.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return h.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return h.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return h.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return h.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return h.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return h.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return h.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return h.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return h.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return h.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return h.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return h.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return h.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return h.MessageStrategy}});const g=i(91803);t.RAL=g.default},52098:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const n=i(91803),r=i(12589),o=i(64430);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:o.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:o.Event.None}),e.is=function(t){const i=t;return i&&(i===e.None||i===e.Cancelled||r.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}}(s||(t.CancellationToken=s={}));const a=Object.freeze((function(e,t){const i=(0,n.default)().timer.setTimeout(e.bind(t),0);return{dispose(){i.dispose()}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new o.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},94754:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const n=i(91803),r=i(12589),o=i(1146),s=i(94428),a=i(64430),c=i(52098);var u,l,d,h,g,f,p,m,v,y,C,w,S,R,_,b,k,D,T;!function(e){e.type=new o.NotificationType("$/cancelRequest")}(u||(u={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(l||(t.ProgressToken=l={})),function(e){e.type=new o.NotificationType("$/progress")}(d||(d={}));t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return r.func(e)}}(h||(h={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(g||(t.Trace=g={})),function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"}(f||(t.TraceValues=f={})),function(e){e.fromString=function(t){if(!r.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(g||(t.Trace=g={})),function(e){e.Text="text",e.JSON="json"}(p||(t.TraceFormat=p={})),function(e){e.fromString=function(t){return r.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p||(t.TraceFormat=p={})),function(e){e.type=new o.NotificationType("$/setTrace")}(m||(t.SetTraceNotification=m={})),function(e){e.type=new o.NotificationType("$/logTrace")}(v||(t.LogTraceNotification=v={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(y||(t.ConnectionErrors=y={}));class E extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,E.prototype)}}t.ConnectionError=E,function(e){e.is=function(e){const t=e;return t&&r.func(t.cancelUndispatched)}}(C||(t.ConnectionStrategy=C={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&r.func(t.createCancellationTokenSource)&&(void 0===t.dispose||r.func(t.dispose))}}(w||(t.IdCancellationReceiverStrategy=w={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&r.func(t.createCancellationTokenSource)&&(void 0===t.dispose||r.func(t.dispose))}}(S||(t.RequestCancellationReceiverStrategy=S={})),function(e){e.Message=Object.freeze({createCancellationTokenSource(e){return new c.CancellationTokenSource}}),e.is=function(e){return w.is(e)||S.is(e)}}(R||(t.CancellationReceiverStrategy=R={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){return e.sendNotification(u.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&r.func(t.sendCancellation)&&r.func(t.cleanup)}}(_||(t.CancellationSenderStrategy=_={})),function(e){e.Message=Object.freeze({receiver:R.Message,sender:_.Message}),e.is=function(e){const t=e;return t&&R.is(t.receiver)&&_.is(t.sender)}}(b||(t.CancellationStrategy=b={})),function(e){e.is=function(e){const t=e;return t&&r.func(t.handleMessage)}}(k||(t.MessageStrategy=k={})),function(e){e.is=function(e){const t=e;return t&&(b.is(t.cancellationStrategy)||C.is(t.connectionStrategy)||k.is(t.messageStrategy))}}(D||(t.ConnectionOptions=D={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(T||(T={})),t.createMessageConnection=function(e,i,f,C){const S=void 0!==f?f:t.NullLogger;let R=0,_=0,D=0;const P="2.0";let O;const x=new Map;let I;const M=new Map,F=new Map;let N,A,L=new s.LinkedMap,q=new Map,W=new Set,j=new Map,U=g.Off,K=p.Text,$=T.New;const H=new a.Emitter,z=new a.Emitter,V=new a.Emitter,B=new a.Emitter,J=new a.Emitter,G=C&&C.cancellationStrategy?C.cancellationStrategy:b.Message;function Y(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function X(e,t){var i;o.Message.isRequest(t)?e.set(Y(t.id),t):o.Message.isResponse(t)?e.set(null===(i=t.id)?"res-unknown-"+(++D).toString():"res-"+i.toString(),t):e.set("not-"+(++_).toString(),t)}function Q(e){}function Z(){return $===T.Listening}function ee(){return $===T.Closed}function te(){return $===T.Disposed}function ie(){$!==T.New&&$!==T.Listening||($=T.Closed,z.fire(void 0))}function ne(){N||0===L.size||(N=(0,n.default)().timer.setImmediate((()=>{N=void 0,function(){if(0===L.size)return;const e=L.shift();try{const t=C?.messageStrategy;k.is(t)?t.handleMessage(e,re):re(e)}finally{ne()}}()})))}function re(e){o.Message.isRequest(e)?function(e){if(te())return;function t(t,n,r){const s={jsonrpc:P,id:e.id};t instanceof o.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,ae(s,n,r),i.write(s).catch((()=>S.error("Sending response failed.")))}function n(t,n,r){const o={jsonrpc:P,id:e.id,error:t.toJson()};ae(o,n,r),i.write(o).catch((()=>S.error("Sending response failed.")))}function s(t,n,r){void 0===t&&(t=null);const o={jsonrpc:P,id:e.id,result:t};ae(o,n,r),i.write(o).catch((()=>S.error("Sending response failed.")))}!function(e){if(U===g.Off||!A)return;if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),A.log(`Received request '${e.method} - (${e.id})'.`,t)}else ue("receive-request",e)}(e);const a=x.get(e.method);let c,u;a&&(c=a.type,u=a.handler);const l=Date.now();if(u||O){const i=e.id??String(Date.now()),a=w.is(G.receiver)?G.receiver.createCancellationTokenSource(i):G.receiver.createCancellationTokenSource(e);null!==e.id&&W.has(e.id)&&a.cancel(),null!==e.id&&j.set(i,a);try{let d;if(u)if(void 0===e.params){if(void 0!==c&&0!==c.numberOfParams)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines ${c.numberOfParams} params but received none.`),e.method,l);d=u(a.token)}else if(Array.isArray(e.params)){if(void 0!==c&&c.parameterStructures===o.ParameterStructures.byName)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,l);d=u(...e.params,a.token)}else{if(void 0!==c&&c.parameterStructures===o.ParameterStructures.byPosition)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,l);d=u(e.params,a.token)}else O&&(d=O(e.method,e.params,a.token));const h=d;d?h.then?h.then((n=>{j.delete(i),t(n,e.method,l)}),(t=>{j.delete(i),t instanceof o.ResponseError?n(t,e.method,l):t&&r.string(t.message)?n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(j.delete(i),t(d,e.method,l)):(j.delete(i),s(d,e.method,l))}catch(s){j.delete(i),s instanceof o.ResponseError?t(s,e.method,l):s&&r.string(s.message)?n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${s.message}`),e.method,l):n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else n(new o.ResponseError(o.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):o.Message.isNotification(e)?function(e){if(te())return;let t,i;if(e.method===u.type.method){const t=e.params.id;return W.delete(t),void ce(e)}{const n=M.get(e.method);n&&(i=n.handler,t=n.type)}if(i||I)try{if(ce(e),i)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==o.ParameterStructures.byName&&S.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),i();else if(Array.isArray(e.params)){const n=e.params;e.method===d.type.method&&2===n.length&&l.is(n[0])?i({token:n[0],value:n[1]}):(void 0!==t&&(t.parameterStructures===o.ParameterStructures.byName&&S.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&S.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${n.length} arguments`)),i(...n))}else void 0!==t&&t.parameterStructures===o.ParameterStructures.byPosition&&S.error(`Notification ${e.method} defines parameters by position but received parameters by name`),i(e.params);else I&&I(e.method,e.params)}catch(t){t.message?S.error(`Notification handler '${e.method}' failed with message: ${t.message}`):S.error(`Notification handler '${e.method}' failed unexpectedly.`)}else V.fire(e)}(e):o.Message.isResponse(e)?function(e){if(te())return;if(null===e.id)e.error?S.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):S.error("Received response message without id. No further error information provided.");else{const t=e.id,i=q.get(t);if(function(e,t){if(U===g.Off||!A)return;if(K===p.Text){let i;if(U!==g.Verbose&&U!==g.Compact||(e.error&&e.error.data?i=`Error data: ${se(e.error.data)}\n\n`:e.result?i=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),t){const n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";A.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,i)}else A.log(`Received response ${e.id} without active response promise.`,i)}else ue("receive-response",e)}(e,i),void 0!==i){q.delete(t);try{if(e.error){const t=e.error;i.reject(new o.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");i.resolve(e.result)}}catch(e){e.message?S.error(`Response handler '${i.method}' failed with message: ${e.message}`):S.error(`Response handler '${i.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void S.error("Received empty message.");S.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(r.string(t.id)||r.number(t.id)){const e=t.id,i=q.get(e);i&&i.reject(new Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(ie),e.onError((function(e){H.fire([e,void 0,void 0])})),i.onClose(ie),i.onError((function(e){H.fire(e)}));const oe=e=>{try{if(o.Message.isNotification(e)&&e.method===u.type.method){const t=e.params.id,n=Y(t),r=L.get(n);if(o.Message.isRequest(r)){const o=C?.connectionStrategy,s=o&&o.cancelUndispatched?o.cancelUndispatched(r,Q):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return L.delete(n),j.delete(t),s.id=r.id,ae(s,e.method,Date.now()),void i.write(s).catch((()=>S.error("Sending response for canceled message failed.")))}const s=j.get(t);if(void 0!==s)return s.cancel(),void ce(e);W.add(t)}X(L,e)}finally{ne()}};function se(e){if(null!=e)switch(U){case g.Verbose:return JSON.stringify(e,null,4);case g.Compact:return JSON.stringify(e);default:return}}function ae(e,t,i){if(U!==g.Off&&A)if(K===p.Text){let n;U!==g.Verbose&&U!==g.Compact||(e.error&&e.error.data?n=`Error data: ${se(e.error.data)}\n\n`:e.result?n=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),A.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-i}ms`,n)}else ue("send-response",e)}function ce(e){if(U!==g.Off&&A&&e.method!==v.type.method)if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),A.log(`Received notification '${e.method}'.`,t)}else ue("receive-notification",e)}function ue(e,t){if(!A||U===g.Off)return;const i={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};A.log(i)}function le(){if(ee())throw new E(y.Closed,"Connection is closed.");if(te())throw new E(y.Disposed,"Connection is disposed.")}function de(e){return void 0===e?null:e}function he(e){return null===e?void 0:e}function ge(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function fe(e,t){switch(e){case o.ParameterStructures.auto:return ge(t)?he(t):[de(t)];case o.ParameterStructures.byName:if(!ge(t))throw new Error("Received parameters by name but param is not an object literal.");return he(t);case o.ParameterStructures.byPosition:return[de(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function pe(e,t){let i;const n=e.numberOfParams;switch(n){case 0:i=void 0;break;case 1:i=fe(e.parameterStructures,t[0]);break;default:i=[];for(let e=0;e<t.length&&e<n;e++)i.push(de(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)i.push(null)}return i}const me={sendNotification:(e,...t)=>{let n,s;if(le(),r.string(e)){n=e;const i=t[0];let r=0,a=o.ParameterStructures.auto;o.ParameterStructures.is(i)&&(r=1,a=i);let c=t.length;const u=c-r;switch(u){case 0:s=void 0;break;case 1:s=fe(a,t[r]);break;default:if(a===o.ParameterStructures.byName)throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`);s=t.slice(r,c).map((e=>de(e)))}}else{const i=t;n=e.method,s=pe(e,i)}const a={jsonrpc:P,method:n,params:s};return function(e){if(U!==g.Off&&A)if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),A.log(`Sending notification '${e.method}'.`,t)}else ue("send-notification",e)}(a),i.write(a).catch((e=>{throw S.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let i;return le(),r.func(e)?I=e:t&&(r.string(e)?(i=e,M.set(e,{type:void 0,handler:t})):(i=e.method,M.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==i?M.delete(i):I=void 0}}},onProgress:(e,t,i)=>{if(F.has(t))throw new Error(`Progress handler for token ${t} already registered`);return F.set(t,i),{dispose:()=>{F.delete(t)}}},sendProgress:(e,t,i)=>me.sendNotification(d.type,{token:t,value:i}),onUnhandledProgress:B.event,sendRequest:(e,...t)=>{let n,s,a;if(le(),function(){if(!Z())throw new Error("Call listen() first.")}(),r.string(e)){n=e;const i=t[0],r=t[t.length-1];let u=0,l=o.ParameterStructures.auto;o.ParameterStructures.is(i)&&(u=1,l=i);let d=t.length;c.CancellationToken.is(r)&&(d-=1,a=r);const h=d-u;switch(h){case 0:s=void 0;break;case 1:s=fe(l,t[u]);break;default:if(l===o.ParameterStructures.byName)throw new Error(`Received ${h} parameters for 'by Name' request parameter structure.`);s=t.slice(u,d).map((e=>de(e)))}}else{const i=t;n=e.method,s=pe(e,i);const r=e.numberOfParams;a=c.CancellationToken.is(i[r])?i[r]:void 0}const u=R++;let l;a&&(l=a.onCancellationRequested((()=>{const e=G.sender.sendCancellation(me,u);return void 0===e?(S.log(`Received no promise from cancellation strategy when cancelling id ${u}`),Promise.resolve()):e.catch((()=>{S.log(`Sending cancellation messages for id ${u} failed`)}))})));const d={jsonrpc:P,id:u,method:n,params:s};return function(e){if(U!==g.Off&&A)if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),A.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ue("send-request",e)}(d),"function"==typeof G.sender.enableCancellation&&G.sender.enableCancellation(d),new Promise((async(e,t)=>{const r={method:n,timerStart:Date.now(),resolve:t=>{e(t),G.sender.cleanup(u),l?.dispose()},reject:e=>{t(e),G.sender.cleanup(u),l?.dispose()}};try{await i.write(d),q.set(u,r)}catch(e){throw S.error("Sending request failed."),r.reject(new o.ResponseError(o.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),e}}))},onRequest:(e,t)=>{le();let i=null;return h.is(e)?(i=void 0,O=e):r.string(e)?(i=null,void 0!==t&&(i=e,x.set(e,{handler:t,type:void 0}))):void 0!==t&&(i=e.method,x.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==i&&(void 0!==i?x.delete(i):O=void 0)}}},hasPendingResponse:()=>q.size>0,trace:async(e,t,i)=>{let n=!1,o=p.Text;void 0!==i&&(r.boolean(i)?n=i:(n=i.sendNotification||!1,o=i.traceFormat||p.Text)),U=e,K=o,A=U===g.Off?void 0:t,!n||ee()||te()||await me.sendNotification(m.type,{value:g.toString(e)})},onError:H.event,onClose:z.event,onUnhandledNotification:V.event,onDispose:J.event,end:()=>{i.end()},dispose:()=>{if(te())return;$=T.Disposed,J.fire(void 0);const t=new o.ResponseError(o.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of q.values())e.reject(t);q=new Map,j=new Map,W=new Set,L=new s.LinkedMap,r.func(i.dispose)&&i.dispose(),r.func(e.dispose)&&e.dispose()},listen:()=>{le(),function(){if(Z())throw new E(y.AlreadyListening,"Connection is already listening")}(),$=T.Listening,e.listen(oe)},inspect:()=>{(0,n.default)().console.log("inspect")}};return me.onNotification(v.type,(e=>{if(U===g.Off||!A)return;const t=U===g.Verbose||U===g.Compact;A.log(e.message,t?e.verbose:void 0)})),me.onNotification(d.type,(e=>{const t=F.get(e.token);t?t(e.value):B.fire(e)})),me}},49306:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,function(e){e.create=function(e){return{dispose:e}}}(i||(t.Disposable=i={}))},64430:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const n=i(91803);var r;!function(e){const t={dispose(){}};e.None=function(){return t}}(r||(t.Event=r={}));class o{add(e,t=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let i=!1;for(let n=0,r=this._callbacks.length;n<r;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);i=!0}if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],i=this._callbacks.slice(0),r=this._contexts.slice(0);for(let o=0,s=i.length;o<s;o++)try{t.push(i[o].apply(r[o],e))}catch(e){(0,n.default)().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,i)=>{this._callbacks||(this._callbacks=new o),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const n={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),n.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(n),n}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},12589:function(e,t){"use strict";function i(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every((e=>i(e)))}},94428:function(e,t){"use strict";var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n||(t.Touch=n={}));class r{constructor(){this[i]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let r=this._map.get(e);if(r)r.value=t,i!==n.None&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(r);break;case n.First:this.addItemFirst(r);break;case n.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return i}[(i=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(t.previous=i,i.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,i=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=i,i.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,i)=>{e.push([i,t])})),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}t.LinkedMap=r;t.LRUCache=class extends r{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},46041:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0;t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,i=0,n=0,r=0;e:for(;i<this._chunks.length;){const e=this._chunks[i];for(n=0;n<e.length;){switch(e[n]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,n++;break e;default:t=0}break;default:t=0}n++}r+=e.byteLength,i++}if(4!==t)return;const o=this._read(r+n),s=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return s;for(let t=0;t<a.length-2;t++){const i=a[t],n=i.indexOf(":");if(-1===n)throw new Error(`Message header must separate key and value using ':'\n${i}`);const r=i.substr(0,n),o=i.substr(n+1).trim();s.set(e?r.toLowerCase():r,o)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],i=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,i}const t=this.allocNative(e);let i=0;for(;e>0;){const n=this._chunks[0];if(n.byteLength>e){const r=n.slice(0,e);t.set(r,i),i+=e,this._chunks[0]=n.slice(e),this._totalLength-=e,e-=e}else t.set(n,i),i+=n.byteLength,this._chunks.shift(),this._totalLength-=n.byteLength,e-=n.byteLength}return t}}},69167:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const n=i(91803),r=i(12589),o=i(64430),s=i(44078);var a,c;!function(e){e.is=function(e){let t=e;return t&&r.func(t.listen)&&r.func(t.dispose)&&r.func(t.onError)&&r.func(t.onClose)&&r.func(t.onPartialMessage)}}(a||(t.MessageReader=a={}));class u{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter,this.partialMessageEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=u,function(e){e.fromOptions=function(e){let t,i;const r=new Map;let o;const s=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(i=e.contentDecoder,r.set(i.name,i)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)r.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(o=e.contentTypeDecoder,s.set(o.name,o)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===o&&(o=(0,n.default)().applicationJson.decoder,s.set(o.name,o)),{charset:t,contentDecoder:i,contentDecoders:r,contentTypeDecoder:o,contentTypeDecoders:s}}}(c||(c={}));t.ReadableStreamMessageReader=class extends u{constructor(e,t){super(),this.readable=e,this.options=c.fromOptions(t),this.buffer=(0,n.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){try{for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error(`Header must provide a Content-Length property.\n${JSON.stringify(Object.fromEntries(e))}`));const i=parseInt(t);if(isNaN(i))return void this.fireError(new Error(`Content-Length value must be a number. Got ${t}`));this.nextMessageLength=i}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,i=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(i)})).catch((e=>{this.fireError(e)}))}}catch(e){this.fireError(e)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,n.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},90673:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const n=i(91803),r=i(12589),o=i(44078),s=i(64430);var a,c;!function(e){e.is=function(e){let t=e;return t&&r.func(t.dispose)&&r.func(t.onClose)&&r.func(t.onError)&&r.func(t.write)}}(a||(t.MessageWriter=a={}));class u{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,i){this.errorEmitter.fire([this.asError(e),t,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=u,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,n.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,n.default)().applicationJson.encoder}}}(c||(c={}));t.WriteableStreamMessageWriter=class extends u{constructor(e,t){super(),this.writable=e,this.options=c.fromOptions(t),this.errorCount=0,this.writeSemaphore=new o.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const i=[];return i.push("Content-Length: ",t.byteLength.toString(),"\r\n"),i.push("\r\n"),this.doWrite(e,i,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,i){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(i)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},1146:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const n=i(12589);var r,o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(r||(t.ErrorCodes=r={}));class s extends Error{constructor(e,t,i){super(t),this.code=n.number(e)?e:r.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}t.ResponseError=s;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class c{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=c;t.RequestType0=class extends c{constructor(e){super(e,0)}};t.RequestType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.RequestType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.RequestType2=class extends c{constructor(e){super(e,2)}};t.RequestType3=class extends c{constructor(e){super(e,3)}};t.RequestType4=class extends c{constructor(e){super(e,4)}};t.RequestType5=class extends c{constructor(e){super(e,5)}};t.RequestType6=class extends c{constructor(e){super(e,6)}};t.RequestType7=class extends c{constructor(e){super(e,7)}};t.RequestType8=class extends c{constructor(e){super(e,8)}};t.RequestType9=class extends c{constructor(e){super(e,9)}};t.NotificationType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.NotificationType0=class extends c{constructor(e){super(e,0)}};t.NotificationType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.NotificationType2=class extends c{constructor(e){super(e,2)}};t.NotificationType3=class extends c{constructor(e){super(e,3)}};t.NotificationType4=class extends c{constructor(e){super(e,4)}};t.NotificationType5=class extends c{constructor(e){super(e,5)}};t.NotificationType6=class extends c{constructor(e){super(e,6)}};t.NotificationType7=class extends c{constructor(e){super(e,7)}};t.NotificationType8=class extends c{constructor(e){super(e,8)}};t.NotificationType9=class extends c{constructor(e){super(e,9)}},function(e){e.isRequest=function(e){const t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))},e.isNotification=function(e){const t=e;return t&&n.string(t.method)&&void 0===e.id},e.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(n.string(t.id)||n.number(t.id)||null===t.id)}}(o||(t.Message=o={}))},91803:function(e,t){"use strict";let i;function n(){if(void 0===i)throw new Error("No runtime abstraction layer installed");return i}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");i=e}}(n||(n={})),t.default=n},44078:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const n=i(91803);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,i)=>{this._waiting.push({thunk:e,resolve:t,reject:i}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,n.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},31865:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=void 0;const n=i(52098);var r;!function(e){e.Continue=0,e.Cancelled=1}(r||(r={}));t.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=r.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const i=this.buffers.get(t);if(void 0===i)return;const n=new Int32Array(i,0,1);Atomics.store(n,0,r.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class o{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===r.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class s{constructor(e){this.token=new o(e)}cancel(){}dispose(){}}t.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new n.CancellationTokenSource:new s(t)}}},44266:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,i){const n=this.client,o=this.middleware,s=(e,t,i)=>{const o=n.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return n.sendRequest(r.CallHierarchyPrepareRequest.type,o,i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyItems(e,i)),(e=>n.handleFailedRequest(r.CallHierarchyPrepareRequest.type,i,e,null)))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,i,s):s(e,t,i)}provideCallHierarchyIncomingCalls(e,t){const i=this.client,n=this.middleware,o=(e,t)=>{const n={item:i.code2ProtocolConverter.asCallHierarchyItem(e)};return i.sendRequest(r.CallHierarchyIncomingCallsRequest.type,n,t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyIncomingCalls(e,t)),(e=>i.handleFailedRequest(r.CallHierarchyIncomingCallsRequest.type,t,e,null)))};return n.provideCallHierarchyIncomingCalls?n.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){const i=this.client,n=this.middleware,o=(e,t)=>{const n={item:i.code2ProtocolConverter.asCallHierarchyItem(e)};return i.sendRequest(r.CallHierarchyOutgoingCallsRequest.type,n,t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyOutgoingCalls(e,t)),(e=>i.handleFailedRequest(r.CallHierarchyOutgoingCallsRequest.type,t,e,null)))};return n.provideCallHierarchyOutgoingCalls?n.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}}class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){const t=e;(0,o.ensure)((0,o.ensure)(t,"textDocument"),"callHierarchy").dynamicRegistration=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.callHierarchyProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=this._client,i=new s(t);return[n.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),i),i]}}t.CallHierarchyFeature=a},13953:function(e,t,i){"use strict";t.dp=t.ZM=t.UY=t._X=void 0;const n=i(9051),r=i(7846),o=i(64092),s=i(89504),a=i(92735),c=i(28419),u=i(66276),l=i(79198),d=i(69169),h=i(11750),g=i(49501),f=i(99211),p=i(94212),m=i(59443),v=i(46050),y=i(77192),C=i(31609),w=i(812),S=i(81982),R=i(26949),_=i(56880),b=i(81978),k=i(34732),D=i(26265),T=i(49699),E=i(37424),P=i(65612),O=i(95352),x=i(75764),I=i(97391),M=i(67108),F=i(76278),N=i(56754),A=i(42080),L=i(29781),q=i(39006),W=i(44266),j=i(3262),U=i(22999),K=i(33520),$=i(35488),H=i(41425),z=i(71005),V=i(10411);var B,J,G,Y,X,Q,Z,ee,te;!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Never=4]="Never"}(B||(B={})),function(e){e[e.Continue=1]="Continue",e[e.Shutdown=2]="Shutdown"}(J||(t._X=J={})),function(e){e[e.DoNotRestart=1]="DoNotRestart",e[e.Restart=2]="Restart"}(G||(t.UY=G={})),function(e){e[e.Stopped=1]="Stopped",e[e.Starting=3]="Starting",e[e.Running=2]="Running"}(Y||(t.ZM=Y={})),function(e){e.off="off",e.on="on"}(X||(X={})),function(e){e.sanitizeIsTrusted=function(e){return null!=e&&(!!("boolean"==typeof e||"object"==typeof e&&null!==e&&a.stringArray(e.enabledCommands))&&e)}}(Q||(Q={}));class ie{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,i){return i&&i<=3?{action:J.Continue}:{action:J.Shutdown}}closed(){if(this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount)return{action:G.Restart};return this.restarts[this.restarts.length-1]-this.restarts[0]<=18e4?{action:G.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:G.Restart})}}!function(e){e.Initial="initial",e.Starting="starting",e.StartFailed="startFailed",e.Running="running",e.Stopping="stopping",e.Stopped="stopped"}(Z||(Z={})),function(e){e.is=function(e){return e&&r.MessageReader.is(e.reader)&&r.MessageWriter.is(e.writer)}}(ee||(ee={}));class ne{constructor(e,t,i){this._traceFormat=r.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new c.Semaphore(1),this._id=e,this._name=t;const n={isTrusted:!1,supportHtml:!1};void 0!==(i=i||{}).markdown&&(n.isTrusted=Q.sanitizeIsTrusted(i.markdown.isTrusted),n.supportHtml=!0===i.markdown.supportHtml),this._clientOptions={documentSelector:i.documentSelector??[],synchronize:i.synchronize??{},diagnosticCollectionName:i.diagnosticCollectionName,outputChannelName:i.outputChannelName??this._name,revealOutputChannelOn:i.revealOutputChannelOn??B.Error,stdioEncoding:i.stdioEncoding??"utf8",initializationOptions:i.initializationOptions,initializationFailedHandler:i.initializationFailedHandler,progressOnInitialization:!!i.progressOnInitialization,errorHandler:i.errorHandler??this.createDefaultErrorHandler(i.connectionOptions?.maxRestartCount),middleware:i.middleware??{},uriConverters:i.uriConverters,workspaceFolder:i.workspaceFolder,connectionOptions:i.connectionOptions,markdown:n,diagnosticPullOptions:i.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:i.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Z.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,i.outputChannel?(this._outputChannel=i.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=i.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new c.Semaphore(1),this._pendingChangeDelayer=new c.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new c.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new r.Emitter,this._stateChangeEmitter=new r.Emitter,this._trace=r.Trace.Off,this._tracer={log:(e,t)=>{a.string(e)?this.logTrace(e,t):this.logObjectTrace(e)}},this._c2p=o.createConverter(i.uriConverters?i.uriConverters.code2Protocol:void 0),this._p2c=s.createConverter(i.uriConverters?i.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=n.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let i=this.getPublicState();i!==t&&this._stateChangeEmitter.fire({oldState:t,newState:i})}getPublicState(){switch(this.$state){case Z.Starting:return Y.Starting;case Z.Running:return Y.Running;default:return Y.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===Z.StartFailed||this.$state===Z.Stopping||this.$state===Z.Stopped)return Promise.reject(new r.ResponseError(r.ErrorCodes.ConnectionInactive,"Client is not running"));const i=await this.$start();this._didChangeTextDocumentFeature.syncKind===r.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(i);const n=this._clientOptions.middleware?.sendRequest;if(void 0!==n){let o,s;return 1===t.length?r.CancellationToken.is(t[0])?s=t[0]:o=t[0]:2===t.length&&(o=t[0],s=t[1]),n(e,o,s,((e,t,n)=>{const r=[];return void 0!==t&&r.push(t),void 0!==n&&r.push(n),i.sendRequest(e,...r)}))}return i.sendRequest(e,...t)}onRequest(e,t){const i="string"==typeof e?e:e.method;this._requestHandlers.set(i,t);const n=this.activeConnection();let r;return void 0!==n?(this._requestDisposables.set(i,n.onRequest(e,t)),r={dispose:()=>{const e=this._requestDisposables.get(i);void 0!==e&&(e.dispose(),this._requestDisposables.delete(i))}}):(this._pendingRequestHandlers.set(i,t),r={dispose:()=>{this._pendingRequestHandlers.delete(i);const e=this._requestDisposables.get(i);void 0!==e&&(e.dispose(),this._requestDisposables.delete(i))}}),{dispose:()=>{this._requestHandlers.delete(i),r.dispose()}}}async sendNotification(e,t){if(this.$state===Z.StartFailed||this.$state===Z.Stopping||this.$state===Z.Stopped)return Promise.reject(new r.ResponseError(r.ErrorCodes.ConnectionInactive,"Client is not running"));const i=this._didChangeTextDocumentFeature.syncKind===r.TextDocumentSyncKind.Full;let n;i&&"string"!=typeof e&&e.method===r.DidOpenTextDocumentNotification.method&&(n=t?.textDocument.uri,this._pendingOpenNotifications.add(n));const o=await this.$start();i&&await this.sendPendingFullTextDocumentChanges(o),void 0!==n&&this._pendingOpenNotifications.delete(n);const s=this._clientOptions.middleware?.sendNotification;return s?s(e,o.sendNotification.bind(o),t):o.sendNotification(e,t)}onNotification(e,t){const i="string"==typeof e?e:e.method;this._notificationHandlers.set(i,t);const n=this.activeConnection();let r;return void 0!==n?(this._notificationDisposables.set(i,n.onNotification(e,t)),r={dispose:()=>{const e=this._notificationDisposables.get(i);void 0!==e&&(e.dispose(),this._notificationDisposables.delete(i))}}):(this._pendingNotificationHandlers.set(i,t),r={dispose:()=>{this._pendingNotificationHandlers.delete(i);const e=this._notificationDisposables.get(i);void 0!==e&&(e.dispose(),this._notificationDisposables.delete(i))}}),{dispose:()=>{this._notificationHandlers.delete(i),r.dispose()}}}async sendProgress(e,t,i){if(this.$state===Z.StartFailed||this.$state===Z.Stopping||this.$state===Z.Stopped)return Promise.reject(new r.ResponseError(r.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,i)}catch(e){throw this.error(`Sending progress for token ${t} failed.`,e),e}}onProgress(e,t,i){this._progressHandlers.set(t,{type:e,handler:i});const n=this.activeConnection();let o;const s=this._clientOptions.middleware?.handleWorkDoneProgress,a=r.WorkDoneProgress.is(e)&&void 0!==s?e=>{s(t,e,(()=>i(e)))}:i;return void 0!==n?(this._progressDisposables.set(t,n.onProgress(e,t,a)),o={dispose:()=>{const e=this._progressDisposables.get(t);void 0!==e&&(e.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:i}),o={dispose:()=>{this._pendingProgressHandlers.delete(t);const e=this._progressDisposables.get(t);void 0!==e&&(e.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),o.dispose()}}}createDefaultErrorHandler(e){if(void 0!==e&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new ie(this,e??4)}async setTrace(e){this._trace=e;const t=this.activeConnection();void 0!==t&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof r.ResponseError){const t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?"\n"+t.data.toString():""}`}return e instanceof Error?a.string(e.stack)?e.stack:e.message:a.string(e)?e:e.toString()}debug(e,t,i=!0){this.logOutputMessage(r.MessageType.Debug,B.Debug,"Debug",e,t,i)}info(e,t,i=!0){this.logOutputMessage(r.MessageType.Info,B.Info,"Info",e,t,i)}warn(e,t,i=!0){this.logOutputMessage(r.MessageType.Warning,B.Warn,"Warn",e,t,i)}error(e,t,i=!0){this.logOutputMessage(r.MessageType.Error,B.Error,"Error",e,t,i)}logOutputMessage(e,t,i,n,r,o){this.outputChannel.appendLine(`[${i.padEnd(5)} - ${(new Date).toLocaleTimeString()}] ${n}`),null!=r&&this.outputChannel.appendLine(this.data2String(r)),("force"===o||o&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,n)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.";(e===r.MessageType.Error?n.window.showErrorMessage:e===r.MessageType.Warning?n.window.showWarningMessage:n.window.showInformationMessage)(t,"Go to output").then((e=>{void 0!==e&&this.outputChannel.show(!0)}))}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${(new Date).toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${(new Date).toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===Z.Initial||this.$state===Z.Stopping||this.$state===Z.Stopped}needsStop(){return this.$state===Z.Starting||this.$state===Z.Running}activeConnection(){return this.$state===Z.Running&&void 0!==this._connection?this._connection:void 0}isRunning(){return this.$state===Z.Running}async start(){if("disposing"===this._disposed||"disposed"===this._disposed)throw new Error("Client got disposed and can't be restarted.");if(this.$state===Z.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(void 0!==this._onStart)return this._onStart;const[e,t,i]=this.createOnStartPromise();this._onStart=e,void 0===this._diagnostics&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?n.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):n.languages.createDiagnosticCollection());for(const[e,t]of this._notificationHandlers)this._pendingNotificationHandlers.has(e)||this._pendingNotificationHandlers.set(e,t);for(const[e,t]of this._requestHandlers)this._pendingRequestHandlers.has(e)||this._pendingRequestHandlers.set(e,t);for(const[e,t]of this._progressHandlers)this._pendingProgressHandlers.has(e)||this._pendingProgressHandlers.set(e,t);this.$state=Z.Starting;try{const e=await this.createConnection();e.onNotification(r.LogMessageNotification.type,(e=>{switch(e.type){case r.MessageType.Error:this.error(e.message,void 0,!1);break;case r.MessageType.Warning:this.warn(e.message,void 0,!1);break;case r.MessageType.Info:this.info(e.message,void 0,!1);break;case r.MessageType.Debug:this.debug(e.message,void 0,!1);break;default:this.outputChannel.appendLine(e.message)}})),e.onNotification(r.ShowMessageNotification.type,(e=>{switch(e.type){case r.MessageType.Error:n.window.showErrorMessage(e.message);break;case r.MessageType.Warning:n.window.showWarningMessage(e.message);break;case r.MessageType.Info:default:n.window.showInformationMessage(e.message)}})),e.onRequest(r.ShowMessageRequest.type,(e=>{let t;switch(e.type){case r.MessageType.Error:t=n.window.showErrorMessage;break;case r.MessageType.Warning:t=n.window.showWarningMessage;break;case r.MessageType.Info:default:t=n.window.showInformationMessage}let i=e.actions||[];return t(e.message,...i)})),e.onNotification(r.TelemetryEventNotification.type,(e=>{this._telemetryEmitter.fire(e)})),e.onRequest(r.ShowDocumentRequest.type,(async e=>{const t=async e=>{const t=this.protocol2CodeConverter.asUri(e.uri);try{if(!0===e.external){return{success:await n.env.openExternal(t)}}{const i={};return void 0!==e.selection&&(i.selection=this.protocol2CodeConverter.asRange(e.selection)),void 0===e.takeFocus||!1===e.takeFocus?i.preserveFocus=!0:!0===e.takeFocus&&(i.preserveFocus=!1),await n.window.showTextDocument(t,i),{success:!0}}}catch(e){return{success:!1}}},i=this._clientOptions.middleware.window?.showDocument;return void 0!==i?i(e,t):t(e)})),e.listen(),await this.initialize(e),t()}catch(e){this.$state=Z.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,e,"force"),i(e)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise(((i,n)=>{e=i,t=n})),e,t]}async initialize(e){this.refreshTrace(e,!1);const t=this._clientOptions.initializationOptions,[i,o]=void 0!==this._clientOptions.workspaceFolder?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:n.env.appName,version:n.version},locale:this.getLocale(),rootPath:i||null,rootUri:i?this._c2p.asUri(n.Uri.file(i)):null,capabilities:this.computeClientCapabilities(),initializationOptions:a.func(t)?t():t,trace:r.Trace.toString(this._trace),workspaceFolders:o};if(this.fillInitializeParams(s),!this._clientOptions.progressOnInitialization)return this.doInitialize(e,s);{const t=u.generateUuid(),i=new l.ProgressPart(e,t);s.workDoneToken=t;try{const t=await this.doInitialize(e,s);return i.done(),t}catch(e){throw i.cancel(),e}}}async doInitialize(e,t){try{const i=await e.initialize(t);if(void 0!==i.capabilities.positionEncoding&&i.capabilities.positionEncoding!==r.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${i.capabilities.positionEncoding}) received from server ${this.name}`);let n;this._initializeResult=i,this.$state=Z.Running,a.number(i.capabilities.textDocumentSync)?n=i.capabilities.textDocumentSync===r.TextDocumentSyncKind.None?{openClose:!1,change:r.TextDocumentSyncKind.None,save:void 0}:{openClose:!0,change:i.capabilities.textDocumentSync,save:{includeText:!1}}:void 0!==i.capabilities.textDocumentSync&&null!==i.capabilities.textDocumentSync&&(n=i.capabilities.textDocumentSync),this._capabilities=Object.assign({},i.capabilities,{resolvedTextDocumentSync:n}),e.onNotification(r.PublishDiagnosticsNotification.type,(e=>this.handleDiagnostics(e))),e.onRequest(r.RegistrationRequest.type,(e=>this.handleRegistrationRequest(e))),e.onRequest("client/registerFeature",(e=>this.handleRegistrationRequest(e))),e.onRequest(r.UnregistrationRequest.type,(e=>this.handleUnregistrationRequest(e))),e.onRequest("client/unregisterFeature",(e=>this.handleUnregistrationRequest(e))),e.onRequest(r.ApplyWorkspaceEditRequest.type,(e=>this.handleApplyWorkspaceEdit(e)));for(const[t,i]of this._pendingNotificationHandlers)this._notificationDisposables.set(t,e.onNotification(t,i));this._pendingNotificationHandlers.clear();for(const[t,i]of this._pendingRequestHandlers)this._requestDisposables.set(t,e.onRequest(t,i));this._pendingRequestHandlers.clear();for(const[t,i]of this._pendingProgressHandlers)this._progressDisposables.set(t,e.onProgress(i.type,t,i.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(r.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),i}catch(t){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(t)?this.initialize(e):this.stop():t instanceof r.ResponseError&&t.data&&t.data.retry?n.window.showErrorMessage(t.message,{title:"Retry",id:"retry"}).then((t=>{t&&"retry"===t.id?this.initialize(e):this.stop()})):(t&&t.message&&n.window.showErrorMessage(t.message),this.error("Server initialization failed.",t),this.stop()),t}}_clientGetRootPath(){let e=n.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===Z.Stopped||this.$state===Z.Initial)return;if(this.$state===Z.Stopping){if(void 0!==this._onStop)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const i=this.activeConnection();if(void 0===i||this.$state!==Z.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=Z.Stopping,this.cleanUp(e);const n=new Promise((e=>{(0,r.RAL)().timer.setTimeout(e,t)})),o=(async e=>(await e.shutdown(),await e.exit(),e))(i);return this._onStop=Promise.race([n,o]).then((e=>{if(void 0===e)throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out");e.end(),e.dispose()}),(e=>{throw this.error("Stopping server failed",e,!1),e})).finally((()=>{this.$state=Z.Stopped,"stop"===e&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()}))}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();const t=this._listeners.splice(0,this._listeners.length);for(const e of t)e.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const e of Array.from(this._features.entries()).map((e=>e[1])).reverse())e.clear();"stop"===e&&void 0!==this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0),void 0!==this._idleInterval&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){void 0!==this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){const t=this;async function i(e){return t._fileEvents.push(e),t._fileEventDelayer.trigger((async()=>{await t.sendNotification(r.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]}))}const n=this.clientOptions.middleware?.workspace;(n?.didChangeWatchedFile?n.didChangeWatchedFile(e,i):i(e)).catch((e=>{t.error("Notify file events failed.",e)}))}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock((async()=>{try{const t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(0===t.length)return;for(const i of t){const t=this.code2ProtocolConverter.asChangeTextDocumentParams(i);await e.sendNotification(r.DidChangeTextDocumentNotification.type,t),this._didChangeTextDocumentFeature.notificationSent(i,r.DidChangeTextDocumentNotification.type,t)}}catch(e){throw this.error("Sending pending changes failed",e,!1),e}}))}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger((async()=>{const e=this.activeConnection();void 0!==e?await this.sendPendingFullTextDocumentChanges(e):this.triggerPendingChangeDelivery()})).catch((e=>this.error("Delivering pending changes failed",e,!1)))}handleDiagnostics(e){if(!this._diagnostics)return;const t=e.uri;"busy"===this._diagnosticQueueState.state&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,r.RAL)().timer.setImmediate((()=>{this.workDiagnosticQueue()}))}workDiagnosticQueue(){if("busy"===this._diagnosticQueueState.state)return;const e=this._diagnosticQueue.entries().next();if(!0===e.done)return;const[t,i]=e.value;this._diagnosticQueue.delete(t);const r=new n.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:r},this._p2c.asDiagnostics(i,r.token).then((e=>{if(!r.token.isCancellationRequested){const i=this._p2c.asUri(t),n=this.clientOptions.middleware;n.handleDiagnostics?n.handleDiagnostics(i,e,((e,t)=>this.setDiagnostics(e,t))):this.setDiagnostics(i,e)}})).finally((()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()}))}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return n.env.language}async $start(){if(this.$state===Z.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const e=this.activeConnection();if(void 0===e)throw new Error("Starting server failed");return e}async createConnection(){const e=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=function(e,t,i,n,o){const s=new re,c=(0,r.createProtocolConnection)(e,t,s,o);c.onError((e=>{i(e[0],e[1],e[2])})),c.onClose(n);return{listen:()=>c.listen(),sendRequest:c.sendRequest,onRequest:c.onRequest,hasPendingResponse:c.hasPendingResponse,sendNotification:c.sendNotification,onNotification:c.onNotification,onProgress:c.onProgress,sendProgress:c.sendProgress,trace:(e,t,i)=>{const n={sendNotification:!1,traceFormat:r.TraceFormat.Text};return void 0===i?c.trace(e,t,n):(a.boolean(i),c.trace(e,t,i))},initialize:e=>c.sendRequest(r.InitializeRequest.type,e),shutdown:()=>c.sendRequest(r.ShutdownRequest.type,void 0),exit:()=>c.sendNotification(r.ExitNotification.type),end:()=>c.end(),dispose:()=>c.dispose()}}(e.reader,e.writer,((e,t,i)=>{this.handleConnectionError(e,t,i).catch((e=>this.error("Handling connection error failed",e)))}),(()=>{this.handleConnectionClosed().catch((e=>this.error("Handling connection close failed",e)))}),this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===Z.Stopped)return;try{void 0!==this._connection&&this._connection.dispose()}catch(e){}let e={action:G.DoNotRestart};if(this.$state!==Z.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch(e){}this._connection=void 0,e.action===G.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,!0!==e.handled&&"force"),this.cleanUp("stop"),this.$state===Z.Starting?this.$state=Z.StartFailed:this.$state=Z.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===G.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=Z.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch((e=>this.error("Restarting server failed",e,"force"))))}async handleConnectionError(e,t,i){const n=await this._clientOptions.errorHandler.error(e,t,i);n.action===J.Shutdown?(this.error(n.message??`Client ${this._name}: connection to server is erroring.\n${e.message}\nShutting down server.`,void 0,!0!==n.handled&&"force"),this.stop().catch((e=>{this.error("Stopping server failed",e,!1)}))):this.error(n.message??`Client ${this._name}: connection to server is erroring.\n${e.message}`,void 0,!0!==n.handled&&"force")}hookConfigurationChanged(e){this._listeners.push(n.workspace.onDidChangeConfiguration((()=>{this.refreshTrace(e,!0)})))}refreshTrace(e,t=!1){const i=n.workspace.getConfiguration(this._id);let o=r.Trace.Off,s=r.TraceFormat.Text;if(i){const e=i.get("trace.server","off");"string"==typeof e?o=r.Trace.fromString(e):(o=r.Trace.fromString(i.get("trace.server.verbosity","off")),s=r.TraceFormat.fromString(i.get("trace.server.format","text")))}this._trace=o,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch((e=>{this.error("Updating trace failed with error",e,!1)}))}hookFileEvents(e){let t,i=this._clientOptions.synchronize.fileEvents;i&&(t=a.array(i)?i:[i],t&&this._dynamicFeatures.get(r.DidChangeWatchedFilesNotification.type.method).registerRaw(u.generateUuid(),t))}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),d.DynamicFeature.is(e)){const t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){const t=this.getFeature(r.NotebookDocumentSyncRegistrationType.method);return void 0!==t&&t instanceof g.NotebookDocumentSyncFeature&&t.handles(e)}registerBuiltinFeatures(){const e=new Map;this.registerFeature(new f.ConfigurationFeature(this)),this.registerFeature(new p.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new p.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded((()=>{this.triggerPendingChangeDelivery()})),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new p.WillSaveFeature(this)),this.registerFeature(new p.WillSaveWaitUntilFeature(this)),this.registerFeature(new p.DidSaveTextDocumentFeature(this)),this.registerFeature(new p.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new O.FileSystemWatcherFeature(this,(e=>this.notifyFileEvent(e)))),this.registerFeature(new m.CompletionItemFeature(this)),this.registerFeature(new v.HoverFeature(this)),this.registerFeature(new C.SignatureHelpFeature(this)),this.registerFeature(new y.DefinitionFeature(this)),this.registerFeature(new _.ReferencesFeature(this)),this.registerFeature(new w.DocumentHighlightFeature(this)),this.registerFeature(new S.DocumentSymbolFeature(this)),this.registerFeature(new R.WorkspaceSymbolFeature(this)),this.registerFeature(new b.CodeActionFeature(this)),this.registerFeature(new k.CodeLensFeature(this)),this.registerFeature(new D.DocumentFormattingFeature(this)),this.registerFeature(new D.DocumentRangeFormattingFeature(this)),this.registerFeature(new D.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new T.RenameFeature(this)),this.registerFeature(new E.DocumentLinkFeature(this)),this.registerFeature(new P.ExecuteCommandFeature(this)),this.registerFeature(new f.SyncConfigurationFeature(this)),this.registerFeature(new M.TypeDefinitionFeature(this)),this.registerFeature(new I.ImplementationFeature(this)),this.registerFeature(new x.ColorProviderFeature(this)),void 0===this.clientOptions.workspaceFolder&&this.registerFeature(new F.WorkspaceFoldersFeature(this)),this.registerFeature(new N.FoldingRangeFeature(this)),this.registerFeature(new A.DeclarationFeature(this)),this.registerFeature(new L.SelectionRangeFeature(this)),this.registerFeature(new q.ProgressFeature(this)),this.registerFeature(new W.CallHierarchyFeature(this)),this.registerFeature(new j.SemanticTokensFeature(this)),this.registerFeature(new K.LinkedEditingFeature(this)),this.registerFeature(new U.DidCreateFilesFeature(this)),this.registerFeature(new U.DidRenameFilesFeature(this)),this.registerFeature(new U.DidDeleteFilesFeature(this)),this.registerFeature(new U.WillCreateFilesFeature(this)),this.registerFeature(new U.WillRenameFilesFeature(this)),this.registerFeature(new U.WillDeleteFilesFeature(this)),this.registerFeature(new $.TypeHierarchyFeature(this)),this.registerFeature(new H.InlineValueFeature(this)),this.registerFeature(new z.InlayHintsFeature(this)),this.registerFeature(new h.DiagnosticFeature(this)),this.registerFeature(new g.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(te.createAll(this))}fillInitializeParams(e){for(let t of this._features)a.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){const e={};(0,d.ensure)(e,"workspace").applyEdit=!0;const t=(0,d.ensure)((0,d.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[r.ResourceOperationKind.Create,r.ResourceOperationKind.Rename,r.ResourceOperationKind.Delete],t.failureHandling=r.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};const i=(0,d.ensure)((0,d.ensure)(e,"textDocument"),"publishDiagnostics");i.relatedInformation=!0,i.versionSupport=!1,i.tagSupport={valueSet:[r.DiagnosticTag.Unnecessary,r.DiagnosticTag.Deprecated]},i.codeDescriptionSupport=!0,i.dataSupport=!0;const n=(0,d.ensure)(e,"window");(0,d.ensure)(n,"showMessage").messageActionItem={additionalPropertiesSupport:!0};(0,d.ensure)(n,"showDocument").support=!0;const o=(0,d.ensure)(e,"general");o.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(ne.RequestsToCancelOnContentModified)},o.regularExpressions={engine:"ECMAScript",version:"ES2020"},o.markdown={parser:"marked",version:"1.1.0"},o.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(o.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let t of this._features)t.fillClientCapabilities(e);return e}initializeFeatures(e){const t=this._clientOptions.documentSelector;for(const e of this._features)a.func(e.preInitialize)&&e.preInitialize(this._capabilities,t);for(const e of this._features)e.initialize(this._capabilities,t)}async handleRegistrationRequest(e){const t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,(e=>this.doRegisterCapability(e))):this.doRegisterCapability(e)}async doRegisterCapability(e){if(this.isRunning())for(const t of e.registrations){const e=this._dynamicFeatures.get(t.method);if(void 0===e)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));const i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;const n={id:t.id,registerOptions:i};try{e.register(n)}catch(e){return Promise.reject(e)}}else for(const t of e.registrations)this._ignoredRegistrations.add(t.id)}async handleUnregistrationRequest(e){const t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,(e=>this.doUnregisterCapability(e))):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(const t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;const e=this._dynamicFeatures.get(t.method);if(!e)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));e.unregister(t.id)}}async handleApplyWorkspaceEdit(e){const t=e.edit,i=await this.workspaceEditLock.lock((()=>this._p2c.asWorkspaceEdit(t))),o=new Map;n.workspace.textDocuments.forEach((e=>o.set(e.uri.toString(),e)));let s=!1;if(t.documentChanges)for(const e of t.documentChanges)if(r.TextDocumentEdit.is(e)&&e.textDocument.version&&e.textDocument.version>=0){const t=this._p2c.asUri(e.textDocument.uri).toString(),i=o.get(t);if(i&&i.version!==e.textDocument.version){s=!0;break}}return s?Promise.resolve({applied:!1}):a.asPromise(n.workspace.applyEdit(i).then((e=>({applied:e}))))}handleFailedRequest(e,t,i,o,s=!0){if(i instanceof r.ResponseError){if(i.code===r.ErrorCodes.PendingResponseRejected||i.code===r.ErrorCodes.ConnectionInactive)return o;if(i.code===r.LSPErrorCodes.RequestCancelled||i.code===r.LSPErrorCodes.ServerCancelled){if(void 0!==t&&t.isCancellationRequested)return o;throw void 0!==i.data?new d.LSPCancellationError(i.data):new n.CancellationError}if(i.code===r.LSPErrorCodes.ContentModified){if(ne.RequestsToCancelOnContentModified.has(e.method)||ne.CancellableResolveCalls.has(e.method))throw new n.CancellationError;return o}}throw this.error(`Request ${e.method} failed.`,i,s),i}}t.dp=ne,ne.RequestsToCancelOnContentModified=new Set([r.SemanticTokensRequest.method,r.SemanticTokensRangeRequest.method,r.SemanticTokensDeltaRequest.method]),ne.CancellableResolveCalls=new Set([r.CompletionResolveRequest.method,r.CodeLensResolveRequest.method,r.CodeActionResolveRequest.method,r.InlayHintResolveRequest.method,r.DocumentLinkResolveRequest.method,r.WorkspaceSymbolResolveRequest.method]);class re{error(e){(0,r.RAL)().console.error(e)}warn(e){(0,r.RAL)().console.warn(e)}info(e){(0,r.RAL)().console.info(e)}log(e){(0,r.RAL)().console.log(e)}}!function(e){e.createAll=function(e){return[new V.InlineCompletionItemFeature(e)]}}(te||(te={}))},81978:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeActionFeature=void 0;const n=i(9051),r=i(7846),o=i(66276),s=i(69169);class a extends s.TextDocumentLanguageFeature{constructor(e){super(e,r.CodeActionRequest.type)}fillClientCapabilities(e){const t=(0,s.ensure)((0,s.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[r.CodeActionKind.Empty,r.CodeActionKind.QuickFix,r.CodeActionKind.Refactor,r.CodeActionKind.RefactorExtract,r.CodeActionKind.RefactorInline,r.CodeActionKind.RefactorRewrite,r.CodeActionKind.Source,r.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.codeActionProvider);i&&this.register({id:o.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideCodeActions:(e,t,i,n)=>{const o=this._client,s=async(e,t,i,n)=>{const s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),range:o.code2ProtocolConverter.asRange(t),context:o.code2ProtocolConverter.asCodeActionContextSync(i)};return o.sendRequest(r.CodeActionRequest.type,s,n).then((e=>n.isCancellationRequested||null==e?null:o.protocol2CodeConverter.asCodeActionResult(e,n)),(e=>o.handleFailedRequest(r.CodeActionRequest.type,n,e,null)))},a=o.middleware;return a.provideCodeActions?a.provideCodeActions(e,t,i,n,s):s(e,t,i,n)},resolveCodeAction:e.resolveProvider?(e,t)=>{const i=this._client,n=this._client.middleware,o=async(e,t)=>i.sendRequest(r.CodeActionResolveRequest.type,i.code2ProtocolConverter.asCodeActionSync(e),t).then((n=>t.isCancellationRequested?e:i.protocol2CodeConverter.asCodeAction(n,t)),(n=>i.handleFailedRequest(r.CodeActionResolveRequest.type,t,n,e)));return n.resolveCodeAction?n.resolveCodeAction(e,t,o):o(e,t)}:void 0};return[n.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),i]}}t.CodeActionFeature=a},64092:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConverter=void 0;const n=i(9051),r=i(7846),o=i(92735),s=i(28419),a=i(66284),c=i(53610),u=i(7450),l=i(12104),d=i(79167),h=i(99070),g=i(21412),f=i(24613),p=i(25256);var m;!function(e){e.is=function(e){const t=e;return t&&!!t.inserting&&!!t.replacing}}(m||(m={})),t.createConverter=function(e){const t=e||(e=>e.toString());function i(e){return t(e)}function v(e){return{uri:t(e.uri)}}function y(e){return{uri:t(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}function C(e){switch(e){case n.TextDocumentSaveReason.Manual:return r.TextDocumentSaveReason.Manual;case n.TextDocumentSaveReason.AfterDelay:return r.TextDocumentSaveReason.AfterDelay;case n.TextDocumentSaveReason.FocusOut:return r.TextDocumentSaveReason.FocusOut}return r.TextDocumentSaveReason.Manual}function w(e){switch(e){case n.CompletionTriggerKind.TriggerCharacter:return r.CompletionTriggerKind.TriggerCharacter;case n.CompletionTriggerKind.TriggerForIncompleteCompletions:return r.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return r.CompletionTriggerKind.Invoked}}function S(e){switch(e){case n.SignatureHelpTriggerKind.Invoke:return r.SignatureHelpTriggerKind.Invoked;case n.SignatureHelpTriggerKind.TriggerCharacter:return r.SignatureHelpTriggerKind.TriggerCharacter;case n.SignatureHelpTriggerKind.ContentChange:return r.SignatureHelpTriggerKind.ContentChange}}function R(e){return{label:e.label}}function _(e){return{label:e.label,parameters:(t=e.parameters,t.map(R))};var t}function b(e){return{line:e.line,character:e.character}}function k(e){return null==e?e:{line:e.line>r.uinteger.MAX_VALUE?r.uinteger.MAX_VALUE:e.line,character:e.character>r.uinteger.MAX_VALUE?r.uinteger.MAX_VALUE:e.character}}function D(e){return null==e?e:{start:k(e.start),end:k(e.end)}}function T(e){return null==e?e:r.Location.create(i(e.uri),D(e.range))}function E(e){switch(e){case n.DiagnosticSeverity.Error:return r.DiagnosticSeverity.Error;case n.DiagnosticSeverity.Warning:return r.DiagnosticSeverity.Warning;case n.DiagnosticSeverity.Information:return r.DiagnosticSeverity.Information;case n.DiagnosticSeverity.Hint:return r.DiagnosticSeverity.Hint}}function P(e){switch(e){case n.DiagnosticTag.Unnecessary:return r.DiagnosticTag.Unnecessary;case n.DiagnosticTag.Deprecated:return r.DiagnosticTag.Deprecated;default:return}}function O(e){return{message:e.message,location:T(e.location)}}function x(e){const t=r.Diagnostic.create(D(e.range),e.message),n=e instanceof d.ProtocolDiagnostic?e:void 0;void 0!==n&&void 0!==n.data&&(t.data=n.data);const s=function(e){if(null!=e)return o.number(e)||o.string(e)?e:{value:e.value,target:i(e.target)}}(e.code);return d.DiagnosticCode.is(s)?void 0!==n&&n.hasDiagnosticCode?t.code=s:(t.code=s.value,t.codeDescription={href:s.target}):t.code=s,o.number(e.severity)&&(t.severity=E(e.severity)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=P(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(O)),e.source&&(t.source=e.source),t}function I(e,t){return null==e?e:s.map(e,x,t)}function M(e){return null==e?e:e.map(x)}function F(e){if(e===n.CompletionItemTag.Deprecated)return r.CompletionItemTag.Deprecated}function N(e){return{range:D(e.range),newText:e.newText}}function A(e){return null==e?e:e.map(N)}function L(e){return e<=n.SymbolKind.TypeParameter?e+1:r.SymbolKind.Property}function q(e){return e}function W(e){return e.map(q)}function j(e){switch(e){case n.CodeActionTriggerKind.Invoke:return r.CodeActionTriggerKind.Invoked;case n.CodeActionTriggerKind.Automatic:return r.CodeActionTriggerKind.Automatic;default:return}}function U(e){if(null!=e)return e.value}function K(e){let t=r.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}function $(e){const t=r.InlayHintLabelPart.create(e.value);return void 0!==e.location&&(t.location=T(e.location)),void 0!==e.command&&(t.command=K(e.command)),void 0!==e.tooltip&&(t.tooltip=H(e.tooltip)),t}function H(e){if("string"==typeof e)return e;return{kind:r.MarkupKind.Markdown,value:e.value}}return{asUri:i,asTextDocumentIdentifier:v,asTextDocumentItem:y,asVersionedTextDocumentIdentifier:function(e){return{uri:t(e.uri),version:e.version}},asOpenTextDocumentParams:function(e){return{textDocument:y(e)}},asChangeTextDocumentParams:function(e,i,n){if(function(e){const t=e;return!!t.uri&&!!t.version}(e)){return{textDocument:{uri:t(e.uri),version:e.version},contentChanges:[{text:e.getText()}]}}if(function(e){const t=e;return!!t.document&&!!t.contentChanges}(e)){const r=n;return{textDocument:{uri:t(i),version:r},contentChanges:e.contentChanges.map((e=>{const t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}}))}}throw Error("Unsupported text document change parameter")},asCloseTextDocumentParams:function(e){return{textDocument:v(e)}},asSaveTextDocumentParams:function(e,t=!1){let i={textDocument:v(e)};return t&&(i.text=e.getText()),i},asWillSaveTextDocumentParams:function(e){return{textDocument:v(e.document),reason:C(e.reason)}},asDidCreateFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asDidRenameFilesParams:function(e){return{files:e.files.map((e=>({oldUri:t(e.oldUri),newUri:t(e.newUri)})))}},asDidDeleteFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asWillCreateFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asWillRenameFilesParams:function(e){return{files:e.files.map((e=>({oldUri:t(e.oldUri),newUri:t(e.newUri)})))}},asWillDeleteFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asTextDocumentPositionParams:function(e,t){return{textDocument:v(e),position:b(t)}},asCompletionParams:function(e,t,i){return{textDocument:v(e),position:b(t),context:{triggerKind:w(i.triggerKind),triggerCharacter:i.triggerCharacter}}},asSignatureHelpParams:function(e,t,i){return{textDocument:v(e),position:b(t),context:{isRetrigger:i.isRetrigger,triggerCharacter:i.triggerCharacter,triggerKind:S(i.triggerKind),activeSignatureHelp:(n=i.activeSignatureHelp,void 0===n?n:{signatures:(r=n.signatures,r.map(_)),activeSignature:n.activeSignature,activeParameter:n.activeParameter})}};var n,r},asWorkerPosition:b,asRange:D,asRanges:function(e){return e.map(D)},asPosition:k,asPositions:function(e,t){return s.map(e,k,t)},asPositionsSync:function(e){return e.map(k)},asLocation:T,asDiagnosticSeverity:E,asDiagnosticTag:P,asDiagnostic:x,asDiagnostics:I,asDiagnosticsSync:M,asCompletionItem:function(e,t=!1){let i,s;o.string(e.label)?i=e.label:(i=e.label.label,!t||void 0===e.label.detail&&void 0===e.label.description||(s={detail:e.label.detail,description:e.label.description}));let c={label:i};void 0!==s&&(c.labelDetails=s);let u=e instanceof a.default?e:void 0;var l,d;e.detail&&(c.detail=e.detail),e.documentation&&(u&&"$string"!==u.documentationFormat?c.documentation=function(e,t){switch(e){case"$string":return t;case r.MarkupKind.PlainText:return{kind:e,value:t};case r.MarkupKind.Markdown:return{kind:e,value:t.value};default:return`Unsupported Markup content received. Kind is: ${e}`}}(u.documentationFormat,e.documentation):c.documentation=e.documentation),e.filterText&&(c.filterText=e.filterText),function(e,t){let i,o,s=r.InsertTextFormat.PlainText;t.textEdit?(i=t.textEdit.newText,o=t.textEdit.range):t.insertText instanceof n.SnippetString?(s=r.InsertTextFormat.Snippet,i=t.insertText.value):i=t.insertText;t.range&&(o=t.range);e.insertTextFormat=s,t.fromEdit&&void 0!==i&&void 0!==o?e.textEdit=function(e,t){return m.is(t)?r.InsertReplaceEdit.create(e,D(t.inserting),D(t.replacing)):{newText:e,range:D(t)}}(i,o):e.insertText=i}(c,e),o.number(e.kind)&&(c.kind=(l=e.kind,void 0!==(d=u&&u.originalItemKind)?d:l+1)),e.sortText&&(c.sortText=e.sortText),e.additionalTextEdits&&(c.additionalTextEdits=A(e.additionalTextEdits)),e.commitCharacters&&(c.commitCharacters=e.commitCharacters.slice()),e.command&&(c.command=K(e.command)),!0!==e.preselect&&!1!==e.preselect||(c.preselect=e.preselect);const h=function(e){if(void 0===e)return e;const t=[];for(let i of e){const e=F(i);void 0!==e&&t.push(e)}return t}(e.tags);if(u){if(void 0!==u.data&&(c.data=u.data),!0===u.deprecated||!1===u.deprecated){if(!0===u.deprecated&&void 0!==h&&h.length>0){const e=h.indexOf(n.CompletionItemTag.Deprecated);-1!==e&&h.splice(e,1)}c.deprecated=u.deprecated}void 0!==u.insertTextMode&&(c.insertTextMode=u.insertTextMode)}return void 0!==h&&h.length>0&&(c.tags=h),void 0===c.insertTextMode&&!0===e.keepWhitespace&&(c.insertTextMode=r.InsertTextMode.adjustIndentation),c},asTextEdit:N,asSymbolKind:L,asSymbolTag:q,asSymbolTags:W,asReferenceParams:function(e,t,i){return{textDocument:v(e),position:b(t),context:{includeDeclaration:i.includeDeclaration}}},asCodeAction:async function(e,t){let i=r.CodeAction.create(e.title);if(e instanceof l.default&&void 0!==e.data&&(i.data=e.data),void 0!==e.kind&&(i.kind=U(e.kind)),void 0!==e.diagnostics&&(i.diagnostics=await I(e.diagnostics,t)),void 0!==e.edit)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return void 0!==e.command&&(i.command=K(e.command)),void 0!==e.isPreferred&&(i.isPreferred=e.isPreferred),void 0!==e.disabled&&(i.disabled={reason:e.disabled.reason}),i},asCodeActionSync:function(e){let t=r.CodeAction.create(e.title);if(e instanceof l.default&&void 0!==e.data&&(t.data=e.data),void 0!==e.kind&&(t.kind=U(e.kind)),void 0!==e.diagnostics&&(t.diagnostics=M(e.diagnostics)),void 0!==e.edit)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return void 0!==e.command&&(t.command=K(e.command)),void 0!==e.isPreferred&&(t.isPreferred=e.isPreferred),void 0!==e.disabled&&(t.disabled={reason:e.disabled.reason}),t},asCodeActionContext:async function(e,t){if(null==e)return e;let i;return e.only&&o.string(e.only.value)&&(i=[e.only.value]),r.CodeActionContext.create(await I(e.diagnostics,t),i,j(e.triggerKind))},asCodeActionContextSync:function(e){if(null==e)return e;let t;return e.only&&o.string(e.only.value)&&(t=[e.only.value]),r.CodeActionContext.create(M(e.diagnostics),t,j(e.triggerKind))},asInlineValueContext:function(e){return null==e?e:r.InlineValueContext.create(e.frameId,D(e.stoppedLocation))},asCommand:K,asCodeLens:function(e){let t=r.CodeLens.create(D(e.range));return e.command&&(t.command=K(e.command)),e instanceof c.default&&e.data&&(t.data=e.data),t},asFormattingOptions:function(e,t){const i={tabSize:e.tabSize,insertSpaces:e.insertSpaces};return t.trimTrailingWhitespace&&(i.trimTrailingWhitespace=!0),t.trimFinalNewlines&&(i.trimFinalNewlines=!0),t.insertFinalNewline&&(i.insertFinalNewline=!0),i},asDocumentSymbolParams:function(e){return{textDocument:v(e)}},asCodeLensParams:function(e){return{textDocument:v(e)}},asDocumentLink:function(e){let t=r.DocumentLink.create(D(e.range));e.target&&(t.target=i(e.target)),void 0!==e.tooltip&&(t.tooltip=e.tooltip);let n=e instanceof u.default?e:void 0;return n&&n.data&&(t.data=n.data),t},asDocumentLinkParams:function(e){return{textDocument:v(e)}},asCallHierarchyItem:function(e){const t={name:e.name,kind:L(e.kind),uri:i(e.uri),range:D(e.range),selectionRange:D(e.selectionRange)};return void 0!==e.detail&&e.detail.length>0&&(t.detail=e.detail),void 0!==e.tags&&(t.tags=W(e.tags)),e instanceof h.default&&void 0!==e.data&&(t.data=e.data),t},asTypeHierarchyItem:function(e){const t={name:e.name,kind:L(e.kind),uri:i(e.uri),range:D(e.range),selectionRange:D(e.selectionRange)};return void 0!==e.detail&&e.detail.length>0&&(t.detail=e.detail),void 0!==e.tags&&(t.tags=W(e.tags)),e instanceof g.default&&void 0!==e.data&&(t.data=e.data),t},asInlayHint:function(e){const t="string"==typeof e.label?e.label:e.label.map($),i=r.InlayHint.create(k(e.position),t);return void 0!==e.kind&&(i.kind=e.kind),void 0!==e.textEdits&&(i.textEdits=A(e.textEdits)),void 0!==e.tooltip&&(i.tooltip=H(e.tooltip)),void 0!==e.paddingLeft&&(i.paddingLeft=e.paddingLeft),void 0!==e.paddingRight&&(i.paddingRight=e.paddingRight),e instanceof p.default&&void 0!==e.data&&(i.data=e.data),i},asWorkspaceSymbol:function(e){const i=e instanceof f.default?{name:e.name,kind:L(e.kind),location:e.hasRange?T(e.location):{uri:t(e.location.uri)},data:e.data}:{name:e.name,kind:L(e.kind),location:T(e.location)};return void 0!==e.tags&&(i.tags=W(e.tags)),""!==e.containerName&&(i.containerName=e.containerName),i},asInlineCompletionParams:function(e,t,i){return{context:r.InlineCompletionContext.create(i.triggerKind,i.selectedCompletionInfo),textDocument:v(e),position:k(t)}}}}},34732:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeLensFeature=void 0;const n=i(9051),r=i(7846),o=i(66276),s=i(69169);class a extends s.TextDocumentLanguageFeature{constructor(e){super(e,r.CodeLensRequest.type)}fillClientCapabilities(e){(0,s.ensure)((0,s.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,s.ensure)((0,s.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(r.CodeLensRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeCodeLensEmitter.fire()}));const i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:o.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i=new n.EventEmitter,o={onDidChangeCodeLenses:i.event,provideCodeLenses:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.CodeLensRequest.type,i.code2ProtocolConverter.asCodeLensParams(e),t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asCodeLenses(e,t)),(e=>i.handleFailedRequest(r.CodeLensRequest.type,t,e,null))),o=i.middleware;return o.provideCodeLenses?o.provideCodeLenses(e,t,n):n(e,t)},resolveCodeLens:e.resolveProvider?(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.CodeLensResolveRequest.type,i.code2ProtocolConverter.asCodeLens(e),t).then((n=>t.isCancellationRequested?e:i.protocol2CodeConverter.asCodeLens(n)),(n=>i.handleFailedRequest(r.CodeLensResolveRequest.type,t,n,e))),o=i.middleware;return o.resolveCodeLens?o.resolveCodeLens(e,t,n):n(e,t)}:void 0};return[n.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),o),{provider:o,onDidChangeCodeLensEmitter:i}]}}t.CodeLensFeature=a},75764:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorProviderFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentColorRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.colorProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i={provideColorPresentations:(e,t,i)=>{const n=this._client,o=(e,t,i)=>{const o={color:e,textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(t.document),range:n.code2ProtocolConverter.asRange(t.range)};return n.sendRequest(r.ColorPresentationRequest.type,o,i).then((e=>i.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(e,i)),(e=>n.handleFailedRequest(r.ColorPresentationRequest.type,i,e,null)))},s=n.middleware;return s.provideColorPresentations?s.provideColorPresentations(e,t,i,o):o(e,t,i)},provideDocumentColors:(e,t)=>{const i=this._client,n=(e,t)=>{const n={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(r.DocumentColorRequest.type,n,t).then((e=>t.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(e,t)),(e=>i.handleFailedRequest(r.DocumentColorRequest.type,t,e,null)))},o=i.middleware;return o.provideDocumentColors?o.provideDocumentColors(e,t,n):n(e,t)}};return[n.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}}t.ColorProviderFeature=s},59443:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompletionItemFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276),a=[r.CompletionItemKind.Text,r.CompletionItemKind.Method,r.CompletionItemKind.Function,r.CompletionItemKind.Constructor,r.CompletionItemKind.Field,r.CompletionItemKind.Variable,r.CompletionItemKind.Class,r.CompletionItemKind.Interface,r.CompletionItemKind.Module,r.CompletionItemKind.Property,r.CompletionItemKind.Unit,r.CompletionItemKind.Value,r.CompletionItemKind.Enum,r.CompletionItemKind.Keyword,r.CompletionItemKind.Snippet,r.CompletionItemKind.Color,r.CompletionItemKind.File,r.CompletionItemKind.Reference,r.CompletionItemKind.Folder,r.CompletionItemKind.EnumMember,r.CompletionItemKind.Constant,r.CompletionItemKind.Struct,r.CompletionItemKind.Event,r.CompletionItemKind.Operator,r.CompletionItemKind.TypeParameter];class c extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[r.MarkupKind.Markdown,r.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[r.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[r.InsertTextMode.asIs,r.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=r.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:a},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){const i=this.getRegistrationOptions(t,e.completionProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);const i=e.triggerCharacters??[],o=e.allCommitCharacters,s=e.documentSelector,a={provideCompletionItems:(e,t,i,n)=>{const s=this._client,a=this._client.middleware,c=(e,t,i,n)=>s.sendRequest(r.CompletionRequest.type,s.code2ProtocolConverter.asCompletionParams(e,t,i),n).then((e=>n.isCancellationRequested?null:s.protocol2CodeConverter.asCompletionResult(e,o,n)),(e=>s.handleFailedRequest(r.CompletionRequest.type,n,e,null)));return a.provideCompletionItem?a.provideCompletionItem(e,t,n,i,c):c(e,t,n,i)},resolveCompletionItem:e.resolveProvider?(e,i)=>{const n=this._client,o=this._client.middleware,s=(e,i)=>n.sendRequest(r.CompletionResolveRequest.type,n.code2ProtocolConverter.asCompletionItem(e,!!this.labelDetailsSupport.get(t)),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asCompletionItem(e)),(t=>n.handleFailedRequest(r.CompletionResolveRequest.type,i,t,e)));return o.resolveCompletionItem?o.resolveCompletionItem(e,i,s):s(e,i)}:void 0};return[n.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),a,...i),a]}}t.CompletionItemFeature=c},99211:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncConfigurationFeature=t.toJSONObject=t.ConfigurationFeature=void 0;const n=i(9051),r=i(7846),o=i(92735),s=i(66276),a=i(69169);function c(e){if(e){if(Array.isArray(e))return e.map(c);if("object"==typeof e){const t=Object.create(null);for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=c(e[i]));return t}}return e}t.ConfigurationFeature=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(r.ConfigurationRequest.type,((t,i)=>{let n=e=>{let t=[];for(let i of e.items){let e=void 0!==i.scopeUri&&null!==i.scopeUri?this._client.protocol2CodeConverter.asUri(i.scopeUri):void 0;t.push(this.getConfiguration(e,null!==i.section?i.section:void 0))}return t},r=e.middleware.workspace;return r&&r.configuration?r.configuration(t,i,n):n(t)}))}getConfiguration(e,t){let i=null;if(t){let r=t.lastIndexOf(".");if(-1===r)i=c(n.workspace.getConfiguration(void 0,e).get(t));else{let o=n.workspace.getConfiguration(t.substr(0,r),e);o&&(i=c(o.get(t.substr(r+1))))}}else{let t=n.workspace.getConfiguration(void 0,e);i={};for(let e of Object.keys(t))t.has(e)&&(i[e]=c(t.get(e)))}return void 0===i&&(i=null),i}clear(){}},t.toJSONObject=c;t.SyncConfigurationFeature=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return r.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,a.ensure)((0,a.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;void 0!==e&&this.register({id:s.generateUuid(),registerOptions:{section:e}})}register(e){let t=n.workspace.onDidChangeConfiguration((t=>{this.onDidChangeConfiguration(e.registerOptions.section,t)}));this._listeners.set(e.id,t),void 0!==e.registerOptions.section&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(const e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let i;if(i=o.string(e)?[e]:e,void 0!==i&&void 0!==t){if(!i.some((e=>t.affectsConfiguration(e))))return}const n=async e=>void 0===e?this._client.sendNotification(r.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(r.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)});let s=this._client.middleware.workspace?.didChangeConfiguration;(s?s(i,n):n(i)).catch((e=>{this._client.error(`Sending notification ${r.DidChangeConfigurationNotification.type.method} failed`,e)}))}extractSettingsInformation(e){function t(e,t){let i=e;for(let e=0;e<t.length-1;e++){let n=i[t[e]];n||(n=Object.create(null),i[t[e]]=n),i=n}return i}let i=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,r=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),u=null;if(u=a>=0?n.workspace.getConfiguration(s.substr(0,a),i).get(s.substr(a+1)):n.workspace.getConfiguration(void 0,i).get(s),u){let i=e[o].split(".");t(r,i)[i[i.length-1]]=c(u)}}return r}}},42080:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.DeclarationRequest.type)}fillClientCapabilities(e){const t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.declarationProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDeclaration:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.DeclarationRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asDeclarationResult(e,i)),(e=>n.handleFailedRequest(r.DeclarationRequest.type,i,e,null))),s=n.middleware;return s.provideDeclaration?s.provideDeclaration(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.DeclarationFeature=s},77192:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.definitionProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDefinition:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.DefinitionRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asDefinitionResult(e,i)),(e=>n.handleFailedRequest(r.DefinitionRequest.type,i,e,null))),s=n.middleware;return s.provideDefinition?s.provideDefinition(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.DefinitionFeature=a},11750:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticFeature=t.DiagnosticPullMode=t.vsdiag=void 0;const n=i(84069),r=i(9051),o=i(7846),s=i(66276),a=i(69169);function c(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var u,l,d,h,g;!function(e){let t;!function(e){e.full="full",e.unChanged="unChanged"}(t=e.DocumentDiagnosticReportKind||(e.DocumentDiagnosticReportKind={}))}(u||(t.vsdiag=u={})),function(e){e.onType="onType",e.onSave="onSave"}(l||(t.DiagnosticPullMode=l={})),function(e){e.active="open",e.reschedule="reschedule",e.outDated="drop"}(d||(d={}));class f{constructor(){this.open=new Set,this._onOpen=new r.EventEmitter,this._onClose=new r.EventEmitter,f.fillTabResources(this.open);const e=e=>{if(0===e.closed.length&&0===e.opened.length)return;const t=this.open,i=new Set;f.fillTabResources(i);const n=new Set,o=new Set(i);for(const e of t.values())i.has(e)?o.delete(e):n.add(e);if(this.open=i,n.size>0){const e=new Set;for(const t of n)e.add(r.Uri.parse(t));this._onClose.fire(e)}if(o.size>0){const e=new Set;for(const t of o)e.add(r.Uri.parse(t));this._onOpen.fire(e)}};void 0!==r.window.tabGroups.onDidChangeTabs?this.disposable=r.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof r.Uri?r.window.activeTextEditor?.document.uri===e:r.window.activeTextEditor?.document===e}isVisible(e){const t=e instanceof r.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){const e=new Set;return f.fillTabResources(new Set,e),e}static fillTabResources(e,t){const i=e??new Set;for(const e of r.window.tabGroups.all)for(const n of e.tabs){const e=n.input;let o;e instanceof r.TabInputText?o=e.uri:e instanceof r.TabInputTextDiff?o=e.modified:e instanceof r.TabInputCustom&&(o=e.uri),void 0===o||i.has(o.toString())||(i.add(o.toString()),void 0!==t&&t.add(o))}}}!function(e){e[e.document=1]="document",e[e.workspace=2]="workspace"}(h||(h={})),function(e){e.asKey=function(e){return e instanceof r.Uri?e.toString():e.uri.toString()}}(g||(g={}));class p{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,i){const n=e===h.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=t instanceof r.Uri?[t.toString(),t,i]:[t.uri.toString(),t.uri,t.version];let c=n.get(o);return void 0===c&&(c={document:s,pulledVersion:a,resultId:void 0},n.set(o,c)),c}update(e,t,i,n){const o=e===h.document?this.documentPullStates:this.workspacePullStates,[s,a,c,u]=t instanceof r.Uri?[t.toString(),t,i,n]:[t.uri.toString(),t.uri,t.version,i];let l=o.get(s);void 0===l?(l={document:a,pulledVersion:c,resultId:u},o.set(s,l)):(l.pulledVersion=c,l.resultId=u)}unTrack(e,t){const i=g.asKey(t);(e===h.document?this.documentPullStates:this.workspacePullStates).delete(i)}tracks(e,t){const i=g.asKey(t);return(e===h.document?this.documentPullStates:this.workspacePullStates).has(i)}getResultId(e,t){const i=g.asKey(t),n=e===h.document?this.documentPullStates:this.workspacePullStates;return n.get(i)?.resultId}getAllResultIds(){const e=[];for(let[t,i]of this.workspacePullStates)this.documentPullStates.has(t)&&(i=this.documentPullStates.get(t)),void 0!==i.resultId&&e.push({uri:t,value:i.resultId});return e}}class m{constructor(e,t,i){this.client=e,this.tabs=t,this.options=i,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new r.EventEmitter,this.provider=this.createProvider(),this.diagnostics=r.languages.createDiagnosticCollection(i.identifier),this.openRequests=new Map,this.documentStates=new p,this.workspaceErrorCounter=0}knows(e,t){const i=t instanceof r.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(i.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;const i=e instanceof r.Uri?e:e.uri;this.pullAsync(e).then((()=>{t&&t()}),(e=>{this.client.error(`Document pull failed for text document ${i.toString()}`,e,!1)}))}async pullAsync(e,t){if(this.isDisposed)return;const i=e instanceof r.Uri,n=i?e:e.uri,s=n.toString();t=i?t:e.version;const c=this.openRequests.get(s),l=i?this.documentStates.track(h.document,e,t):this.documentStates.track(h.document,e);if(void 0===c){const i=new r.CancellationTokenSource;let c,g;this.openRequests.set(s,{state:d.active,document:e,version:t,tokenSource:i});try{c=await this.provider.provideDiagnostics(e,l.resultId,i.token)??{kind:u.DocumentDiagnosticReportKind.full,items:[]}}catch(t){if(t instanceof a.LSPCancellationError&&o.DiagnosticServerCancellationData.is(t.data)&&!1===t.data.retriggerRequest&&(g={state:d.outDated,document:e}),!(void 0===g&&t instanceof r.CancellationError))throw t;g={state:d.reschedule,document:e}}if(g=g??this.openRequests.get(s),void 0===g)return this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),void this.diagnostics.delete(n);if(this.openRequests.delete(s),!this.tabs.isVisible(e))return void this.documentStates.unTrack(h.document,e);if(g.state===d.outDated)return;void 0!==c&&(c.kind===u.DocumentDiagnosticReportKind.full&&this.diagnostics.set(n,c.items),l.pulledVersion=t,l.resultId=c.resultId),g.state===d.reschedule&&this.pull(e)}else c.state===d.active?(c.tokenSource.cancel(),this.openRequests.set(s,{state:d.reschedule,document:c.document})):c.state===d.outDated&&this.openRequests.set(s,{state:d.reschedule,document:c.document})}forgetDocument(e){const t=e instanceof r.Uri?e:e.uri,i=t.toString(),n=this.openRequests.get(i);this.options.workspaceDiagnostics?void 0!==n?this.openRequests.set(i,{state:d.reschedule,document:e}):this.pull(e,(()=>{this.forget(h.document,e)})):(void 0!==n&&(n.state===d.active&&n.tokenSource.cancel(),this.openRequests.set(i,{state:d.outDated,document:e})),this.diagnostics.delete(t),this.forget(h.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then((()=>{this.workspaceTimeout=(0,o.RAL)().timer.setTimeout((()=>{this.pullWorkspace()}),2e3)}),(e=>{e instanceof a.LSPCancellationError||o.DiagnosticServerCancellationData.is(e.data)||(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,o.RAL)().timer.setTimeout((()=>{this.pullWorkspace()}),2e3))}))}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;void 0!==this.workspaceCancellation&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new r.CancellationTokenSource;const e=this.documentStates.getAllResultIds().map((e=>({uri:this.client.protocol2CodeConverter.asUri(e.uri),value:e.value})));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,(e=>{if(e&&!this.isDisposed)for(const t of e.items)t.kind===u.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(h.document,t.uri)||this.diagnostics.set(t.uri,t.items)),this.documentStates.update(h.workspace,t.uri,t.version??void 0,t.resultId)}))}createProvider(){const e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(e,t,i)=>{const n=(e,t,i)=>{const n={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(e instanceof r.Uri?e:e.uri)},previousResultId:t};return!0!==this.isDisposed&&this.client.isRunning()?this.client.sendRequest(o.DocumentDiagnosticRequest.type,n,i).then((async e=>null==e||this.isDisposed||i.isCancellationRequested?{kind:u.DocumentDiagnosticReportKind.full,items:[]}:e.kind===o.DocumentDiagnosticReportKind.Full?{kind:u.DocumentDiagnosticReportKind.full,resultId:e.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(e.items,i)}:{kind:u.DocumentDiagnosticReportKind.unChanged,resultId:e.resultId}),(e=>this.client.handleFailedRequest(o.DocumentDiagnosticRequest.type,i,e,{kind:u.DocumentDiagnosticReportKind.full,items:[]}))):{kind:u.DocumentDiagnosticReportKind.full,items:[]}},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(e,t,i,n):n(e,t,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(e,t,i)=>{const n=async e=>e.kind===o.DocumentDiagnosticReportKind.Full?{kind:u.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(e.uri),resultId:e.resultId,version:e.version,items:await this.client.protocol2CodeConverter.asDiagnostics(e.items,t)}:{kind:u.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(e.uri),resultId:e.resultId,version:e.version},r=e=>{const t=[];for(const i of e)t.push({uri:this.client.code2ProtocolConverter.asUri(i.uri),value:i.value});return t},a=(e,t)=>{const a=(0,s.generateUuid)(),c=this.client.onProgress(o.WorkspaceDiagnosticRequest.partialResult,a,(async e=>{if(null==e)return void i(null);const t={items:[]};for(const i of e.items)try{t.items.push(await n(i))}catch(e){this.client.error("Converting workspace diagnostics failed.",e)}i(t)})),u={identifier:this.options.identifier,previousResultIds:r(e),partialResultToken:a};return!0!==this.isDisposed&&this.client.isRunning()?this.client.sendRequest(o.WorkspaceDiagnosticRequest.type,u,t).then((async e=>{if(t.isCancellationRequested)return{items:[]};const r={items:[]};for(const t of e.items)r.items.push(await n(t));return c.dispose(),i(r),{items:[]}}),(e=>(c.dispose(),this.client.handleFailedRequest(o.DocumentDiagnosticRequest.type,t,e,{items:[]})))):{items:[]}},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(e,t,i,a):a(e,t)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(const[e,t]of this.openRequests)t.state===d.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:d.outDated,document:t.document});this.diagnostics.dispose()}}class v{constructor(e){this.diagnosticRequestor=e,this.documents=new o.LinkedMap,this.isDisposed=!1}add(e){if(!0===this.isDisposed)return;const t=g.asKey(e);this.documents.has(t)||(this.documents.set(t,e,o.Touch.Last),this.trigger())}remove(e){const t=g.asKey(e);this.documents.delete(t),0===this.documents.size?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){!0!==this.isDisposed&&(void 0===this.intervalHandle?(this.endDocument=this.documents.last,this.intervalHandle=(0,o.RAL)().timer.setInterval((()=>{const e=this.documents.first;if(void 0!==e){const t=g.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,o.Touch.Last),t===this.endDocumentKey()&&this.stop()}}),200)):this.endDocument=this.documents.last)}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return void 0!==this.endDocument?g.asKey(this.endDocument):void 0}}class y{constructor(e,t,i){const s=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},a=e.protocol2CodeConverter.asDocumentSelector(i.documentSelector),c=[],u=e=>e instanceof r.Uri?(e=>{const t=i.documentSelector;if(void 0!==s.match)return s.match(t,e);for(const i of t)if(o.TextDocumentFilter.is(i)){if("string"==typeof i)return!1;if(void 0!==i.language&&"*"!==i.language)return!1;if(void 0!==i.scheme&&"*"!==i.scheme&&i.scheme!==e.scheme)return!1;if(void 0!==i.pattern){const t=new n.Minimatch(i.pattern,{noext:!0});if(!t.makeRe())return!1;if(!t.match(e.fsPath))return!1}}return!0})(e):r.languages.match(a,e)>0&&t.isVisible(e),d=e=>e instanceof r.Uri?this.activeTextDocument?.uri.toString()===e.toString():this.activeTextDocument===e;this.diagnosticRequestor=new m(e,t,i),this.backgroundScheduler=new v(this.diagnosticRequestor);const g=e=>{u(e)&&i.interFileDependencies&&!d(e)&&this.backgroundScheduler.add(e)};this.activeTextDocument=r.window.activeTextEditor?.document,r.window.onDidChangeActiveTextEditor((e=>{const t=this.activeTextDocument;this.activeTextDocument=e?.document,void 0!==t&&g(t),void 0!==this.activeTextDocument&&this.backgroundScheduler.remove(this.activeTextDocument)}));const f=e.getFeature(o.DidOpenTextDocumentNotification.method);c.push(f.onNotificationSent((e=>{const t=e.textDocument;this.diagnosticRequestor.knows(h.document,t)||u(t)&&this.diagnosticRequestor.pull(t,(()=>{g(t)}))}))),c.push(t.onOpen((e=>{for(const t of e){if(this.diagnosticRequestor.knows(h.document,t))continue;const e=t.toString();let i;for(const t of r.workspace.textDocuments)if(e===t.uri.toString()){i=t;break}void 0!==i&&u(i)&&this.diagnosticRequestor.pull(i,(()=>{g(i)}))}})));const p=new Set;for(const e of r.workspace.textDocuments)u(e)&&(this.diagnosticRequestor.pull(e,(()=>{g(e)})),p.add(e.uri.toString()));if(!0===s.onTabs)for(const e of t.getTabResources())!p.has(e.toString())&&u(e)&&this.diagnosticRequestor.pull(e,(()=>{g(e)}));if(!0===s.onChange){const t=e.getFeature(o.DidChangeTextDocumentNotification.method);c.push(t.onNotificationSent((async e=>{const t=e.textDocument;void 0!==s.filter&&s.filter(t,l.onType)||!this.diagnosticRequestor.knows(h.document,t)||this.diagnosticRequestor.pull(t,(()=>{this.backgroundScheduler.trigger()}))})))}if(!0===s.onSave){const t=e.getFeature(o.DidSaveTextDocumentNotification.method);c.push(t.onNotificationSent((e=>{const t=e.textDocument;void 0!==s.filter&&s.filter(t,l.onSave)||!this.diagnosticRequestor.knows(h.document,t)||this.diagnosticRequestor.pull(e.textDocument,(()=>{this.backgroundScheduler.trigger()}))})))}const y=e.getFeature(o.DidCloseTextDocumentNotification.method);c.push(y.onNotificationSent((e=>{this.cleanUpDocument(e.textDocument)}))),t.onClose((e=>{for(const t of e)this.cleanUpDocument(t)})),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event((()=>{for(const e of r.workspace.textDocuments)u(e)&&this.diagnosticRequestor.pull(e)})),!0===i.workspaceDiagnostics&&"da348dc5-c30a-4515-9d98-31ff3be38d14"!==i.identifier&&this.diagnosticRequestor.pullWorkspace(),this.disposable=r.Disposable.from(...c,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(h.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}}class C extends a.TextDocumentLanguageFeature{constructor(e){super(e,o.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=c(c(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,c(c(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(o.DiagnosticRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeDiagnosticsEmitter.fire()}));let[i,n]=this.getRegistration(t,e.diagnosticProvider);i&&n&&this.register({id:i,registerOptions:n})}clear(){void 0!==this.tabs&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){void 0===this.tabs&&(this.tabs=new f);const t=new y(this._client,this.tabs,e);return[t.disposable,t]}}t.DiagnosticFeature=C},812:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentHighlightFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentHighlightProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDocumentHighlights:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.DocumentHighlightRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asDocumentHighlights(e,i)),(e=>n.handleFailedRequest(r.DocumentHighlightRequest.type,i,e,null))),s=n.middleware;return s.provideDocumentHighlights?s.provideDocumentHighlights(e,t,i,o):o(e,t,i)}};return[n.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}}t.DocumentHighlightFeature=a},37424:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentLinkFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentLinkProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDocumentLinks:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.DocumentLinkRequest.type,i.code2ProtocolConverter.asDocumentLinkParams(e),t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asDocumentLinks(e,t)),(e=>i.handleFailedRequest(r.DocumentLinkRequest.type,t,e,null))),o=i.middleware;return o.provideDocumentLinks?o.provideDocumentLinks(e,t,n):n(e,t)},resolveDocumentLink:e.resolveProvider?(e,t)=>{const i=this._client;let n=(e,t)=>i.sendRequest(r.DocumentLinkResolveRequest.type,i.code2ProtocolConverter.asDocumentLink(e),t).then((n=>t.isCancellationRequested?e:i.protocol2CodeConverter.asDocumentLink(n)),(n=>i.handleFailedRequest(r.DocumentLinkResolveRequest.type,t,n,e)));const o=i.middleware;return o.resolveDocumentLink?o.resolveDocumentLink(e,t,n):n(e,t)}:void 0};return[n.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}}t.DocumentLinkFeature=a},81982:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSymbolFeature=t.SupportedSymbolTags=t.SupportedSymbolKinds=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);t.SupportedSymbolKinds=[r.SymbolKind.File,r.SymbolKind.Module,r.SymbolKind.Namespace,r.SymbolKind.Package,r.SymbolKind.Class,r.SymbolKind.Method,r.SymbolKind.Property,r.SymbolKind.Field,r.SymbolKind.Constructor,r.SymbolKind.Enum,r.SymbolKind.Interface,r.SymbolKind.Function,r.SymbolKind.Variable,r.SymbolKind.Constant,r.SymbolKind.String,r.SymbolKind.Number,r.SymbolKind.Boolean,r.SymbolKind.Array,r.SymbolKind.Object,r.SymbolKind.Key,r.SymbolKind.Null,r.SymbolKind.EnumMember,r.SymbolKind.Struct,r.SymbolKind.Event,r.SymbolKind.Operator,r.SymbolKind.TypeParameter],t.SupportedSymbolTags=[r.SymbolTag.Deprecated];class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentSymbolRequest.type)}fillClientCapabilities(e){let i=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"documentSymbol");i.dynamicRegistration=!0,i.symbolKind={valueSet:t.SupportedSymbolKinds},i.hierarchicalDocumentSymbolSupport=!0,i.tagSupport={valueSet:t.SupportedSymbolTags},i.labelSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentSymbolProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDocumentSymbols:(e,t)=>{const i=this._client,n=async(e,t)=>{try{const n=await i.sendRequest(r.DocumentSymbolRequest.type,i.code2ProtocolConverter.asDocumentSymbolParams(e),t);if(t.isCancellationRequested||null==n)return null;if(0===n.length)return[];{const e=n[0];return r.DocumentSymbol.is(e)?await i.protocol2CodeConverter.asDocumentSymbols(n,t):await i.protocol2CodeConverter.asSymbolInformations(n,t)}}catch(e){return i.handleFailedRequest(r.DocumentSymbolRequest.type,t,e,null)}},o=i.middleware;return o.provideDocumentSymbols?o.provideDocumentSymbols(e,t,n):n(e,t)}},o=void 0!==e.label?{label:e.label}:void 0;return[n.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i,o),i]}}t.DocumentSymbolFeature=a},65612:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExecuteCommandFeature=void 0;const n=i(9051),r=i(7846),o=i(66276),s=i(69169);t.ExecuteCommandFeature=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return r.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,s.ensure)((0,s.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:o.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){const t=this._client,i=t.middleware,o=(e,i)=>{let n={command:e,arguments:i};return t.sendRequest(r.ExecuteCommandRequest.type,n).then(void 0,(e=>t.handleFailedRequest(r.ExecuteCommandRequest.type,void 0,e,void 0)))};if(e.registerOptions.commands){const t=[];for(const r of e.registerOptions.commands)t.push(n.commands.registerCommand(r,((...e)=>i.executeCommand?i.executeCommand(r,e,o):o(r,e))));this._commands.set(e.id,t)}}unregister(e){let t=this._commands.get(e);t&&t.forEach((e=>e.dispose()))}clear(){this._commands.forEach((e=>{e.forEach((e=>e.dispose()))})),this._commands.clear()}}},69169:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFeature=t.TextDocumentLanguageFeature=t.TextDocumentEventFeature=t.DynamicDocumentFeature=t.DynamicFeature=t.StaticFeature=t.ensure=t.LSPCancellationError=void 0;const n=i(9051),r=i(7846),o=i(92735),s=i(66276);class a extends n.CancellationError{constructor(e){super(),this.data=e}}var c,u;t.LSPCancellationError=a,t.ensure=function(e,t){return void 0===e[t]&&(e[t]={}),e[t]},function(e){e.is=function(e){const t=e;return null!=t&&o.func(t.fillClientCapabilities)&&o.func(t.initialize)&&o.func(t.getState)&&o.func(t.clear)&&(void 0===t.fillInitializeParams||o.func(t.fillInitializeParams))}}(c||(t.StaticFeature=c={})),function(e){e.is=function(e){const t=e;return null!=t&&o.func(t.fillClientCapabilities)&&o.func(t.initialize)&&o.func(t.getState)&&o.func(t.clear)&&(void 0===t.fillInitializeParams||o.func(t.fillInitializeParams))&&o.func(t.register)&&o.func(t.unregister)&&void 0!==t.registrationType}}(u||(t.DynamicFeature=u={}));class l{constructor(e){this._client=e}getState(){const e=this.getDocumentSelectors();let t=0;for(const i of e){t++;for(const e of n.workspace.textDocuments)if(n.languages.match(i,e)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const i=t>0;return{kind:"document",id:this.registrationType.method,registrations:i,matches:!1}}}t.DynamicDocumentFeature=l;t.TextDocumentEventFeature=class extends l{static textDocumentFilter(e,t){for(const i of e)if(n.languages.match(i,t)>0)return!0;return!1}constructor(e,t,i,r,o,s,a){super(e),this._event=t,this._type=i,this._middleware=r,this._createParams=o,this._textDocument=s,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new n.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event((e=>{this.callback(e).catch((e=>{this._client.error(`Sending document notification ${this._type.method} failed.`,e)}))}))),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){const t=async e=>{const t=this._createParams(e);await this._client.sendNotification(this._type,t),this.notificationSent(this.getTextDocument(e),this._type,t)};if(this.matches(e)){const i=this._middleware();return i?i(e,(e=>t(e))):t(e)}}matches(e){return!this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))&&(!this._selectorFilter||this._selectorFilter(this._selectors.values(),e))}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,i){this._onNotificationSent.fire({textDocument:e,type:t,params:i})}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const t of this._selectors.values())if(n.languages.match(t,e)>0)return{send:e=>this.callback(e)}}};t.TextDocumentLanguageFeature=class extends l{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(const e of this._registrations.values()){const t=e.data.registerOptions.documentSelector;null!==t&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}clear(){this._registrations.forEach((e=>{e.disposable.dispose()})),this._registrations.clear()}getRegistration(e,t){if(!t)return[void 0,void 0];if(r.TextDocumentRegistrationOptions.is(t)){const i=r.StaticRegistrationOptions.hasId(t)?t.id:s.generateUuid(),n=t.documentSelector??e;if(n)return[i,Object.assign({},t,{documentSelector:n})]}else if(o.boolean(t)&&!0===t||r.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];const i=o.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[s.generateUuid(),i]}return[void 0,void 0]}getRegistrationOptions(e,t){if(e&&t)return o.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const t of this._registrations.values()){let i=t.data.registerOptions.documentSelector;if(null!==i&&n.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(i),e)>0)return t.provider}}getAllProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}};t.WorkspaceFeature=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){const e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){const t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}clear(){this._registrations.forEach((e=>{e.disposable.dispose()})),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}},22999:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesFeature=t.WillRenameFilesFeature=t.WillCreateFilesFeature=t.DidDeleteFilesFeature=t.DidRenameFilesFeature=t.DidCreateFilesFeature=void 0;const n=i(9051),r=i(84069),o=i(7846),s=i(66276);function a(e,t){return void 0===e[t]&&(e[t]={}),e[t]}function c(e,t,i){e[t]=i}class u{constructor(e,t,i,n,r){this._client=e,this._event=t,this._registrationType=i,this._clientCapability=n,this._serverCapability=r,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){const t=a(a(e,"workspace"),"fileOperations");c(t,"dynamicRegistration",!0),c(t,this._clientCapability,!0)}initialize(e){const t=e.workspace?.fileOperations,i=void 0!==t?(n=t,r=this._serverCapability,n[r]):void 0;var n,r;if(void 0!==i?.filters)try{this.register({id:s.generateUuid(),registerOptions:{filters:i.filters}})}catch(e){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${e}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));const t=e.registerOptions.filters.map((e=>{const t=new r.Minimatch(e.pattern.glob,u.asMinimatchOptions(e.pattern.options));if(!t.makeRe())throw new Error(`Invalid pattern ${e.pattern.glob}!`);return{scheme:e.scheme,matcher:t,kind:e.pattern.matches}}));this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),0===this._filters.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return u.getFileType(e)}async filter(e,t){const i=await Promise.all(e.files.map((async e=>{const i=t(e),r=i.fsPath.replace(/\\/g,"/");for(const e of this._filters.values())for(const t of e)if(void 0===t.scheme||t.scheme===i.scheme)if(t.matcher.match(r)){if(void 0===t.kind)return!0;const e=await this.getFileType(i);if(void 0===e)return this._client.error(`Failed to determine file type for ${i.toString()}.`),!0;if(e===n.FileType.File&&t.kind===o.FileOperationPatternKind.file||e===n.FileType.Directory&&t.kind===o.FileOperationPatternKind.folder)return!0}else if(t.kind===o.FileOperationPatternKind.folder){if(await u.getFileType(i)===n.FileType.Directory&&t.matcher.match(`${r}/`))return!0}return!1}))),r=e.files.filter(((e,t)=>i[t]));return{...e,files:r}}static async getFileType(e){try{return(await n.workspace.fs.stat(e)).type}catch(e){return}}static asMinimatchOptions(e){const t={dot:!0};return!0===e?.ignoreCase&&(t.nocase=!0),t}}class l extends u{constructor(e,t,i,n,r,o,s){super(e,t,i,n,r),this._notificationType=i,this._accessUri=o,this._createParams=s}async send(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const e=async e=>this._client.sendNotification(this._notificationType,this._createParams(e));return this.doSend(t,e)}}}class d extends l{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){const t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);const i=await u.getFileType(e);return i&&this._fsPathFileTypes.set(t,i),i}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),0===this.filterSize()&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}t.DidCreateFilesFeature=class extends l{constructor(e){super(e,n.workspace.onDidCreateFiles,o.DidCreateFilesNotification.type,"didCreate","didCreate",(e=>e),e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){const i=this._client.middleware.workspace;return i?.didCreateFiles?i.didCreateFiles(e,t):t(e)}};t.DidRenameFilesFeature=class extends d{constructor(e){super(e,n.workspace.onDidRenameFiles,o.DidRenameFilesNotification.type,"didRename","didRename",(e=>e.oldUri),e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=n.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,(e=>e.oldUri)))}doSend(e,t){this.clearFileTypeCache();const i=this._client.middleware.workspace;return i?.didRenameFiles?i.didRenameFiles(e,t):t(e)}};t.DidDeleteFilesFeature=class extends d{constructor(e){super(e,n.workspace.onDidDeleteFiles,o.DidDeleteFilesNotification.type,"didDelete","didDelete",(e=>e),e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=n.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,(e=>e)))}doSend(e,t){this.clearFileTypeCache();const i=this._client.middleware.workspace;return i?.didDeleteFiles?i.didDeleteFiles(e,t):t(e)}};class h extends u{constructor(e,t,i,n,r,o,s){super(e,t,i,n,r),this._requestType=i,this._accessUri=o,this._createParams=s}async send(e){const t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const e=e=>this._client.sendRequest(this._requestType,this._createParams(e),e.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,e)}}}t.WillCreateFilesFeature=class extends h{constructor(e){super(e,n.workspace.onWillCreateFiles,o.WillCreateFilesRequest.type,"willCreate","willCreate",(e=>e),e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){const i=this._client.middleware.workspace;return i?.willCreateFiles?i.willCreateFiles(e,t):t(e)}};t.WillRenameFilesFeature=class extends h{constructor(e){super(e,n.workspace.onWillRenameFiles,o.WillRenameFilesRequest.type,"willRename","willRename",(e=>e.oldUri),e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){const i=this._client.middleware.workspace;return i?.willRenameFiles?i.willRenameFiles(e,t):t(e)}};t.WillDeleteFilesFeature=class extends h{constructor(e){super(e,n.workspace.onWillDeleteFiles,o.WillDeleteFilesRequest.type,"willDelete","willDelete",(e=>e),e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){const i=this._client.middleware.workspace;return i?.willDeleteFiles?i.willDeleteFiles(e,t):t(e)}}},95352:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSystemWatcherFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);t.FileSystemWatcherFeature=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return r.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,o.ensure)((0,o.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;const t=[];for(const i of e.registerOptions.watchers){const e=this._client.protocol2CodeConverter.asGlobPattern(i.globPattern);if(void 0===e)continue;let o=!0,s=!0,a=!0;void 0!==i.kind&&null!==i.kind&&(o=!!(i.kind&r.WatchKind.Create),s=!!(i.kind&r.WatchKind.Change),a=!!(i.kind&r.WatchKind.Delete));const c=n.workspace.createFileSystemWatcher(e,!o,!s,!a);this.hookListeners(c,o,s,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let i=[];for(let e of t)this.hookListeners(e,!0,!0,!0,i);this._watchers.set(e,i)}hookListeners(e,t,i,n,o){t&&e.onDidCreate((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Created})),null,o),i&&e.onDidChange((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Changed})),null,o),n&&e.onDidDelete((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Deleted})),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let e of t)e.dispose()}clear(){this._watchers.forEach((e=>{for(let t of e)t.dispose()})),this._watchers.clear()}}},56754:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[r.FoldingRangeKind.Comment,r.FoldingRangeKind.Imports,r.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,o.ensure)((0,o.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(r.FoldingRangeRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeFoldingRange.fire()}));let[i,n]=this.getRegistration(t,e.foldingRangeProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i=new n.EventEmitter,o={onDidChangeFoldingRanges:i.event,provideFoldingRanges:(e,t,i)=>{const n=this._client,o=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(r.FoldingRangeRequest.type,o,i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asFoldingRanges(e,i)),(e=>n.handleFailedRequest(r.FoldingRangeRequest.type,i,e,null)))},s=n.middleware;return s.provideFoldingRanges?s.provideFoldingRanges(e,t,i,o):o(e,0,i)}};return[n.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),o),{provider:o,onDidChangeFoldingRange:i}]}}t.FoldingRangeFeature=s},26265:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentOnTypeFormattingFeature=t.DocumentRangeFormattingFeature=t.DocumentFormattingFeature=void 0;const n=i(9051),r=i(7846),o=i(66276),s=i(69169);var a;!function(e){e.fromConfiguration=function(e){const t=n.workspace.getConfiguration("files",e);return{trimTrailingWhitespace:t.get("trimTrailingWhitespace"),trimFinalNewlines:t.get("trimFinalNewlines"),insertFinalNewline:t.get("insertFinalNewline")}}}(a||(a={}));class c extends s.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,s.ensure)((0,s.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentFormattingProvider);i&&this.register({id:o.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDocumentFormattingEdits:(e,t,i)=>{const n=this._client,o=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),options:n.code2ProtocolConverter.asFormattingOptions(t,a.fromConfiguration(e))};return n.sendRequest(r.DocumentFormattingRequest.type,o,i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asTextEdits(e,i)),(e=>n.handleFailedRequest(r.DocumentFormattingRequest.type,i,e,null)))},s=n.middleware;return s.provideDocumentFormattingEdits?s.provideDocumentFormattingEdits(e,t,i,o):o(e,t,i)}};return[n.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}}t.DocumentFormattingFeature=c;class u extends s.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){const t=(0,s.ensure)((0,s.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);i&&this.register({id:o.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideDocumentRangeFormattingEdits:(e,t,i,n)=>{const o=this._client,s=(e,t,i,n)=>{const s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),range:o.code2ProtocolConverter.asRange(t),options:o.code2ProtocolConverter.asFormattingOptions(i,a.fromConfiguration(e))};return o.sendRequest(r.DocumentRangeFormattingRequest.type,s,n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asTextEdits(e,n)),(e=>o.handleFailedRequest(r.DocumentRangeFormattingRequest.type,n,e,null)))},c=o.middleware;return c.provideDocumentRangeFormattingEdits?c.provideDocumentRangeFormattingEdits(e,t,i,n,s):s(e,t,i,n)}};return e.rangesSupport&&(i.provideDocumentRangesFormattingEdits=(e,t,i,n)=>{const o=this._client,s=(e,t,i,n)=>{const s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),ranges:o.code2ProtocolConverter.asRanges(t),options:o.code2ProtocolConverter.asFormattingOptions(i,a.fromConfiguration(e))};return o.sendRequest(r.DocumentRangesFormattingRequest.type,s,n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asTextEdits(e,n)),(e=>o.handleFailedRequest(r.DocumentRangesFormattingRequest.type,n,e,null)))},c=o.middleware;return c.provideDocumentRangesFormattingEdits?c.provideDocumentRangesFormattingEdits(e,t,i,n,s):s(e,t,i,n)}),[n.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}}t.DocumentRangeFormattingFeature=u;class l extends s.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,s.ensure)((0,s.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);i&&this.register({id:o.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideOnTypeFormattingEdits:(e,t,i,n,o)=>{const s=this._client,c=(e,t,i,n,o)=>{let c={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),position:s.code2ProtocolConverter.asPosition(t),ch:i,options:s.code2ProtocolConverter.asFormattingOptions(n,a.fromConfiguration(e))};return s.sendRequest(r.DocumentOnTypeFormattingRequest.type,c,o).then((e=>o.isCancellationRequested?null:s.protocol2CodeConverter.asTextEdits(e,o)),(e=>s.handleFailedRequest(r.DocumentOnTypeFormattingRequest.type,o,e,null)))},u=s.middleware;return u.provideOnTypeFormattingEdits?u.provideOnTypeFormattingEdits(e,t,i,n,o,c):c(e,t,i,n,o)}},o=e.moreTriggerCharacter||[];return[n.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i,e.firstTriggerCharacter,...o),i]}}t.DocumentOnTypeFormattingFeature=l},46050:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HoverFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.HoverRequest.type)}fillClientCapabilities(e){const t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[r.MarkupKind.Markdown,r.MarkupKind.PlainText]}initialize(e,t){const i=this.getRegistrationOptions(t,e.hoverProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideHover:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.HoverRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asHover(e)),(e=>n.handleFailedRequest(r.HoverRequest.type,i,e,null))),s=n.middleware;return s.provideHover?s.provideHover(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.HoverFeature=a},97391:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.implementationProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i={provideImplementation:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.ImplementationRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asDefinitionResult(e,i)),(e=>n.handleFailedRequest(r.ImplementationRequest.type,i,e,null))),s=n.middleware;return s.provideImplementation?s.provideImplementation(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.ImplementationFeature=s},71005:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintsFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.InlayHintRequest.type)}fillClientCapabilities(e){const t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,o.ensure)((0,o.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(r.InlayHintRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeInlayHints.fire()}));const[i,n]=this.getRegistration(t,e.inlayHintProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i=new n.EventEmitter,o={onDidChangeInlayHints:i.event,provideInlayHints:(e,t,i)=>{const n=this._client,o=async(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),range:n.code2ProtocolConverter.asRange(t)};try{const e=await n.sendRequest(r.InlayHintRequest.type,o,i);return i.isCancellationRequested?null:n.protocol2CodeConverter.asInlayHints(e,i)}catch(e){return n.handleFailedRequest(r.InlayHintRequest.type,i,e,null)}},s=n.middleware;return s.provideInlayHints?s.provideInlayHints(e,t,i,o):o(e,t,i)}};return o.resolveInlayHint=!0===e.resolveProvider?(e,t)=>{const i=this._client,n=async(e,t)=>{try{const n=await i.sendRequest(r.InlayHintResolveRequest.type,i.code2ProtocolConverter.asInlayHint(e),t);if(t.isCancellationRequested)return null;const o=i.protocol2CodeConverter.asInlayHint(n,t);return t.isCancellationRequested?null:o}catch(e){return i.handleFailedRequest(r.InlayHintResolveRequest.type,t,e,null)}},o=i.middleware;return o.resolveInlayHint?o.resolveInlayHint(e,t,n):n(e,t)}:void 0,[this.registerProvider(t,o),{provider:o,onDidChangeInlayHints:i}]}registerProvider(e,t){return n.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.InlayHintsFeature=s},10411:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionItemFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.InlineCompletionRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"inlineCompletion").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.inlineCompletionProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideInlineCompletionItems:(e,t,i,n)=>{const o=this._client,s=this._client.middleware,a=(e,t,i,n)=>o.sendRequest(r.InlineCompletionRequest.type,o.code2ProtocolConverter.asInlineCompletionParams(e,t,i),n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asInlineCompletionResult(e,n)),(e=>o.handleFailedRequest(r.InlineCompletionRequest.type,n,e,null)));return s.provideInlineCompletionItems?s.provideInlineCompletionItems(e,t,i,n,a):a(e,t,i,n)}};return[n.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}}t.InlineCompletionItemFeature=a},41425:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.InlineValueRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,o.ensure)((0,o.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(r.InlineValueRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeInlineValues.fire()}));const[i,n]=this.getRegistration(t,e.inlineValueProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i=new n.EventEmitter,o={onDidChangeInlineValues:i.event,provideInlineValues:(e,t,i,n)=>{const o=this._client,s=(e,t,i,n)=>{const s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),range:o.code2ProtocolConverter.asRange(t),context:o.code2ProtocolConverter.asInlineValueContext(i)};return o.sendRequest(r.InlineValueRequest.type,s,n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asInlineValues(e,n)),(e=>o.handleFailedRequest(r.InlineValueRequest.type,n,e,null)))},a=o.middleware;return a.provideInlineValues?a.provideInlineValues(e,t,i,n,s):s(e,t,i,n)}};return[this.registerProvider(t,o),{provider:o,onDidChangeInlineValues:i}]}registerProvider(e,t){return n.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.InlineValueFeature=s},33520:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"linkedEditingRange").dynamicRegistration=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.linkedEditingRangeProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i={provideLinkedEditingRanges:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.LinkedEditingRangeRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asLinkedEditingRanges(e,i)),(e=>n.handleFailedRequest(r.LinkedEditingRangeRequest.type,i,e,null))),s=n.middleware;return s.provideLinkedEditingRange?s.provideLinkedEditingRange(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.LinkedEditingFeature=s},49501:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookDocumentSyncFeature=void 0;const n=i(9051),r=i(84069),o=i(7846),s=i(66276),a=i(92735);function c(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var u,l,d,h,g;!function(e){let t;!function(t){function i(e,t){return e.map((e=>s(e,t)))}function r(e){return c(new Set,e)}function s(e,t){const i=o.NotebookCell.create(function(e){switch(e){case n.NotebookCellKind.Markup:return o.NotebookCellKind.Markup;case n.NotebookCellKind.Code:return o.NotebookCellKind.Code}}(e.kind),t.asUri(e.document.uri));return Object.keys(e.metadata).length>0&&(i.metadata=r(e.metadata)),void 0!==e.executionSummary&&a.number(e.executionSummary.executionOrder)&&a.boolean(e.executionSummary.success)&&(i.executionSummary={executionOrder:e.executionSummary.executionOrder,success:e.executionSummary.success}),i}function c(e,t){if(e.has(t))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(t)){const i=[];for(const n of t)if(null!==n&&"object"==typeof n||Array.isArray(n))i.push(c(e,n));else{if(n instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");i.push(n)}return i}{const i=Object.keys(t),n=Object.create(null);for(const r of i){const i=t[r];if(null!==i&&"object"==typeof i||Array.isArray(i))n[r]=c(e,i);else{if(i instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");n[r]=i}}return n}}t.asVersionedNotebookDocumentIdentifier=function(e,t){return{version:e.version,uri:t.asUri(e.uri)}},t.asNotebookDocument=function(e,t,n){const s=o.NotebookDocument.create(n.asUri(e.uri),e.notebookType,e.version,i(t,n));return Object.keys(e.metadata).length>0&&(s.metadata=r(e.metadata)),s},t.asNotebookCells=i,t.asMetadata=r,t.asNotebookCell=s,t.asTextContentChange=function(e,t){const i=t.asChangeTextDocumentParams(e,e.document.uri,e.document.version);return{document:i.textDocument,changes:i.contentChanges}},t.asNotebookDocumentChangeEvent=function(t,i){const n=Object.create(null);if(t.metadata&&(n.metadata=e.c2p.asMetadata(t.metadata)),void 0!==t.cells){const r=Object.create(null),o=t.cells;o.structure&&(r.structure={array:{start:o.structure.array.start,deleteCount:o.structure.array.deleteCount,cells:void 0!==o.structure.array.cells?o.structure.array.cells.map((t=>e.c2p.asNotebookCell(t,i))):void 0},didOpen:void 0!==o.structure.didOpen?o.structure.didOpen.map((e=>i.asOpenTextDocumentParams(e.document).textDocument)):void 0,didClose:void 0!==o.structure.didClose?o.structure.didClose.map((e=>i.asCloseTextDocumentParams(e.document).textDocument)):void 0}),void 0!==o.data&&(r.data=o.data.map((t=>e.c2p.asNotebookCell(t,i)))),void 0!==o.textContent&&(r.textContent=o.textContent.map((t=>e.c2p.asTextContentChange(t,i)))),Object.keys(r).length>0&&(n.cells=r)}return n}}(t=e.c2p||(e.c2p={}))}(u||(u={})),function(e){function t(e,t,n=!0){return!(e.kind!==t.kind||e.document.uri.toString()!==t.document.uri.toString()||e.document.languageId!==t.document.languageId||!function(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;return e.executionOrder===t.executionOrder&&e.success===t.success&&function(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;return e.startTime===t.startTime&&e.endTime===t.endTime}(e.timing,t.timing)}(e.executionSummary,t.executionSummary))&&(!n||n&&i(e.metadata,t.metadata))}function i(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;const r=Array.isArray(e),o=Array.isArray(t);if(r!==o)return!1;if(r&&o){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!i(e[n],t[n]))return!1}if(n(e)&&n(t)){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;if(n.sort(),r.sort(),!i(n,r))return!1;for(let r=0;r<n.length;r++){const o=n[r];if(!i(e[o],t[o]))return!1}return!0}return!1}function n(e){return null!==e&&"object"==typeof e}e.computeDiff=function(e,i,n){const r=e.length,o=i.length;let s=0;for(;s<o&&s<r&&t(e[s],i[s],n);)s++;if(s<o&&s<r){let a=r-1,c=o-1;for(;a>=0&&c>=0&&t(e[a],i[c],n);)a--,c--;const u=a+1-s,l=s===c+1?void 0:i.slice(s,c+1);return void 0!==l?{start:s,deleteCount:u,cells:l}:{start:s,deleteCount:u}}return s<o?{start:s,deleteCount:0,cells:i.slice(s)}:s<r?{start:s,deleteCount:r-s}:void 0},e.isObjectLiteral=n}(l||(l={})),function(e){e.matchNotebook=function(e,t){if("string"==typeof e)return"*"===e||t.notebookType===e;if(void 0!==e.notebookType&&"*"!==e.notebookType&&t.notebookType!==e.notebookType)return!1;const i=t.uri;if(void 0!==e.scheme&&"*"!==e.scheme&&i.scheme!==e.scheme)return!1;if(void 0!==e.pattern){const t=new r.Minimatch(e.pattern,{noext:!0});if(!t.makeRe())return!1;if(!t.match(i.fsPath))return!1}return!0}}(d||(d={})),function(e){function t(e,t,i,n){return void 0===t&&void 0===i?{notebook:e,language:n}:{notebook:{notebookType:e,scheme:t,pattern:i},language:n}}e.asDocumentSelector=function(e){const i=e.notebookSelector,n=[];for(const e of i){const i=("string"==typeof e.notebook?e.notebook:e.notebook?.notebookType)??"*",r="string"==typeof e.notebook?void 0:e.notebook?.scheme,o="string"==typeof e.notebook?void 0:e.notebook?.pattern;if(void 0!==e.cells)for(const s of e.cells)n.push(t(i,r,o,s.language));else n.push(t(i,r,o,void 0))}return n}}(h||(h={})),function(e){e.create=function(e){return{cells:e,uris:new Set(e.map((e=>e.document.uri.toString())))}}}(g||(g={}));class f{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(h.asDocumentSelector(t)),n.workspace.onDidOpenNotebookDocument((e=>{this.notebookDidOpen.add(e.uri.toString()),this.didOpen(e)}),void 0,this.disposables);for(const e of n.workspace.notebookDocuments)this.notebookDidOpen.add(e.uri.toString()),this.didOpen(e);n.workspace.onDidChangeNotebookDocument((e=>this.didChangeNotebookDocument(e)),void 0,this.disposables),!0===this.options.save&&n.workspace.onDidSaveNotebookDocument((e=>this.didSave(e)),void 0,this.disposables),n.workspace.onDidCloseNotebookDocument((e=>{this.didClose(e),this.notebookDidOpen.delete(e.uri.toString())}),void 0,this.disposables)}getState(){for(const e of n.workspace.notebookDocuments){if(void 0!==this.getMatchingCells(e))return{kind:"document",id:"$internal",registrations:!0,matches:!0}}return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return n.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(0===n.languages.match(this.selector,t.document))return;if(!this.notebookDidOpen.has(e.uri.toString()))return;const i=this.notebookSyncInfo.get(e.uri.toString()),r=this.cellMatches(e,t);if(void 0!==i){const n=i.uris.has(t.document.uri.toString());if(r&&n||!r&&!n)return;if(r){const t=this.getMatchingCells(e);if(void 0!==t){const n=this.asNotebookDocumentChangeEvent(e,void 0,i,t);void 0!==n&&this.doSendChange(n,t).catch((()=>{}))}}}else r&&this.doSendOpen(e,[t]).catch((()=>{}))}didChangeNotebookCellTextDocument(e,t){0!==n.languages.match(this.selector,t.document)&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch((()=>{}))}didCloseNotebookCellTextDocument(e,t){const i=this.notebookSyncInfo.get(e.uri.toString());if(void 0===i)return;const n=t.document.uri,r=i.cells.findIndex((e=>e.document.uri.toString()===n.toString()));if(-1!==r)if(0===r&&1===i.cells.length)this.doSendClose(e,i.cells).catch((()=>{}));else{const t=i.cells.slice(),n=t.splice(r,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:r,deleteCount:1},didClose:n}}},t).catch((()=>{}))}}dispose(){for(const e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),i=this.notebookSyncInfo.get(e.uri.toString())){if(void 0!==i)if(void 0!==t){const n=this.asNotebookDocumentChangeEvent(e,void 0,i,t);void 0!==n&&this.doSendChange(n,t).catch((()=>{}))}else this.doSendClose(e,[]).catch((()=>{}));else{if(void 0===t)return;this.doSendOpen(e,t).catch((()=>{}))}}didChangeNotebookDocument(e){const t=e.notebook,i=this.notebookSyncInfo.get(t.uri.toString());if(void 0===i){if(0===e.contentChanges.length)return;const n=this.getMatchingCells(t);if(void 0===n)return;this.didOpen(t,n,i)}else{const n=this.getMatchingCells(t);if(void 0===n)return void this.didClose(t,i);const r=this.asNotebookDocumentChangeEvent(e.notebook,e,i,n);void 0!==r&&this.doSendChange(r,n).catch((()=>{}))}}didSave(e){void 0!==this.notebookSyncInfo.get(e.uri.toString())&&this.doSendSave(e).catch((()=>{}))}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(void 0===t)return;const i=e.getCells().filter((e=>t.uris.has(e.document.uri.toString())));this.doSendClose(e,i).catch((()=>{}))}async sendDidOpenNotebookDocument(e){const t=this.getMatchingCells(e);if(void 0!==t)return this.doSendOpen(e,t)}async doSendOpen(e,t){const i=async(e,t)=>{const i=u.c2p.asNotebookDocument(e,t,this.client.code2ProtocolConverter),n=t.map((e=>this.client.code2ProtocolConverter.asTextDocumentItem(e.document)));try{await this.client.sendNotification(o.DidOpenNotebookDocumentNotification.type,{notebookDocument:i,cellTextDocuments:n})}catch(e){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",e),e}},n=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),g.create(t)),void 0!==n?.didOpen?n.didOpen(e,t,i):i(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){const i=async e=>{try{await this.client.sendNotification(o.DidChangeNotebookDocumentNotification.type,{notebookDocument:u.c2p.asVersionedNotebookDocumentIdentifier(e.notebook,this.client.code2ProtocolConverter),change:u.c2p.asNotebookDocumentChangeEvent(e,this.client.code2ProtocolConverter)})}catch(e){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",e),e}},n=this.client.middleware?.notebooks;return void 0!==e.cells?.structure&&this.notebookSyncInfo.set(e.notebook.uri.toString(),g.create(t??[])),void 0!==n?.didChange?n?.didChange(e,i):i(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){const t=async e=>{try{await this.client.sendNotification(o.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(e.uri)}})}catch(e){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",e),e}},i=this.client.middleware?.notebooks;return void 0!==i?.didSave?i.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){const i=async(e,t)=>{try{await this.client.sendNotification(o.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(e.uri)},cellTextDocuments:t.map((e=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)))})}catch(e){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",e),e}},n=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),void 0!==n?.didClose?n.didClose(e,t,i):i(e,t)}asNotebookDocumentChangeEvent(e,t,i,n){if(void 0!==t&&t.notebook!==e)throw new Error("Notebook must be identical");const r={notebook:e};let o;if(void 0!==t?.metadata&&(r.metadata=u.c2p.asMetadata(t.metadata)),void 0!==t?.cellChanges&&t.cellChanges.length>0){const e=[];o=new Set(n.map((e=>e.document.uri.toString())));for(const i of t.cellChanges)!o.has(i.cell.document.uri.toString())||void 0===i.executionSummary&&void 0===i.metadata||e.push(i.cell);e.length>0&&(r.cells=r.cells??{},r.cells.data=e)}if((void 0!==t?.contentChanges&&t.contentChanges.length>0||void 0===t)&&void 0!==i&&void 0!==n){const e=i.cells,t=n,o=l.computeDiff(e,t,!1);let s,a;if(void 0!==o){s=void 0===o.cells?new Map:new Map(o.cells.map((e=>[e.document.uri.toString(),e]))),a=0===o.deleteCount?new Map:new Map(e.slice(o.start,o.start+o.deleteCount).map((e=>[e.document.uri.toString(),e])));for(const e of Array.from(a.keys()))s.has(e)&&(a.delete(e),s.delete(e));r.cells=r.cells??{};const t=[],i=[];if(s.size>0||a.size>0){for(const e of s.values())t.push(e);for(const e of a.values())i.push(e)}r.cells.structure={array:o,didOpen:t,didClose:i}}}return Object.keys(r).length>1?r:void 0}getMatchingCells(e,t=e.getCells()){if(void 0!==this.options.notebookSelector)for(const i of this.options.notebookSelector)if(void 0===i.notebook||d.matchNotebook(i.notebook,e)){const n=this.filterCells(e,t,i.cells);return 0===n.length?void 0:n}}cellMatches(e,t){const i=this.getMatchingCells(e,[t]);return void 0!==i&&i[0]===t}filterCells(e,t,i){const n=void 0!==i?t.filter((e=>{const t=e.document.languageId;return i.some((e=>"*"===e.language||t===e.language))})):t;return"function"==typeof this.client.clientOptions.notebookDocumentOptions?.filterCells?this.client.clientOptions.notebookDocumentOptions.filterCells(e,n):n}}class p{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=o.NotebookDocumentSyncRegistrationType.type,n.workspace.onDidOpenTextDocument((e=>{if(e.uri.scheme!==p.CellScheme)return;const[t,i]=this.findNotebookDocumentAndCell(e);if(void 0!==t&&void 0!==i)for(const e of this.registrations.values())e instanceof f&&e.didOpenNotebookCellTextDocument(t,i)})),n.workspace.onDidChangeTextDocument((e=>{if(0===e.contentChanges.length)return;const t=e.document;if(t.uri.scheme!==p.CellScheme)return;const[i]=this.findNotebookDocumentAndCell(t);if(void 0!==i)for(const t of this.registrations.values())t instanceof f&&t.didChangeNotebookCellTextDocument(i,e)})),n.workspace.onDidCloseTextDocument((e=>{if(e.uri.scheme!==p.CellScheme)return;const[t,i]=this.findNotebookDocumentAndCell(e);if(void 0!==t&&void 0!==i)for(const e of this.registrations.values())e instanceof f&&e.didCloseNotebookCellTextDocument(t,i)}))}getState(){if(0===this.registrations.size)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const e of this.registrations.values()){const t=e.getState();if("document"===t.kind&&!0===t.registrations&&!0===t.matches)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){const t=c(c(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){const t=e.notebookDocumentSync;void 0!==t&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(h.asDocumentSelector(t)))}initialize(e){const t=e.notebookDocumentSync;if(void 0===t)return;const i=t.id??s.generateUuid();this.register({id:i,registerOptions:t})}register(e){const t=new f(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){const t=this.registrations.get(e);t&&t.dispose()}clear(){for(const e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==p.CellScheme)return!1;if(void 0!==this.dedicatedChannel&&n.languages.match(this.dedicatedChannel,e)>0)return!0;for(const t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(const t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){const t=e.uri.toString();for(const e of n.workspace.notebookDocuments)for(const i of e.getCells())if(i.document.uri.toString()===t)return[e,i];return[void 0,void 0]}}t.NotebookDocumentSyncFeature=p,p.CellScheme="vscode-notebook-cell"},39006:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressFeature=void 0;const n=i(7846),r=i(79198);t.ProgressFeature=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:n.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){var t,i;(t=e,i="window",void 0===t[i]&&(t[i]=Object.create(null)),t[i]).workDoneProgress=!0}initialize(){const e=this._client,t=e=>{this.activeParts.delete(e)};e.onRequest(n.WorkDoneProgressCreateRequest.type,(e=>{this.activeParts.add(new r.ProgressPart(this._client,e.token,t))}))}clear(){for(const e of this.activeParts)e.done();this.activeParts.clear()}}},79198:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressPart=void 0;const n=i(9051),r=i(7846),o=i(92735);t.ProgressPart=class{constructor(e,t,i){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(r.WorkDoneProgress.type,this._token,(e=>{switch(e.kind){case"begin":this.begin(e);break;case"report":this.report(e);break;case"end":this.done(),i&&i(this)}}))}begin(e){this._infinite=void 0===e.percentage,void 0!==this._lspProgressDisposable&&n.window.withProgress({location:n.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},(async(t,i)=>{if(void 0!==this._lspProgressDisposable)return this._progress=t,this._cancellationToken=i,this._tokenDisposable=this._cancellationToken.onCancellationRequested((()=>{this._client.sendNotification(r.WorkDoneProgressCancelNotification.type,{token:this._token})})),this.report(e),new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}))}report(e){if(this._infinite&&o.string(e.message))void 0!==this._progress&&this._progress.report({message:e.message});else if(o.number(e.percentage)){const t=Math.max(0,Math.min(e.percentage,100)),i=Math.max(0,t-this._reported);this._reported+=i,void 0!==this._progress&&this._progress.report({message:e.message,increment:i})}}cancel(){this.cleanup(),void 0!==this._reject&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),void 0!==this._resolve&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){void 0!==this._lspProgressDisposable&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),void 0!==this._tokenDisposable&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}}},99070:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.CallHierarchyItem{constructor(e,t,i,n,r,o,s){super(e,t,i,n,r,o),void 0!==s&&(this.data=s)}}t.default=r},12104:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.CodeAction{constructor(e,t){super(e),this.data=t}}t.default=r},53610:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.CodeLens{constructor(e){super(e)}}t.default=r},66284:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.CompletionItem{constructor(e){super(e)}}t.default=r},89504:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConverter=void 0;const n=i(9051),r=i(7846),o=i(92735),s=i(28419),a=i(66284),c=i(53610),u=i(7450),l=i(12104),d=i(79167),h=i(99070),g=i(21412),f=i(24613),p=i(25256),m=i(7846);var v;!function(e){e.is=function(e){let t=e;return t&&o.string(t.language)&&o.string(t.value)}}(v||(v={})),t.createConverter=function(e,t,i){const y=e||(e=>n.Uri.parse(e));function C(e){return y(e)}function w(e){let t=new d.ProtocolDiagnostic(_(e.range),e.message,k(e.severity),e.data);if(void 0!==e.code)if("string"==typeof e.code||"number"==typeof e.code)r.CodeDescription.is(e.codeDescription)?t.code={value:e.code,target:C(e.codeDescription.href)}:t.code=e.code;else if(d.DiagnosticCode.is(e.code)){t.hasDiagnosticCode=!0;const i=e.code;t.code={value:i.value,target:C(i.target)}}return e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=function(e){const t=new Array(e.length);for(let i=0;i<e.length;i++){const r=e[i];t[i]=new n.DiagnosticRelatedInformation(L(r.location),r.message)}return t}(e.relatedInformation)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=S(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),t}function S(e){switch(e){case r.DiagnosticTag.Unnecessary:return n.DiagnosticTag.Unnecessary;case r.DiagnosticTag.Deprecated:return n.DiagnosticTag.Deprecated;default:return}}function R(e){return e?new n.Position(e.line,e.character):void 0}function _(e){return e?new n.Range(e.start.line,e.start.character,e.end.line,e.end.character):void 0}async function b(e,t){return s.map(e,(e=>new n.Range(e.start.line,e.start.character,e.end.line,e.end.character)),t)}function k(e){if(null==e)return n.DiagnosticSeverity.Error;switch(e){case r.DiagnosticSeverity.Error:return n.DiagnosticSeverity.Error;case r.DiagnosticSeverity.Warning:return n.DiagnosticSeverity.Warning;case r.DiagnosticSeverity.Information:return n.DiagnosticSeverity.Information;case r.DiagnosticSeverity.Hint:return n.DiagnosticSeverity.Hint}return n.DiagnosticSeverity.Error}function D(e){if(o.string(e))return e;switch(e.kind){case r.MarkupKind.Markdown:return T(e.value);case r.MarkupKind.PlainText:return e.value;default:return`Unsupported Markup content received. Kind is: ${e.kind}`}}function T(e){let o;if(void 0===e||"string"==typeof e)o=new n.MarkdownString(e);else switch(e.kind){case r.MarkupKind.Markdown:o=new n.MarkdownString(e.value);break;case r.MarkupKind.PlainText:o=new n.MarkdownString,o.appendText(e.value);break;default:o=new n.MarkdownString,o.appendText(`Unsupported Markup content received. Kind is: ${e.kind}`)}return o.isTrusted=t,o.supportHtml=i,o}function E(e){if(e===r.CompletionItemTag.Deprecated)return n.CompletionItemTag.Deprecated}function P(e,t,i,s,c,u){const l=function(e){if(null==e)return[];const t=[];for(const i of e){const e=E(i);void 0!==e&&t.push(e)}return t}(e.tags),d=function(e){return r.CompletionItemLabelDetails.is(e.labelDetails)?{label:e.label,detail:e.labelDetails.detail,description:e.labelDetails.description}:e.label}(e),h=new a.default(d);e.detail&&(h.detail=e.detail),e.documentation&&(h.documentation=D(e.documentation),h.documentationFormat=o.string(e.documentation)?"$string":e.documentation.kind),e.filterText&&(h.filterText=e.filterText);const g=function(e,t,i){const o=e.insertTextFormat??i;if(void 0!==e.textEdit||void 0!==t){const[i,a]=void 0!==e.textEdit?(s=e.textEdit,r.InsertReplaceEdit.is(s)?[{inserting:_(s.insert),replacing:_(s.replace)},s.newText]:[_(s.range),s.newText]):[t,e.textEditText??e.label];return o===r.InsertTextFormat.Snippet?{text:new n.SnippetString(a),range:i,fromEdit:!0}:{text:a,range:i,fromEdit:!0}}return e.insertText?o===r.InsertTextFormat.Snippet?{text:new n.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1}:void 0;var s}(e,i,c);if(g&&(h.insertText=g.text,h.range=g.range,h.fromEdit=g.fromEdit),o.number(e.kind)){let[t,i]=(f=e.kind,r.CompletionItemKind.Text<=f&&f<=r.CompletionItemKind.TypeParameter?[f-1,void 0]:[n.CompletionItemKind.Text,f]);h.kind=t,i&&(h.originalItemKind=i)}var f;e.sortText&&(h.sortText=e.sortText),e.additionalTextEdits&&(h.additionalTextEdits=I(e.additionalTextEdits));const p=void 0!==e.commitCharacters?o.stringArray(e.commitCharacters)?e.commitCharacters:void 0:t;p&&(h.commitCharacters=p.slice()),e.command&&(h.command=J(e.command)),!0!==e.deprecated&&!1!==e.deprecated||(h.deprecated=e.deprecated,!0===e.deprecated&&l.push(n.CompletionItemTag.Deprecated)),!0!==e.preselect&&!1!==e.preselect||(h.preselect=e.preselect);const m=e.data??u;void 0!==m&&(h.data=m),l.length>0&&(h.tags=l);const v=e.insertTextMode??s;return void 0!==v&&(h.insertTextMode=v,v===r.InsertTextMode.asIs&&(h.keepWhitespace=!0)),h}function O(e){if(e)return new n.TextEdit(_(e.range),e.newText)}async function x(e,t){if(e)return s.map(e,O,t)}function I(e){if(!e)return;const t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=O(e[i]);return t}async function M(e,t){return s.mapAsync(e,F,t)}async function F(e,t){let i=new n.SignatureInformation(e.label);return void 0!==e.documentation&&(i.documentation=D(e.documentation)),void 0!==e.parameters&&(i.parameters=await N(e.parameters,t)),void 0!==e.activeParameter&&(i.activeParameter=e.activeParameter),i}function N(e,t){return s.map(e,A,t)}function A(e){let t=new n.ParameterInformation(e.label);return e.documentation&&(t.documentation=D(e.documentation)),t}function L(e){return e?new n.Location(y(e.uri),_(e.range)):void 0}function q(e){if(!e)return;let t={targetUri:y(e.targetUri),targetRange:_(e.targetRange),originSelectionRange:_(e.originSelectionRange),targetSelectionRange:_(e.targetSelectionRange)};if(!t.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return t}async function W(e,t){if(e){if(o.array(e)){if(0===e.length)return[];if(r.LocationLink.is(e[0])){const i=e;return s.map(i,q,t)}{const i=e;return s.map(i,L,t)}}return r.LocationLink.is(e)?[q(e)]:L(e)}}function j(e){let t=new n.DocumentHighlight(_(e.range));return o.number(e.kind)&&(t.kind=U(e.kind)),t}function U(e){switch(e){case r.DocumentHighlightKind.Text:return n.DocumentHighlightKind.Text;case r.DocumentHighlightKind.Read:return n.DocumentHighlightKind.Read;case r.DocumentHighlightKind.Write:return n.DocumentHighlightKind.Write}return n.DocumentHighlightKind.Text}function K(e){return e<=r.SymbolKind.TypeParameter?e-1:n.SymbolKind.Property}function $(e){if(e===r.SymbolTag.Deprecated)return n.SymbolTag.Deprecated}function H(e){if(null==e)return;const t=[];for(const i of e){const e=$(i);void 0!==e&&t.push(e)}return 0===t.length?void 0:t}function z(e){const t=e.data,i=e.location,r=void 0===i.range||void 0!==t?new f.default(e.name,K(e.kind),e.containerName??"",void 0===i.range?y(i.uri):new n.Location(y(e.location.uri),_(i.range)),t):new n.SymbolInformation(e.name,K(e.kind),e.containerName??"",new n.Location(y(e.location.uri),_(i.range)));return B(r,e),r}function V(e){let t=new n.DocumentSymbol(e.name,e.detail||"",K(e.kind),_(e.range),_(e.selectionRange));if(B(t,e),void 0!==e.children&&e.children.length>0){let i=[];for(let t of e.children)i.push(V(t));t.children=i}return t}function B(e,t){e.tags=H(t.tags),t.deprecated&&(e.tags?e.tags.includes(n.SymbolTag.Deprecated)||(e.tags=e.tags.concat(n.SymbolTag.Deprecated)):e.tags=[n.SymbolTag.Deprecated])}function J(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}const G=new Map;function Y(e){if(null==e)return;let t=G.get(e);if(t)return t;let i=e.split(".");t=n.CodeActionKind.Empty;for(let e of i)t=t.append(e);return t}async function X(e,t){if(null==e)return;let i=new l.default(e.title,e.data);return void 0!==e.kind&&(i.kind=Y(e.kind)),void 0!==e.diagnostics&&(i.diagnostics=function(e){const t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=w(e[i]);return t}(e.diagnostics)),void 0!==e.edit&&(i.edit=await Z(e.edit,t)),void 0!==e.command&&(i.command=J(e.command)),void 0!==e.isPreferred&&(i.isPreferred=e.isPreferred),void 0!==e.disabled&&(i.disabled={reason:e.disabled.reason}),i}function Q(e){if(!e)return;let t=new c.default(_(e.range));return e.command&&(t.command=J(e.command)),void 0!==e.data&&null!==e.data&&(t.data=e.data),t}async function Z(e,t){if(!e)return;const i=new Map;if(void 0!==e.changeAnnotations){const n=e.changeAnnotations;await s.forEach(Object.keys(n),(e=>{const t=function(e){if(void 0===e)return;return{label:e.label,needsConfirmation:!!e.needsConfirmation,description:e.description}}(n[e]);i.set(e,t)}),t)}const o=e=>void 0===e?void 0:i.get(e),a=new n.WorkspaceEdit;if(e.documentChanges){const i=e.documentChanges;await s.forEach(i,(e=>{if(r.CreateFile.is(e))a.createFile(y(e.uri),e.options,o(e.annotationId));else if(r.RenameFile.is(e))a.renameFile(y(e.oldUri),y(e.newUri),e.options,o(e.annotationId));else if(r.DeleteFile.is(e))a.deleteFile(y(e.uri),e.options,o(e.annotationId));else{if(!r.TextDocumentEdit.is(e))throw new Error(`Unknown workspace edit change received:\n${JSON.stringify(e,void 0,4)}`);{const t=y(e.textDocument.uri);for(const i of e.edits)r.AnnotatedTextEdit.is(i)?a.replace(t,_(i.range),i.newText,o(i.annotationId)):a.replace(t,_(i.range),i.newText)}}}),t)}else if(e.changes){const i=e.changes;await s.forEach(Object.keys(i),(e=>{a.set(y(e),I(i[e]))}),t)}return a}function ee(e){let t=_(e.range),i=e.target?C(e.target):void 0,n=new u.default(t,i);return void 0!==e.tooltip&&(n.tooltip=e.tooltip),void 0!==e.data&&null!==e.data&&(n.data=e.data),n}function te(e){return new n.Color(e.red,e.green,e.blue,e.alpha)}function ie(e){return new n.ColorInformation(_(e.range),te(e.color))}function ne(e){let t=new n.ColorPresentation(e.label);return t.additionalTextEdits=I(e.additionalTextEdits),e.textEdit&&(t.textEdit=O(e.textEdit)),t}function re(e){if(e)switch(e){case r.FoldingRangeKind.Comment:return n.FoldingRangeKind.Comment;case r.FoldingRangeKind.Imports:return n.FoldingRangeKind.Imports;case r.FoldingRangeKind.Region:return n.FoldingRangeKind.Region}}function oe(e){return new n.FoldingRange(e.startLine,e.endLine,re(e.kind))}function se(e){return new n.SelectionRange(_(e.range),e.parent?se(e.parent):void 0)}function ae(e){return r.InlineValueText.is(e)?new n.InlineValueText(_(e.range),e.text):r.InlineValueVariableLookup.is(e)?new n.InlineValueVariableLookup(_(e.range),e.variableName,e.caseSensitiveLookup):new n.InlineValueEvaluatableExpression(_(e.range),e.expression)}async function ce(e,t){const i="string"==typeof e.label?e.label:await s.map(e.label,ue,t),n=new p.default(R(e.position),i);return void 0!==e.kind&&(n.kind=e.kind),void 0!==e.textEdits&&(n.textEdits=await x(e.textEdits,t)),void 0!==e.tooltip&&(n.tooltip=le(e.tooltip)),void 0!==e.paddingLeft&&(n.paddingLeft=e.paddingLeft),void 0!==e.paddingRight&&(n.paddingRight=e.paddingRight),void 0!==e.data&&(n.data=e.data),n}function ue(e){const t=new n.InlayHintLabelPart(e.value);return void 0!==e.location&&(t.location=L(e.location)),void 0!==e.tooltip&&(t.tooltip=le(e.tooltip)),void 0!==e.command&&(t.command=J(e.command)),t}function le(e){return"string"==typeof e?e:T(e)}function de(e){if(null===e)return;const t=new h.default(K(e.kind),e.name,e.detail||"",C(e.uri),_(e.range),_(e.selectionRange),e.data);return void 0!==e.tags&&(t.tags=H(e.tags)),t}async function he(e,t){return new n.CallHierarchyIncomingCall(de(e.from),await b(e.fromRanges,t))}async function ge(e,t){return new n.CallHierarchyOutgoingCall(de(e.to),await b(e.fromRanges,t))}function fe(e){return new n.SemanticTokensEdit(e.start,e.deleteCount,void 0!==e.data?new Uint32Array(e.data):void 0)}function pe(e){if(null===e)return;let t=new g.default(K(e.kind),e.name,e.detail||"",C(e.uri),_(e.range),_(e.selectionRange),e.data);return void 0!==e.tags&&(t.tags=H(e.tags)),t}function me(e){let t,i;t="string"==typeof e.insertText?e.insertText:new n.SnippetString(e.insertText.value),e.command&&(i=J(e.command));const r=new n.InlineCompletionItem(t,_(e.range),i);return e.filterText&&(r.filterText=e.filterText),r}return G.set(r.CodeActionKind.Empty,n.CodeActionKind.Empty),G.set(r.CodeActionKind.QuickFix,n.CodeActionKind.QuickFix),G.set(r.CodeActionKind.Refactor,n.CodeActionKind.Refactor),G.set(r.CodeActionKind.RefactorExtract,n.CodeActionKind.RefactorExtract),G.set(r.CodeActionKind.RefactorInline,n.CodeActionKind.RefactorInline),G.set(r.CodeActionKind.RefactorRewrite,n.CodeActionKind.RefactorRewrite),G.set(r.CodeActionKind.Source,n.CodeActionKind.Source),G.set(r.CodeActionKind.SourceOrganizeImports,n.CodeActionKind.SourceOrganizeImports),{asUri:C,asDocumentSelector:function(e){const t=[];for(const i of e)if("string"==typeof i)t.push(i);else if(m.NotebookCellTextDocumentFilter.is(i))if("string"==typeof i.notebook)t.push({notebookType:i.notebook,language:i.language});else{const e=i.notebook.notebookType??"*";t.push({notebookType:e,scheme:i.notebook.scheme,pattern:i.notebook.pattern,language:i.language})}else m.TextDocumentFilter.is(i)&&t.push({language:i.language,scheme:i.scheme,pattern:i.pattern});return t},asDiagnostics:async function(e,t){return s.map(e,w,t)},asDiagnostic:w,asRange:_,asRanges:b,asPosition:R,asDiagnosticSeverity:k,asDiagnosticTag:S,asHover:function(e){if(e)return new n.Hover(function(e){if(o.string(e))return T(e);if(v.is(e))return T().appendCodeblock(e.value,e.language);if(Array.isArray(e)){let t=[];for(let i of e){let e=T();v.is(i)?e.appendCodeblock(i.value,i.language):e.appendMarkdown(i),t.push(e)}return t}return T(e)}(e.contents),_(e.range))},asCompletionResult:async function(e,t,i){if(!e)return;if(Array.isArray(e))return s.map(e,(e=>P(e,t)),i);const o=e,{defaultRange:a,commitCharacters:c}=function(e,t){const i=e.itemDefaults?.editRange,n=e.itemDefaults?.commitCharacters??t;return r.Range.is(i)?{defaultRange:_(i),commitCharacters:n}:void 0!==i?{defaultRange:{inserting:_(i.insert),replacing:_(i.replace)},commitCharacters:n}:{defaultRange:void 0,commitCharacters:n}}(o,t),u=await s.map(o.items,(e=>P(e,c,a,o.itemDefaults?.insertTextMode,o.itemDefaults?.insertTextFormat,o.itemDefaults?.data)),i);return new n.CompletionList(u,o.isIncomplete)},asCompletionItem:P,asTextEdit:O,asTextEdits:x,asSignatureHelp:async function(e,t){if(!e)return;let i=new n.SignatureHelp;return o.number(e.activeSignature)?i.activeSignature=e.activeSignature:i.activeSignature=0,o.number(e.activeParameter)?i.activeParameter=e.activeParameter:i.activeParameter=0,e.signatures&&(i.signatures=await M(e.signatures,t)),i},asSignatureInformations:M,asSignatureInformation:F,asParameterInformations:N,asParameterInformation:A,asDeclarationResult:async function(e,t){if(e)return W(e,t)},asDefinitionResult:async function(e,t){if(e)return W(e,t)},asLocation:L,asReferences:async function(e,t){if(e)return s.map(e,L,t)},asDocumentHighlights:async function(e,t){if(e)return s.map(e,j,t)},asDocumentHighlight:j,asDocumentHighlightKind:U,asSymbolKind:K,asSymbolTag:$,asSymbolTags:H,asSymbolInformations:async function(e,t){if(e)return s.map(e,z,t)},asSymbolInformation:z,asDocumentSymbols:async function(e,t){if(null!=e)return s.map(e,V,t)},asDocumentSymbol:V,asCommand:J,asCommands:async function(e,t){if(e)return s.map(e,J,t)},asCodeAction:X,asCodeActionKind:Y,asCodeActionKinds:function(e){if(null!=e)return e.map((e=>Y(e)))},asCodeActionResult:function(e,t){return s.mapAsync(e,(async e=>r.Command.is(e)?J(e):X(e,t)),t)},asCodeLens:Q,asCodeLenses:async function(e,t){if(e)return s.map(e,Q,t)},asWorkspaceEdit:Z,asDocumentLink:ee,asDocumentLinks:async function(e,t){if(e)return s.map(e,ee,t)},asFoldingRangeKind:re,asFoldingRange:oe,asFoldingRanges:async function(e,t){if(e)return s.map(e,oe,t)},asColor:te,asColorInformation:ie,asColorInformations:async function(e,t){if(e)return s.map(e,ie,t)},asColorPresentation:ne,asColorPresentations:async function(e,t){if(e)return s.map(e,ne,t)},asSelectionRange:se,asSelectionRanges:async function(e,t){return Array.isArray(e)?s.map(e,se,t):[]},asInlineValue:ae,asInlineValues:async function(e,t){return Array.isArray(e)?s.map(e,ae,t):[]},asInlayHint:ce,asInlayHints:async function(e,t){if(Array.isArray(e))return s.mapAsync(e,ce,t)},asSemanticTokensLegend:function(e){return e},asSemanticTokens:async function(e,t){if(null!=e)return new n.SemanticTokens(new Uint32Array(e.data),e.resultId)},asSemanticTokensEdit:fe,asSemanticTokensEdits:async function(e,t){if(null!=e)return new n.SemanticTokensEdits(e.edits.map(fe),e.resultId)},asCallHierarchyItem:de,asCallHierarchyItems:async function(e,t){if(null!==e)return s.map(e,de,t)},asCallHierarchyIncomingCall:he,asCallHierarchyIncomingCalls:async function(e,t){if(null!==e)return s.mapAsync(e,he,t)},asCallHierarchyOutgoingCall:ge,asCallHierarchyOutgoingCalls:async function(e,t){if(null!==e)return s.mapAsync(e,ge,t)},asLinkedEditingRanges:async function(e,t){if(null!=e)return new n.LinkedEditingRanges(await b(e.ranges,t),function(e){if(null==e)return;return new RegExp(e)}(e.wordPattern))},asTypeHierarchyItem:pe,asTypeHierarchyItems:async function(e,t){if(null!==e)return s.map(e,pe,t)},asGlobPattern:function(e){if(o.string(e))return e;if(r.RelativePattern.is(e)){if(r.URI.is(e.baseUri))return new n.RelativePattern(C(e.baseUri),e.pattern);if(r.WorkspaceFolder.is(e.baseUri)){const t=n.workspace.getWorkspaceFolder(C(e.baseUri.uri));return void 0!==t?new n.RelativePattern(t,e.pattern):void 0}}},asInlineCompletionResult:async function(e,t){if(!e)return;if(Array.isArray(e))return s.map(e,(e=>me(e)),t);const i=e,r=await s.map(i.items,(e=>me(e)),t);return new n.InlineCompletionList(r)},asInlineCompletionItem:me}}},79167:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolDiagnostic=t.DiagnosticCode=void 0;const n=i(9051),r=i(92735);var o;!function(e){e.is=function(e){const t=e;return null!=t&&(r.number(t.value)||r.string(t.value))&&r.string(t.target)}}(o||(t.DiagnosticCode=o={}));class s extends n.Diagnostic{constructor(e,t,i,n){super(e,t,i),this.data=n,this.hasDiagnosticCode=!1}}t.ProtocolDiagnostic=s},7450:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.DocumentLink{constructor(e,t){super(e,t)}}t.default=r},25256:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.InlayHint{constructor(e,t,i){super(e,t,i)}}t.default=r},21412:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.TypeHierarchyItem{constructor(e,t,i,n,r,o,s){super(e,t,i,n,r,o),void 0!==s&&(this.data=s)}}t.default=r},24613:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(9051);class r extends n.SymbolInformation{constructor(e,t,i,r,o){const s=!(r instanceof n.Uri);super(e,t,i,s?r:new n.Location(r,new n.Range(0,0,0,0))),this.hasRange=s,void 0!==o&&(this.data=o)}}t.default=r},56880:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReferencesFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.ReferencesRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.referencesProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,i={provideReferences:(e,t,i,n)=>{const o=this._client,s=(e,t,i,n)=>o.sendRequest(r.ReferencesRequest.type,o.code2ProtocolConverter.asReferenceParams(e,t,i),n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asReferences(e,n)),(e=>o.handleFailedRequest(r.ReferencesRequest.type,n,e,null))),a=o.middleware;return a.provideReferences?a.provideReferences(e,t,i,n,s):s(e,t,i,n)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.ReferencesFeature=a},49699:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenameFeature=void 0;const n=i(9051),r=i(7846),o=i(66276),s=i(92735),a=i(69169);class c extends a.TextDocumentLanguageFeature{constructor(e){super(e,r.RenameRequest.type)}fillClientCapabilities(e){let t=(0,a.ensure)((0,a.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=r.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.renameProvider);i&&(s.boolean(e.renameProvider)&&(i.prepareProvider=!1),this.register({id:o.generateUuid(),registerOptions:i}))}registerLanguageProvider(e){const t=e.documentSelector,i={provideRenameEdits:(e,t,i,n)=>{const o=this._client,s=(e,t,i,n)=>{let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),position:o.code2ProtocolConverter.asPosition(t),newName:i};return o.sendRequest(r.RenameRequest.type,s,n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asWorkspaceEdit(e,n)),(e=>o.handleFailedRequest(r.RenameRequest.type,n,e,null,!1)))},a=o.middleware;return a.provideRenameEdits?a.provideRenameEdits(e,t,i,n,s):s(e,t,i,n)},prepareRename:e.prepareProvider?(e,t,i)=>{const n=this._client,o=(e,t,i)=>{let o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),position:n.code2ProtocolConverter.asPosition(t)};return n.sendRequest(r.PrepareRenameRequest.type,o,i).then((e=>i.isCancellationRequested?null:r.Range.is(e)?n.protocol2CodeConverter.asRange(e):this.isDefaultBehavior(e)?!0===e.defaultBehavior?null:Promise.reject(new Error("The element can't be renamed.")):e&&r.Range.is(e.range)?{range:n.protocol2CodeConverter.asRange(e.range),placeholder:e.placeholder}:Promise.reject(new Error("The element can't be renamed."))),(e=>{throw"string"==typeof e.message?new Error(e.message):new Error("The element can't be renamed.")}))},s=n.middleware;return s.prepareRename?s.prepareRename(e,t,i,o):o(e,t,i)}:void 0};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){const t=e;return t&&s.boolean(t.defaultBehavior)}}t.RenameFeature=c},29781:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.SelectionRangeRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"selectionRange").dynamicRegistration=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.selectionRangeProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i={provideSelectionRanges:(e,t,i)=>{const n=this._client,o=async(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),positions:n.code2ProtocolConverter.asPositionsSync(t,i)};return n.sendRequest(r.SelectionRangeRequest.type,o,i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asSelectionRanges(e,i)),(e=>n.handleFailedRequest(r.SelectionRangeRequest.type,i,e,null)))},s=n.middleware;return s.provideSelectionRanges?s.provideSelectionRanges(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.SelectionRangeFeature=s},3262:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(92735);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){const t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[r.SemanticTokenTypes.namespace,r.SemanticTokenTypes.type,r.SemanticTokenTypes.class,r.SemanticTokenTypes.enum,r.SemanticTokenTypes.interface,r.SemanticTokenTypes.struct,r.SemanticTokenTypes.typeParameter,r.SemanticTokenTypes.parameter,r.SemanticTokenTypes.variable,r.SemanticTokenTypes.property,r.SemanticTokenTypes.enumMember,r.SemanticTokenTypes.event,r.SemanticTokenTypes.function,r.SemanticTokenTypes.method,r.SemanticTokenTypes.macro,r.SemanticTokenTypes.keyword,r.SemanticTokenTypes.modifier,r.SemanticTokenTypes.comment,r.SemanticTokenTypes.string,r.SemanticTokenTypes.number,r.SemanticTokenTypes.regexp,r.SemanticTokenTypes.operator,r.SemanticTokenTypes.decorator],t.tokenModifiers=[r.SemanticTokenModifiers.declaration,r.SemanticTokenModifiers.definition,r.SemanticTokenModifiers.readonly,r.SemanticTokenModifiers.static,r.SemanticTokenModifiers.deprecated,r.SemanticTokenModifiers.abstract,r.SemanticTokenModifiers.async,r.SemanticTokenModifiers.modification,r.SemanticTokenModifiers.documentation,r.SemanticTokenModifiers.defaultLibrary],t.formats=[r.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,o.ensure)((0,o.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(r.SemanticTokensRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeSemanticTokensEmitter.fire()}));const[i,n]=this.getRegistration(t,e.semanticTokensProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i=s.boolean(e.full)?e.full:void 0!==e.full,o=void 0!==e.full&&"boolean"!=typeof e.full&&!0===e.full.delta,a=new n.EventEmitter,c=i?{onDidChangeSemanticTokens:a.event,provideDocumentSemanticTokens:(e,t)=>{const i=this._client,n=i.middleware,o=(e,t)=>{const n={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(r.SemanticTokensRequest.type,n,t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asSemanticTokens(e,t)),(e=>i.handleFailedRequest(r.SemanticTokensRequest.type,t,e,null)))};return n.provideDocumentSemanticTokens?n.provideDocumentSemanticTokens(e,t,o):o(e,t)},provideDocumentSemanticTokensEdits:o?(e,t,i)=>{const n=this._client,o=n.middleware,s=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),previousResultId:t};return n.sendRequest(r.SemanticTokensDeltaRequest.type,o,i).then((async e=>i.isCancellationRequested?null:r.SemanticTokens.is(e)?await n.protocol2CodeConverter.asSemanticTokens(e,i):await n.protocol2CodeConverter.asSemanticTokensEdits(e,i)),(e=>n.handleFailedRequest(r.SemanticTokensDeltaRequest.type,i,e,null)))};return o.provideDocumentSemanticTokensEdits?o.provideDocumentSemanticTokensEdits(e,t,i,s):s(e,t,i)}:void 0}:void 0,u=!0===e.range?{provideDocumentRangeSemanticTokens:(e,t,i)=>{const n=this._client,o=n.middleware,s=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),range:n.code2ProtocolConverter.asRange(t)};return n.sendRequest(r.SemanticTokensRangeRequest.type,o,i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asSemanticTokens(e,i)),(e=>n.handleFailedRequest(r.SemanticTokensRangeRequest.type,i,e,null)))};return o.provideDocumentRangeSemanticTokens?o.provideDocumentRangeSemanticTokens(e,t,i,s):s(e,t,i)}}:void 0,l=[],d=this._client,h=d.protocol2CodeConverter.asSemanticTokensLegend(e.legend),g=d.protocol2CodeConverter.asDocumentSelector(t);return void 0!==c&&l.push(n.languages.registerDocumentSemanticTokensProvider(g,c,h)),void 0!==u&&l.push(n.languages.registerDocumentRangeSemanticTokensProvider(g,u,h)),[new n.Disposable((()=>l.forEach((e=>e.dispose())))),{range:u,full:c,onDidChangeSemanticTokensEmitter:a}]}}t.SemanticTokensFeature=a},31609:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignatureHelpFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[r.MarkupKind.Markdown,r.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.signatureHelpProvider);i&&this.register({id:s.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideSignatureHelp:(e,t,i,n)=>{const o=this._client,s=(e,t,i,n)=>o.sendRequest(r.SignatureHelpRequest.type,o.code2ProtocolConverter.asSignatureHelpParams(e,t,i),n).then((e=>n.isCancellationRequested?null:o.protocol2CodeConverter.asSignatureHelp(e,n)),(e=>o.handleFailedRequest(r.SignatureHelpRequest.type,n,e,null))),a=o.middleware;return a.provideSignatureHelp?a.provideSignatureHelp(e,t,n,i,s):s(e,t,n,i)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){const i=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(void 0===e.retriggerCharacters){const r=e.triggerCharacters||[];return n.languages.registerSignatureHelpProvider(i,t,...r)}{const r={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return n.languages.registerSignatureHelpProvider(i,t,r)}}}t.SignatureHelpFeature=a},94212:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidSaveTextDocumentFeature=t.WillSaveWaitUntilFeature=t.WillSaveFeature=t.DidChangeTextDocumentFeature=t.DidCloseTextDocumentFeature=t.DidOpenTextDocumentFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(66276);class a extends o.TextDocumentEventFeature{constructor(e,t){super(e,n.workspace.onDidOpenTextDocument,r.DidOpenTextDocumentNotification.type,(()=>e.middleware.didOpen),(t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t)),(e=>e),o.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){const i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register({id:s.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return r.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;const t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);n.workspace.textDocuments.forEach((e=>{const i=e.uri.toString();if(!this._syncedDocuments.has(i)&&n.languages.match(t,e)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e)){const t=this._client.middleware,n=e=>this._client.sendNotification(this._type,this._createParams(e));(t.didOpen?t.didOpen(e,n):n(e)).catch((e=>{this._client.error(`Sending document notification ${this._type.method} failed`,e)})),this._syncedDocuments.set(i,e)}}))}getTextDocument(e){return e}notificationSent(e,t,i){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,i)}}t.DidOpenTextDocumentFeature=a;class c extends o.TextDocumentEventFeature{constructor(e,t,i){super(e,n.workspace.onDidCloseTextDocument,r.DidCloseTextDocumentNotification.type,(()=>e.middleware.didClose),(t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t)),(e=>e),o.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=i}get registrationType(){return r.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register({id:s.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,i){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,i)}unregister(e){const t=this._selectors.get(e);super.unregister(e);const i=this._selectors.values();this._syncedDocuments.forEach((e=>{if(n.languages.match(t,e)>0&&!this._selectorFilter(i,e)&&!this._client.hasDedicatedTextSynchronizationFeature(e)){let t=this._client.middleware,i=e=>this._client.sendNotification(this._type,this._createParams(e));this._syncedDocuments.delete(e.uri.toString()),(t.didClose?t.didClose(e,i):i(e)).catch((e=>{this._client.error(`Sending document notification ${this._type.method} failed`,e)}))}}))}}t.DidCloseTextDocumentFeature=c;class u extends o.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new n.EventEmitter,this._onPendingChangeAdded=new n.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=r.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return r.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&void 0!==i.change&&i.change!==r.TextDocumentSyncKind.None&&this.register({id:s.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:i.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=n.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(const e of this._changeData.values())yield e.documentSelector}async callback(e){if(0===e.contentChanges.length)return;const t=e.document.uri,i=e.document.version,o=[];for(const s of this._changeData.values())if(n.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){const n=this._client.middleware;if(s.syncKind===r.TextDocumentSyncKind.Incremental){const s=async e=>{const n=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e,t,i);await this._client.sendNotification(r.DidChangeTextDocumentNotification.type,n),this.notificationSent(e.document,r.DidChangeTextDocumentNotification.type,n)};o.push(n.didChange?n.didChange(e,(e=>s(e))):s(e))}else if(s.syncKind===r.TextDocumentSyncKind.Full){const t=async e=>{const t=e.document.uri.toString();this._pendingTextDocumentChanges.set(t,e.document),this._onPendingChangeAdded.fire()};o.push(n.didChange?n.didChange(e,(e=>t(e))):t(e))}}return Promise.all(o).then(void 0,(e=>{throw this._client.error(`Sending document notification ${r.DidChangeTextDocumentNotification.type.method} failed`,e),e}))}notificationSent(e,t,i){this._onNotificationSent.fire({textDocument:e,type:t,params:i})}unregister(e){if(this._changeData.delete(e),0===this._changeData.size)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=r.TextDocumentSyncKind.None;else{this._syncKind=r.TextDocumentSyncKind.None;for(const e of this._changeData.values())if(this.updateSyncKind(e.syncKind),this._syncKind===r.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=r.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(0===this._pendingTextDocumentChanges.size)return[];let t;if(0===e.size)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(const i of this._pendingTextDocumentChanges)e.has(i[0])||(t.push(i[1]),this._pendingTextDocumentChanges.delete(i[0]))}return t}getProvider(e){for(const t of this._changeData.values())if(n.languages.match(t.documentSelector,e)>0)return{send:e=>this.callback(e)}}updateSyncKind(e){if(this._syncKind!==r.TextDocumentSyncKind.Full)switch(e){case r.TextDocumentSyncKind.Full:this._syncKind=e;break;case r.TextDocumentSyncKind.Incremental:this._syncKind===r.TextDocumentSyncKind.None&&(this._syncKind=r.TextDocumentSyncKind.Incremental)}}}t.DidChangeTextDocumentFeature=u;class l extends o.TextDocumentEventFeature{constructor(e){super(e,n.workspace.onWillSaveTextDocument,r.WillSaveTextDocumentNotification.type,(()=>e.middleware.willSave),(t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t)),(e=>e.document),((e,t)=>o.TextDocumentEventFeature.textDocumentFilter(e,t.document)))}get registrationType(){return r.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"synchronization").willSave=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSave&&this.register({id:s.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}}t.WillSaveFeature=l;class d extends o.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return r.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"synchronization").willSaveWaitUntil=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSaveWaitUntil&&this.register({id:s.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=n.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(o.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,i=e=>this._client.sendRequest(r.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then((async e=>{let t=await this._client.protocol2CodeConverter.asTextEdits(e);return void 0===t?[]:t}));e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,i):i(e))}}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}t.WillSaveWaitUntilFeature=d;class h extends o.TextDocumentEventFeature{constructor(e){super(e,n.workspace.onDidSaveTextDocument,r.DidSaveTextDocumentNotification.type,(()=>e.middleware.didSave),(t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText)),(e=>e),o.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return r.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){const i=e.resolvedTextDocumentSync;if(t&&i&&i.save){const e="boolean"==typeof i.save?{includeText:!1}:{includeText:!!i.save.includeText};this.register({id:s.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}}t.DidSaveTextDocumentFeature=h},67108:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,o.ensure)((0,o.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.typeDefinitionProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=e.documentSelector,i={provideTypeDefinition:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(r.TypeDefinitionRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asDefinitionResult(e,i)),(e=>n.handleFailedRequest(r.TypeDefinitionRequest.type,i,e,null))),s=n.middleware;return s.provideTypeDefinition?s.provideTypeDefinition(e,t,i,o):o(e,t,i)}};return[this.registerProvider(t,i),i]}registerProvider(e,t){return n.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}t.TypeDefinitionFeature=s},35488:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchyFeature=void 0;const n=i(9051),r=i(7846),o=i(69169);class s{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,i){const n=this.client,o=this.middleware,s=(e,t,i)=>{const o=n.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return n.sendRequest(r.TypeHierarchyPrepareRequest.type,o,i).then((e=>i.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(e,i)),(e=>n.handleFailedRequest(r.TypeHierarchyPrepareRequest.type,i,e,null)))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,i,s):s(e,t,i)}provideTypeHierarchySupertypes(e,t){const i=this.client,n=this.middleware,o=(e,t)=>{const n={item:i.code2ProtocolConverter.asTypeHierarchyItem(e)};return i.sendRequest(r.TypeHierarchySupertypesRequest.type,n,t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(e,t)),(e=>i.handleFailedRequest(r.TypeHierarchySupertypesRequest.type,t,e,null)))};return n.provideTypeHierarchySupertypes?n.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){const i=this.client,n=this.middleware,o=(e,t)=>{const n={item:i.code2ProtocolConverter.asTypeHierarchyItem(e)};return i.sendRequest(r.TypeHierarchySubtypesRequest.type,n,t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(e,t)),(e=>i.handleFailedRequest(r.TypeHierarchySubtypesRequest.type,t,e,null)))};return n.provideTypeHierarchySubtypes?n.provideTypeHierarchySubtypes(e,t,o):o(e,t)}}class a extends o.TextDocumentLanguageFeature{constructor(e){super(e,r.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){(0,o.ensure)((0,o.ensure)(e,"textDocument"),"typeHierarchy").dynamicRegistration=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.typeHierarchyProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=this._client,i=new s(t);return[n.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),i),i]}}t.TypeHierarchyFeature=a},28419:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.mapAsync=t.map=t.clearTestMode=t.setTestMode=t.Semaphore=t.Delayer=void 0;const n=i(7846);t.Delayer=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((e=>{this.onSuccess=e})).then((()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e}))),(t>=0||void 0===this.timeout)&&(this.timeout=(0,n.RAL)().timer.setTimeout((()=>{this.timeout=void 0,this.onSuccess(void 0)}),t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return void 0!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){void 0!==this.timeout&&(this.timeout.dispose(),this.timeout=void 0)}};t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,i)=>{this._waiting.push({thunk:e,resolve:t,reject:i}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,n.RAL)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};let r=!1;t.setTestMode=function(){r=!0},t.clearTestMode=function(){r=!1};class o{constructor(e=15){this.yieldAfter=!0===r?Math.max(e,2):Math.max(e,15),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=2*this.total}}return!1}}t.map=async function(e,t,i,r){if(0===e.length)return[];const s=new Array(e.length),a=new o(r?.yieldAfter);function c(i){a.start();for(let n=i;n<e.length;n++)if(s[n]=t(e[n]),a.shouldYield())return r?.yieldCallback&&r.yieldCallback(),n+1;return-1}let u=c(0);for(;-1!==u&&(void 0===i||!i.isCancellationRequested);)u=await new Promise((e=>{(0,n.RAL)().timer.setImmediate((()=>{e(c(u))}))}));return s},t.mapAsync=async function(e,t,i,r){if(0===e.length)return[];const s=new Array(e.length),a=new o(r?.yieldAfter);async function c(n){a.start();for(let o=n;o<e.length;o++)if(s[o]=await t(e[o],i),a.shouldYield())return r?.yieldCallback&&r.yieldCallback(),o+1;return-1}let u=await c(0);for(;-1!==u&&(void 0===i||!i.isCancellationRequested);)u=await new Promise((e=>{(0,n.RAL)().timer.setImmediate((()=>{e(c(u))}))}));return s},t.forEach=async function(e,t,i,r){if(0===e.length)return;const s=new o(r?.yieldAfter);function a(i){s.start();for(let n=i;n<e.length;n++)if(t(e[n]),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),n+1;return-1}let c=a(0);for(;-1!==c&&(void 0===i||!i.isCancellationRequested);)c=await new Promise((e=>{(0,n.RAL)().timer.setImmediate((()=>{e(a(c))}))}))}},92735:function(e,t){"use strict";function i(e){return"string"==typeof e||e instanceof String}function n(e){return"function"==typeof e}function r(e){return Array.isArray(e)}function o(e){return e&&n(e.then)}Object.defineProperty(t,"__esModule",{value:!0}),t.asPromise=t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=n,t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>i(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=o,t.asPromise=function(e){return e instanceof Promise?e:o(e)?new Promise(((t,i)=>{e.then((e=>t(e)),(e=>i(e)))})):Promise.resolve(e)}},66276:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class i{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class n extends i{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return n._oneOf(n._chars)}constructor(){super([n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-","4",n._randomHex(),n._randomHex(),n._randomHex(),"-",n._oneOf(n._timeHighBits),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex()].join(""))}}function r(){return new n}n._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],n._timeHighBits=["8","9","a","b"],t.empty=new i("00000000-0000-0000-0000-000000000000"),t.v4=r;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function s(e){return o.test(e)}t.isUUID=s,t.parse=function(e){if(!s(e))throw new Error("invalid uuid");return new i(e)},t.generateUuid=function(){return r().asHex()}},76278:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=t.arrayDiff=void 0;const n=i(66276),r=i(9051),o=i(7846);function s(e,t){if(null!=e)return e[t]}function a(e,t){return e.filter((e=>t.indexOf(e)<0))}t.arrayDiff=a;t.WorkspaceFoldersFeature=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return o.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){const t=r.workspace.workspaceFolders;this.initializeWithFolders(t),e.workspaceFolders=void 0===t?null:t.map((e=>this.asProtocol(e)))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){const t=this._client;t.onRequest(o.WorkspaceFoldersRequest.type,(e=>{const i=()=>{const e=r.workspace.workspaceFolders;if(void 0===e)return null;return e.map((e=>this.asProtocol(e)))},n=t.middleware.workspace;return n&&n.workspaceFolders?n.workspaceFolders(e,i):i()}));const i=s(s(s(e,"workspace"),"workspaceFolders"),"changeNotifications");let a;"string"==typeof i?a=i:!0===i&&(a=n.generateUuid()),a&&this.register({id:a,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){const i=a(this._initialFolders,e),n=a(e,this._initialFolders);(n.length>0||i.length>0)&&(t=this.doSendEvent(n,i))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));void 0!==t&&t.catch((e=>{this._client.error(`Sending notification ${o.DidChangeWorkspaceFoldersNotification.type.method} failed`,e)}))}doSendEvent(e,t){let i={event:{added:e.map((e=>this.asProtocol(e))),removed:t.map((e=>this.asProtocol(e)))}};return this._client.sendNotification(o.DidChangeWorkspaceFoldersNotification.type,i)}register(e){let t=e.id,i=this._client,n=r.workspace.onDidChangeWorkspaceFolders((e=>{let t=e=>this.doSendEvent(e.added,e.removed),n=i.middleware.workspace;(n&&n.didChangeWorkspaceFolders?n.didChangeWorkspaceFolders(e,t):t(e)).catch((e=>{this._client.error(`Sending notification ${o.DidChangeWorkspaceFoldersNotification.type.method} failed`,e)}))}));this._listeners.set(t,n),this.sendInitialEvent(r.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);void 0!==t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return void 0===e?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}},26949:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolFeature=void 0;const n=i(9051),r=i(7846),o=i(69169),s=i(81982),a=i(66276);class c extends o.WorkspaceFeature{constructor(e){super(e,r.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,o.ensure)((0,o.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:s.SupportedSymbolKinds},t.tagSupport={valueSet:s.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:a.generateUuid(),registerOptions:!0===e.workspaceSymbolProvider?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const t={provideWorkspaceSymbols:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.WorkspaceSymbolRequest.type,{query:e},t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asSymbolInformations(e,t)),(e=>i.handleFailedRequest(r.WorkspaceSymbolRequest.type,t,e,null))),o=i.middleware;return o.provideWorkspaceSymbols?o.provideWorkspaceSymbols(e,t,n):n(e,t)},resolveWorkspaceSymbol:!0===e.resolveProvider?(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.WorkspaceSymbolResolveRequest.type,i.code2ProtocolConverter.asWorkspaceSymbol(e),t).then((e=>t.isCancellationRequested?null:i.protocol2CodeConverter.asSymbolInformation(e)),(e=>i.handleFailedRequest(r.WorkspaceSymbolResolveRequest.type,t,e,null))),o=i.middleware;return o.resolveWorkspaceSymbol?o.resolveWorkspaceSymbol(e,t,n):n(e,t)}:void 0};return[n.languages.registerWorkspaceSymbolProvider(t),t]}}t.WorkspaceSymbolFeature=c},61966:function(e,t,i){var n=i(554);const r="object"==typeof n&&n&&"win32"===n.platform;e.exports=r?{sep:"\\"}:{sep:"/"}},84069:function(e,t,i){const n=e.exports=(e,t,i={})=>(m(t),!(!i.nocomment&&"#"===t.charAt(0))&&new C(t,i).match(e));e.exports=n;const r=i(61966);n.sep=r.sep;const o=Symbol("globstar **");n.GLOBSTAR=o;const s=i(77562),a={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},c="[^/]",u=c+"*?",l=e=>e.split("").reduce(((e,t)=>(e[t]=!0,e)),{}),d=l("().*{}+?[]^$\\!"),h=l("[.("),g=/\/+/;n.filter=(e,t={})=>(i,r,o)=>n(i,e,t);const f=(e,t={})=>{const i={};return Object.keys(e).forEach((t=>i[t]=e[t])),Object.keys(t).forEach((e=>i[e]=t[e])),i};n.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return n;const t=n,i=(i,n,r)=>t(i,n,f(e,r));return(i.Minimatch=class extends t.Minimatch{constructor(t,i){super(t,f(e,i))}}).defaults=i=>t.defaults(f(e,i)).Minimatch,i.filter=(i,n)=>t.filter(i,f(e,n)),i.defaults=i=>t.defaults(f(e,i)),i.makeRe=(i,n)=>t.makeRe(i,f(e,n)),i.braceExpand=(i,n)=>t.braceExpand(i,f(e,n)),i.match=(i,n,r)=>t.match(i,n,f(e,r)),i},n.braceExpand=(e,t)=>p(e,t);const p=(e,t={})=>(m(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:s(e)),m=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},v=Symbol("subparse");n.makeRe=(e,t)=>new C(e,t||{}).makeRe(),n.match=(e,t,i={})=>{const n=new C(t,i);return e=e.filter((e=>n.match(e))),n.options.nonull&&!e.length&&e.push(t),e};const y=e=>e.replace(/[[\]\\]/g,"\\$&");class C{constructor(e,t){m(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let i=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,i),i=this.globParts=i.map((e=>e.split(g))),this.debug(this.pattern,i),i=i.map(((e,t,i)=>e.map(this.parse,this))),this.debug(this.pattern,i),i=i.filter((e=>-1===e.indexOf(!1))),this.debug(this.pattern,i),this.set=i}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,i=0;for(let n=0;n<e.length&&"!"===e.charAt(n);n++)t=!t,i++;i&&(this.pattern=e.slice(i)),this.negate=t}matchOne(e,t,i){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,s=0,a=e.length,c=t.length;r<a&&s<c;r++,s++){this.debug("matchOne loop");var u,l=t[s],d=e[r];if(this.debug(t,l,d),!1===l)return!1;if(l===o){this.debug("GLOBSTAR",[t,l,d]);var h=r,g=s+1;if(g===c){for(this.debug("** at the end");r<a;r++)if("."===e[r]||".."===e[r]||!n.dot&&"."===e[r].charAt(0))return!1;return!0}for(;h<a;){var f=e[h];if(this.debug("\nglobstar while",e,h,t,g,f),this.matchOne(e.slice(h),t.slice(g),i))return this.debug("globstar found match!",h,a,f),!0;if("."===f||".."===f||!n.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,h,t,g);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!i||(this.debug("\n>>> no match, partial?",e,h,t,g),h!==a))}if("string"==typeof l?(u=d===l,this.debug("string match",l,d,u)):(u=d.match(l),this.debug("pattern match",l,d,u)),!u)return!1}if(r===a&&s===c)return!0;if(r===a)return i;if(s===c)return r===a-1&&""===e[r];throw new Error("wtf?")}braceExpand(){return p(this.pattern,this.options)}parse(e,t){m(e);const i=this.options;if("**"===e){if(!i.noglobstar)return o;e="*"}if(""===e)return"";let n="",r=!1,s=!1;const l=[],g=[];let f,p,C,w,S=!1,R=-1,_=-1,b="."===e.charAt(0),k=i.dot||b;const D=e=>"."===e.charAt(0)?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",T=()=>{if(f){switch(f){case"*":n+=u,r=!0;break;case"?":n+=c,r=!0;break;default:n+="\\"+f}this.debug("clearStateChar %j %j",f,n),f=!1}};for(let t,o=0;o<e.length&&(t=e.charAt(o));o++)if(this.debug("%s\t%s %s %j",e,o,n,t),s){if("/"===t)return!1;d[t]&&(n+="\\"),n+=t,s=!1}else switch(t){case"/":return!1;case"\\":if(S&&"-"===e.charAt(o+1)){n+=t;continue}T(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,o,n,t),S){this.debug("  in class"),"!"===t&&o===_+1&&(t="^"),n+=t;continue}this.debug("call clearStateChar %j",f),T(),f=t,i.noext&&T();continue;case"(":{if(S){n+="(";continue}if(!f){n+="\\(";continue}const t={type:f,start:o-1,reStart:n.length,open:a[f].open,close:a[f].close};this.debug(this.pattern,"\t",t),l.push(t),n+=t.open,0===t.start&&"!"!==t.type&&(b=!0,n+=D(e.slice(o+1))),this.debug("plType %j %j",f,n),f=!1;continue}case")":{const e=l[l.length-1];if(S||!e){n+="\\)";continue}l.pop(),T(),r=!0,C=e,n+=C.close,"!"===C.type&&g.push(Object.assign(C,{reEnd:n.length}));continue}case"|":{const t=l[l.length-1];if(S||!t){n+="\\|";continue}T(),n+="|",0===t.start&&"!"!==t.type&&(b=!0,n+=D(e.slice(o+1)));continue}case"[":if(T(),S){n+="\\"+t;continue}S=!0,_=o,R=n.length,n+=t;continue;case"]":if(o===_+1||!S){n+="\\"+t;continue}p=e.substring(_+1,o);try{RegExp("["+y(p.replace(/\\([^-\]])/g,"$1"))+"]"),n+=t}catch(e){n=n.substring(0,R)+"(?:$.)"}r=!0,S=!1;continue;default:T(),!d[t]||"^"===t&&S||(n+="\\"),n+=t}for(S&&(p=e.slice(_+1),w=this.parse(p,v),n=n.substring(0,R)+"\\["+w[0],r=r||w[1]),C=l.pop();C;C=l.pop()){let e;e=n.slice(C.reStart+C.open.length),this.debug("setting tail",n,C),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,i)=>(i||(i="\\"),t+t+i+"|"))),this.debug("tail=%j\n   %s",e,e,C,n);const t="*"===C.type?u:"?"===C.type?c:"\\"+C.type;r=!0,n=n.slice(0,C.reStart)+t+"\\("+e}T(),s&&(n+="\\\\");const E=h[n.charAt(0)];for(let e=g.length-1;e>-1;e--){const i=g[e],r=n.slice(0,i.reStart),o=n.slice(i.reStart,i.reEnd-8);let s=n.slice(i.reEnd);const a=n.slice(i.reEnd-8,i.reEnd)+s,c=r.split(")").length,u=r.split("(").length-c;let l=s;for(let e=0;e<u;e++)l=l.replace(/\)[+*?]?/,"");s=l;n=r+o+s+(""===s&&t!==v?"(?:$|\\/)":"")+a}if(""!==n&&r&&(n="(?=.)"+n),E&&(n=(b?"":k?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)")+n),t===v)return[n,r];if(i.nocase&&!r&&(r=e.toUpperCase()!==e.toLowerCase()),!r)return(e=>e.replace(/\\(.)/g,"$1"))(e);const P=i.nocase?"i":"";try{return Object.assign(new RegExp("^"+n+"$",P),{_glob:e,_src:n})}catch(e){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,i=t.noglobstar?u:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"";let r=e.map((e=>(e=e.map((e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===o?o:e._src)).reduce(((e,t)=>(e[e.length-1]===o&&t===o||e.push(t),e)),[]),e.forEach(((t,n)=>{t===o&&e[n-1]!==o&&(0===n?e.length>1?e[n+1]="(?:\\/|"+i+"\\/)?"+e[n+1]:e[n]=i:n===e.length-1?e[n-1]+="(?:\\/|"+i+")?":(e[n-1]+="(?:\\/|\\/"+i+"\\/)"+e[n+1],e[n+1]=o))})),e.filter((e=>e!==o)).join("/")))).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,n)}catch(e){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const i=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/")),e=e.split(g),this.debug(this.pattern,"split",e);const n=this.set;let o;this.debug(this.pattern,"set",n);for(let t=e.length-1;t>=0&&(o=e[t],!o);t--);for(let r=0;r<n.length;r++){const s=n[r];let a=e;i.matchBase&&1===s.length&&(a=[o]);if(this.matchOne(a,s,t))return!!i.flipNegate||!this.negate}return!i.flipNegate&&this.negate}static defaults(e){return n.defaults(e).Minimatch}}n.Minimatch=C},78086:function(e,t,i){"use strict";e.exports=i(7846)},7846:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const o=i(60502);r(i(60502),t),r(i(17748),t),t.createProtocolConnection=function(e,t,i,n){return(0,o.createMessageConnection)(e,t,i,n)}},17748:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,r(i(78603),t),r(i(38987),t),r(i(15503),t),r(i(34106),t);var o,s=i(13540);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return s.createProtocolConnection}}),function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800}(o||(t.LSPErrorCodes=o={}))},13540:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const n=i(78603);t.createProtocolConnection=function(e,t,i,r){return n.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,n.createMessageConnection)(e,t,i,r)}},15503:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=t.MessageDirection=void 0;const n=i(78603);var r;!function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"}(r||(t.MessageDirection=r={}));t.RegistrationType=class{constructor(e){this.method=e}};class o extends n.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=o;class s extends n.RequestType{constructor(e){super(e,n.ParameterStructures.byName)}}t.ProtocolRequestType=s;class a extends n.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a;class c extends n.NotificationType{constructor(e){super(e,n.ParameterStructures.byName)}}t.ProtocolNotificationType=c},94272:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const n=i(15503);var r,o,s;!function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.CallHierarchyPrepareRequest=r={})),function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(o||(t.CallHierarchyIncomingCallsRequest=o={})),function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(s||(t.CallHierarchyOutgoingCallsRequest=s={}))},76242:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const n=i(15503);var r,o;!function(e){e.method="textDocument/documentColor",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.DocumentColorRequest=r={})),function(e){e.method="textDocument/colorPresentation",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(o||(t.ColorPresentationRequest=o={}))},82837:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const n=i(15503);var r;!function(e){e.method="workspace/configuration",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType(e.method)}(r||(t.ConfigurationRequest=r={}))},39023:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const n=i(15503);var r;!function(e){e.method="textDocument/declaration",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.DeclarationRequest=r={}))},90628:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=void 0;const n=i(78603),r=i(52667),o=i(15503);var s,a,c,u,l;!function(e){e.is=function(e){const t=e;return t&&r.boolean(t.retriggerRequest)}}(s||(t.DiagnosticServerCancellationData=s={})),function(e){e.Full="full",e.Unchanged="unchanged"}(a||(t.DocumentDiagnosticReportKind=a={})),function(e){e.method="textDocument/diagnostic",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolRequestType(e.method),e.partialResult=new n.ProgressType}(c||(t.DocumentDiagnosticRequest=c={})),function(e){e.method="workspace/diagnostic",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolRequestType(e.method),e.partialResult=new n.ProgressType}(u||(t.WorkspaceDiagnosticRequest=u={})),function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=o.MessageDirection.serverToClient,e.type=new o.ProtocolRequestType0(e.method)}(l||(t.DiagnosticRefreshRequest=l={}))},80419:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const n=i(15503);var r,o,s,a,c,u,l;!function(e){e.file="file",e.folder="folder"}(r||(t.FileOperationPatternKind=r={})),function(e){e.method="workspace/willCreateFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(o||(t.WillCreateFilesRequest=o={})),function(e){e.method="workspace/didCreateFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(s||(t.DidCreateFilesNotification=s={})),function(e){e.method="workspace/willRenameFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(a||(t.WillRenameFilesRequest=a={})),function(e){e.method="workspace/didRenameFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(c||(t.DidRenameFilesNotification=c={})),function(e){e.method="workspace/didDeleteFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(u||(t.DidDeleteFilesNotification=u={})),function(e){e.method="workspace/willDeleteFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(l||(t.WillDeleteFilesRequest=l={}))},94752:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=void 0;const n=i(15503);var r,o;!function(e){e.method="textDocument/foldingRange",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.FoldingRangeRequest=r={})),function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType0(e.method)}(o||(t.FoldingRangeRefreshRequest=o={}))},3826:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const n=i(15503);var r;!function(e){e.method="textDocument/implementation",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.ImplementationRequest=r={}))},68179:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=void 0;const n=i(15503);var r,o,s;!function(e){e.method="textDocument/inlayHint",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.InlayHintRequest=r={})),function(e){e.method="inlayHint/resolve",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(o||(t.InlayHintResolveRequest=o={})),function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType0(e.method)}(s||(t.InlayHintRefreshRequest=s={}))},64154:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionRequest=void 0;const n=i(15503);var r;!function(e){e.method="textDocument/inlineCompletion",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.InlineCompletionRequest=r={}))},82191:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueRefreshRequest=t.InlineValueRequest=void 0;const n=i(15503);var r,o;!function(e){e.method="textDocument/inlineValue",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.InlineValueRequest=r={})),function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType0(e.method)}(o||(t.InlineValueRefreshRequest=o={}))},34106:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const n=i(15503),r=i(38987),o=i(52667),s=i(3826);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return s.ImplementationRequest}});const a=i(13210);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return a.TypeDefinitionRequest}});const c=i(54681);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return c.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return c.DidChangeWorkspaceFoldersNotification}});const u=i(82837);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return u.ConfigurationRequest}});const l=i(76242);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return l.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return l.ColorPresentationRequest}});const d=i(94752);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return d.FoldingRangeRefreshRequest}});const h=i(39023);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return h.DeclarationRequest}});const g=i(20197);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return g.SelectionRangeRequest}});const f=i(37554);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return f.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return f.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return f.WorkDoneProgressCancelNotification}});const p=i(94272);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return p.CallHierarchyPrepareRequest}});const m=i(95702);Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return m.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return m.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return m.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return m.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return m.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return m.SemanticTokensRegistrationType}});const v=i(15572);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return v.ShowDocumentRequest}});const y=i(98503);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const C=i(80419);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return C.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return C.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return C.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return C.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return C.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return C.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return C.WillDeleteFilesRequest}});const w=i(91535);Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return w.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return w.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return w.MonikerRequest}});const S=i(5585);Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return S.TypeHierarchyPrepareRequest}}),Object.defineProperty(t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return S.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return S.TypeHierarchySupertypesRequest}});const R=i(82191);Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return R.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return R.InlineValueRefreshRequest}});const _=i(68179);Object.defineProperty(t,"InlayHintRequest",{enumerable:!0,get:function(){return _.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return _.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return _.InlayHintRefreshRequest}});const b=i(90628);Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return b.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return b.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return b.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return b.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return b.DiagnosticRefreshRequest}});const k=i(38272);Object.defineProperty(t,"NotebookCellKind",{enumerable:!0,get:function(){return k.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return k.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return k.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return k.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return k.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return k.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return k.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return k.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return k.DidSaveNotebookDocumentNotification}}),Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return k.DidCloseNotebookDocumentNotification}});const D=i(64154);var T,E,P,O,x,I,M,F,N,A,L,q,W,j,U,K,$,H,z,V,B,J,G,Y,X,Q,Z,ee,te,ie,ne,re,oe,se,ae,ce,ue,le,de,he,ge,fe,pe,me,ve,ye,Ce,we,Se,Re,_e,be,ke,De,Te,Ee,Pe,Oe,xe,Ie,Me,Fe,Ne,Ae,Le;Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return D.InlineCompletionRequest}}),function(e){e.is=function(e){const t=e;return o.string(t)||o.string(t.language)||o.string(t.scheme)||o.string(t.pattern)}}(T||(t.TextDocumentFilter=T={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(o.string(t.notebookType)||o.string(t.scheme)||o.string(t.pattern))}}(E||(t.NotebookDocumentFilter=E={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(o.string(t.notebook)||E.is(t.notebook))&&(void 0===t.language||o.string(t.language))}}(P||(t.NotebookCellTextDocumentFilter=P={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!o.string(t)&&!T.is(t)&&!P.is(t))return!1;return!0}}(O||(t.DocumentSelector=O={})),function(e){e.method="client/registerCapability",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType(e.method)}(x||(t.RegistrationRequest=x={})),function(e){e.method="client/unregisterCapability",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType(e.method)}(I||(t.UnregistrationRequest=I={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(M||(t.ResourceOperationKind=M={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(F||(t.FailureHandlingKind=F={})),function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"}(N||(t.PositionEncodingKind=N={})),function(e){e.hasId=function(e){const t=e;return t&&o.string(t.id)&&t.id.length>0}}(A||(t.StaticRegistrationOptions=A={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||O.is(t.documentSelector))}}(L||(t.TextDocumentRegistrationOptions=L={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(void 0===t.workDoneProgress||o.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&o.boolean(t.workDoneProgress)}}(q||(t.WorkDoneProgressOptions=q={})),function(e){e.method="initialize",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(W||(t.InitializeRequest=W={})),function(e){e.unknownProtocolVersion=1}(j||(t.InitializeErrorCodes=j={})),function(e){e.method="initialized",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(U||(t.InitializedNotification=U={})),function(e){e.method="shutdown",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType0(e.method)}(K||(t.ShutdownRequest=K={})),function(e){e.method="exit",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType0(e.method)}($||(t.ExitNotification=$={})),function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(H||(t.DidChangeConfigurationNotification=H={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5}(z||(t.MessageType=z={})),function(e){e.method="window/showMessage",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolNotificationType(e.method)}(V||(t.ShowMessageNotification=V={})),function(e){e.method="window/showMessageRequest",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType(e.method)}(B||(t.ShowMessageRequest=B={})),function(e){e.method="window/logMessage",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolNotificationType(e.method)}(J||(t.LogMessageNotification=J={})),function(e){e.method="telemetry/event",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolNotificationType(e.method)}(G||(t.TelemetryEventNotification=G={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(Y||(t.TextDocumentSyncKind=Y={})),function(e){e.method="textDocument/didOpen",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(X||(t.DidOpenTextDocumentNotification=X={})),function(e){e.isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}(Q||(t.TextDocumentContentChangeEvent=Q={})),function(e){e.method="textDocument/didChange",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(Z||(t.DidChangeTextDocumentNotification=Z={})),function(e){e.method="textDocument/didClose",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(ee||(t.DidCloseTextDocumentNotification=ee={})),function(e){e.method="textDocument/didSave",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(te||(t.DidSaveTextDocumentNotification=te={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(ie||(t.TextDocumentSaveReason=ie={})),function(e){e.method="textDocument/willSave",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(ne||(t.WillSaveTextDocumentNotification=ne={})),function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(re||(t.WillSaveTextDocumentWaitUntilRequest=re={})),function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(oe||(t.DidChangeWatchedFilesNotification=oe={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(se||(t.FileChangeType=se={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(r.URI.is(t.baseUri)||r.WorkspaceFolder.is(t.baseUri))&&o.string(t.pattern)}}(ae||(t.RelativePattern=ae={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(ce||(t.WatchKind=ce={})),function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolNotificationType(e.method)}(ue||(t.PublishDiagnosticsNotification=ue={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(le||(t.CompletionTriggerKind=le={})),function(e){e.method="textDocument/completion",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(de||(t.CompletionRequest=de={})),function(e){e.method="completionItem/resolve",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(he||(t.CompletionResolveRequest=he={})),function(e){e.method="textDocument/hover",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(ge||(t.HoverRequest=ge={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(fe||(t.SignatureHelpTriggerKind=fe={})),function(e){e.method="textDocument/signatureHelp",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(pe||(t.SignatureHelpRequest=pe={})),function(e){e.method="textDocument/definition",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(me||(t.DefinitionRequest=me={})),function(e){e.method="textDocument/references",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(ve||(t.ReferencesRequest=ve={})),function(e){e.method="textDocument/documentHighlight",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(ye||(t.DocumentHighlightRequest=ye={})),function(e){e.method="textDocument/documentSymbol",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Ce||(t.DocumentSymbolRequest=Ce={})),function(e){e.method="textDocument/codeAction",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(we||(t.CodeActionRequest=we={})),function(e){e.method="codeAction/resolve",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Se||(t.CodeActionResolveRequest=Se={})),function(e){e.method="workspace/symbol",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Re||(t.WorkspaceSymbolRequest=Re={})),function(e){e.method="workspaceSymbol/resolve",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(_e||(t.WorkspaceSymbolResolveRequest=_e={})),function(e){e.method="textDocument/codeLens",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(be||(t.CodeLensRequest=be={})),function(e){e.method="codeLens/resolve",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(ke||(t.CodeLensResolveRequest=ke={})),function(e){e.method="workspace/codeLens/refresh",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType0(e.method)}(De||(t.CodeLensRefreshRequest=De={})),function(e){e.method="textDocument/documentLink",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Te||(t.DocumentLinkRequest=Te={})),function(e){e.method="documentLink/resolve",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Ee||(t.DocumentLinkResolveRequest=Ee={})),function(e){e.method="textDocument/formatting",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Pe||(t.DocumentFormattingRequest=Pe={})),function(e){e.method="textDocument/rangeFormatting",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Oe||(t.DocumentRangeFormattingRequest=Oe={})),function(e){e.method="textDocument/rangesFormatting",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(xe||(t.DocumentRangesFormattingRequest=xe={})),function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Ie||(t.DocumentOnTypeFormattingRequest=Ie={})),function(e){e.Identifier=1}(Me||(t.PrepareSupportDefaultBehavior=Me={})),function(e){e.method="textDocument/rename",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Fe||(t.RenameRequest=Fe={})),function(e){e.method="textDocument/prepareRename",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Ne||(t.PrepareRenameRequest=Ne={})),function(e){e.method="workspace/executeCommand",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(Ae||(t.ExecuteCommandRequest=Ae={})),function(e){e.method="workspace/applyEdit",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType("workspace/applyEdit")}(Le||(t.ApplyWorkspaceEditRequest=Le={}))},98503:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const n=i(15503);var r;!function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.LinkedEditingRangeRequest=r={}))},91535:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const n=i(15503);var r,o,s;!function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"}(r||(t.UniquenessLevel=r={})),function(e){e.$import="import",e.$export="export",e.local="local"}(o||(t.MonikerKind=o={})),function(e){e.method="textDocument/moniker",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(s||(t.MonikerRequest=s={}))},38272:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=void 0;const n=i(38987),r=i(52667),o=i(15503);var s,a,c,u,l,d,h,g,f,p;!function(e){e.Markup=1,e.Code=2,e.is=function(e){return 1===e||2===e}}(s||(t.NotebookCellKind=s={})),function(e){e.create=function(e,t){const i={executionOrder:e};return!0!==t&&!1!==t||(i.success=t),i},e.is=function(e){const t=e;return r.objectLiteral(t)&&n.uinteger.is(t.executionOrder)&&(void 0===t.success||r.boolean(t.success))},e.equals=function(e,t){return e===t||null!=e&&null!=t&&(e.executionOrder===t.executionOrder&&e.success===t.success)}}(a||(t.ExecutionSummary=a={})),function(e){function t(e,i){if(e===i)return!0;if(null==e||null==i)return!1;if(typeof e!=typeof i)return!1;if("object"!=typeof e)return!1;const n=Array.isArray(e),o=Array.isArray(i);if(n!==o)return!1;if(n&&o){if(e.length!==i.length)return!1;for(let n=0;n<e.length;n++)if(!t(e[n],i[n]))return!1}if(r.objectLiteral(e)&&r.objectLiteral(i)){const n=Object.keys(e),r=Object.keys(i);if(n.length!==r.length)return!1;if(n.sort(),r.sort(),!t(n,r))return!1;for(let r=0;r<n.length;r++){const o=n[r];if(!t(e[o],i[o]))return!1}}return!0}e.create=function(e,t){return{kind:e,document:t}},e.is=function(e){const t=e;return r.objectLiteral(t)&&s.is(t.kind)&&n.DocumentUri.is(t.document)&&(void 0===t.metadata||r.objectLiteral(t.metadata))},e.diff=function(e,i){const n=new Set;return e.document!==i.document&&n.add("document"),e.kind!==i.kind&&n.add("kind"),e.executionSummary!==i.executionSummary&&n.add("executionSummary"),void 0===e.metadata&&void 0===i.metadata||t(e.metadata,i.metadata)||n.add("metadata"),void 0===e.executionSummary&&void 0===i.executionSummary||a.equals(e.executionSummary,i.executionSummary)||n.add("executionSummary"),n}}(c||(t.NotebookCell=c={})),function(e){e.create=function(e,t,i,n){return{uri:e,notebookType:t,version:i,cells:n}},e.is=function(e){const t=e;return r.objectLiteral(t)&&r.string(t.uri)&&n.integer.is(t.version)&&r.typedArray(t.cells,c.is)}}(u||(t.NotebookDocument=u={})),function(e){e.method="notebookDocument/sync",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.RegistrationType(e.method)}(l||(t.NotebookDocumentSyncRegistrationType=l={})),function(e){e.method="notebookDocument/didOpen",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(d||(t.DidOpenNotebookDocumentNotification=d={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&n.uinteger.is(t.start)&&n.uinteger.is(t.deleteCount)&&(void 0===t.cells||r.typedArray(t.cells,c.is))},e.create=function(e,t,i){const n={start:e,deleteCount:t};return void 0!==i&&(n.cells=i),n}}(h||(t.NotebookCellArrayChange=h={})),function(e){e.method="notebookDocument/didChange",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(g||(t.DidChangeNotebookDocumentNotification=g={})),function(e){e.method="notebookDocument/didSave",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(f||(t.DidSaveNotebookDocumentNotification=f={})),function(e){e.method="notebookDocument/didClose",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(p||(t.DidCloseNotebookDocumentNotification=p={}))},37554:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const n=i(78603),r=i(15503);var o,s,a;!function(e){e.type=new n.ProgressType,e.is=function(t){return t===e.type}}(o||(t.WorkDoneProgress=o={})),function(e){e.method="window/workDoneProgress/create",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType(e.method)}(s||(t.WorkDoneProgressCreateRequest=s={})),function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(a||(t.WorkDoneProgressCancelNotification=a={}))},20197:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const n=i(15503);var r;!function(e){e.method="textDocument/selectionRange",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.SelectionRangeRequest=r={}))},95702:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=void 0;const n=i(15503);var r,o,s,a,c,u;!function(e){e.Relative="relative"}(r||(t.TokenFormat=r={})),function(e){e.method="textDocument/semanticTokens",e.type=new n.RegistrationType(e.method)}(o||(t.SemanticTokensRegistrationType=o={})),function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method),e.registrationMethod=o.method}(s||(t.SemanticTokensRequest=s={})),function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method),e.registrationMethod=o.method}(a||(t.SemanticTokensDeltaRequest=a={})),function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method),e.registrationMethod=o.method}(c||(t.SemanticTokensRangeRequest=c={})),function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType0(e.method)}(u||(t.SemanticTokensRefreshRequest=u={}))},15572:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const n=i(15503);var r;!function(e){e.method="window/showDocument",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType(e.method)}(r||(t.ShowDocumentRequest=r={}))},13210:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const n=i(15503);var r;!function(e){e.method="textDocument/typeDefinition",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.TypeDefinitionRequest=r={}))},5585:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchySubtypesRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchyPrepareRequest=void 0;const n=i(15503);var r,o,s;!function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(r||(t.TypeHierarchyPrepareRequest=r={})),function(e){e.method="typeHierarchy/supertypes",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(o||(t.TypeHierarchySupertypesRequest=o={})),function(e){e.method="typeHierarchy/subtypes",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolRequestType(e.method)}(s||(t.TypeHierarchySubtypesRequest=s={}))},54681:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const n=i(15503);var r,o;!function(e){e.method="workspace/workspaceFolders",e.messageDirection=n.MessageDirection.serverToClient,e.type=new n.ProtocolRequestType0(e.method)}(r||(t.WorkspaceFoldersRequest=r={})),function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=n.MessageDirection.clientToServer,e.type=new n.ProtocolNotificationType(e.method)}(o||(t.DidChangeWorkspaceFoldersNotification=o={}))},52667:function(e,t){"use strict";function i(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every((e=>i(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},81613:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0;i(60014).default.install();const o=i(97904);r(i(97904),t);class s extends o.AbstractMessageReader{constructor(e){super(),this._onData=new o.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=s;class a extends o.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=a,t.createMessageConnection=function(e,t,i,n){return void 0===i&&(i=o.NullLogger),o.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,o.createMessageConnection)(e,t,i,n)}},60014:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(97904);class r extends n.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return r.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}r.emptyBuffer=new Uint8Array(0);class o{constructor(e){this.socket=e,this._onData=new n.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,n.RAL)().console.error("Converting blob to array buffer failed.")}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),n.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),n.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),n.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class s{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),n.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),n.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),n.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,c=Object.freeze({messageBuffer:Object.freeze({create:e=>new r(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(a.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new o(e),asWritableStream:e=>new s(e)}),console:console,timer:Object.freeze({setTimeout(e,t,...i){const n=setTimeout(e,t,...i);return{dispose:()=>clearTimeout(n)}},setImmediate(e,...t){const i=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(i)}},setInterval(e,t,...i){const n=setInterval(e,t,...i);return{dispose:()=>clearInterval(n)}}})});function u(){return c}!function(e){e.install=function(){n.RAL.install(c)}}(u||(u={})),t.default=u},97904:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const n=i(9010);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return n.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return n.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return n.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return n.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return n.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return n.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return n.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return n.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return n.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return n.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return n.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return n.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return n.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return n.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return n.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return n.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return n.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return n.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return n.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return n.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return n.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return n.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return n.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return n.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return n.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return n.ParameterStructures}});const r=i(3865);Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return r.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return r.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return r.Touch}});const o=i(45264);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const s=i(1437);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const a=i(6e3);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const c=i(66564);Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return c.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return c.SharedArrayReceiverStrategy}});const u=i(23397);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return u.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return u.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return u.ReadableStreamMessageReader}});const l=i(594);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const d=i(37542);Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const h=i(35340);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return h.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return h.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return h.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return h.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return h.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return h.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return h.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return h.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return h.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return h.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return h.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return h.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return h.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return h.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return h.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return h.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return h.MessageStrategy}});const g=i(2969);t.RAL=g.default},6e3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const n=i(2969),r=i(82611),o=i(1437);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:o.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:o.Event.None}),e.is=function(t){const i=t;return i&&(i===e.None||i===e.Cancelled||r.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}}(s||(t.CancellationToken=s={}));const a=Object.freeze((function(e,t){const i=(0,n.default)().timer.setTimeout(e.bind(t),0);return{dispose(){i.dispose()}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new o.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},35340:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const n=i(2969),r=i(82611),o=i(9010),s=i(3865),a=i(1437),c=i(6e3);var u,l,d,h,g,f,p,m,v,y,C,w,S,R,_,b,k,D,T;!function(e){e.type=new o.NotificationType("$/cancelRequest")}(u||(u={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(l||(t.ProgressToken=l={})),function(e){e.type=new o.NotificationType("$/progress")}(d||(d={}));t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return r.func(e)}}(h||(h={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(g||(t.Trace=g={})),function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"}(f||(t.TraceValues=f={})),function(e){e.fromString=function(t){if(!r.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(g||(t.Trace=g={})),function(e){e.Text="text",e.JSON="json"}(p||(t.TraceFormat=p={})),function(e){e.fromString=function(t){return r.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p||(t.TraceFormat=p={})),function(e){e.type=new o.NotificationType("$/setTrace")}(m||(t.SetTraceNotification=m={})),function(e){e.type=new o.NotificationType("$/logTrace")}(v||(t.LogTraceNotification=v={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(y||(t.ConnectionErrors=y={}));class E extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,E.prototype)}}t.ConnectionError=E,function(e){e.is=function(e){const t=e;return t&&r.func(t.cancelUndispatched)}}(C||(t.ConnectionStrategy=C={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&r.func(t.createCancellationTokenSource)&&(void 0===t.dispose||r.func(t.dispose))}}(w||(t.IdCancellationReceiverStrategy=w={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&r.func(t.createCancellationTokenSource)&&(void 0===t.dispose||r.func(t.dispose))}}(S||(t.RequestCancellationReceiverStrategy=S={})),function(e){e.Message=Object.freeze({createCancellationTokenSource(e){return new c.CancellationTokenSource}}),e.is=function(e){return w.is(e)||S.is(e)}}(R||(t.CancellationReceiverStrategy=R={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){return e.sendNotification(u.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&r.func(t.sendCancellation)&&r.func(t.cleanup)}}(_||(t.CancellationSenderStrategy=_={})),function(e){e.Message=Object.freeze({receiver:R.Message,sender:_.Message}),e.is=function(e){const t=e;return t&&R.is(t.receiver)&&_.is(t.sender)}}(b||(t.CancellationStrategy=b={})),function(e){e.is=function(e){const t=e;return t&&r.func(t.handleMessage)}}(k||(t.MessageStrategy=k={})),function(e){e.is=function(e){const t=e;return t&&(b.is(t.cancellationStrategy)||C.is(t.connectionStrategy)||k.is(t.messageStrategy))}}(D||(t.ConnectionOptions=D={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(T||(T={})),t.createMessageConnection=function(e,i,f,C){const S=void 0!==f?f:t.NullLogger;let R=0,_=0,D=0;const P="2.0";let O;const x=new Map;let I;const M=new Map,F=new Map;let N,A,L=new s.LinkedMap,q=new Map,W=new Set,j=new Map,U=g.Off,K=p.Text,$=T.New;const H=new a.Emitter,z=new a.Emitter,V=new a.Emitter,B=new a.Emitter,J=new a.Emitter,G=C&&C.cancellationStrategy?C.cancellationStrategy:b.Message;function Y(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function X(e,t){var i;o.Message.isRequest(t)?e.set(Y(t.id),t):o.Message.isResponse(t)?e.set(null===(i=t.id)?"res-unknown-"+(++D).toString():"res-"+i.toString(),t):e.set("not-"+(++_).toString(),t)}function Q(e){}function Z(){return $===T.Listening}function ee(){return $===T.Closed}function te(){return $===T.Disposed}function ie(){$!==T.New&&$!==T.Listening||($=T.Closed,z.fire(void 0))}function ne(){N||0===L.size||(N=(0,n.default)().timer.setImmediate((()=>{N=void 0,function(){if(0===L.size)return;const e=L.shift();try{const t=C?.messageStrategy;k.is(t)?t.handleMessage(e,re):re(e)}finally{ne()}}()})))}function re(e){o.Message.isRequest(e)?function(e){if(te())return;function t(t,n,r){const s={jsonrpc:P,id:e.id};t instanceof o.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,ae(s,n,r),i.write(s).catch((()=>S.error("Sending response failed.")))}function n(t,n,r){const o={jsonrpc:P,id:e.id,error:t.toJson()};ae(o,n,r),i.write(o).catch((()=>S.error("Sending response failed.")))}function s(t,n,r){void 0===t&&(t=null);const o={jsonrpc:P,id:e.id,result:t};ae(o,n,r),i.write(o).catch((()=>S.error("Sending response failed.")))}!function(e){if(U===g.Off||!A)return;if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),A.log(`Received request '${e.method} - (${e.id})'.`,t)}else ue("receive-request",e)}(e);const a=x.get(e.method);let c,u;a&&(c=a.type,u=a.handler);const l=Date.now();if(u||O){const i=e.id??String(Date.now()),a=w.is(G.receiver)?G.receiver.createCancellationTokenSource(i):G.receiver.createCancellationTokenSource(e);null!==e.id&&W.has(e.id)&&a.cancel(),null!==e.id&&j.set(i,a);try{let d;if(u)if(void 0===e.params){if(void 0!==c&&0!==c.numberOfParams)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines ${c.numberOfParams} params but received none.`),e.method,l);d=u(a.token)}else if(Array.isArray(e.params)){if(void 0!==c&&c.parameterStructures===o.ParameterStructures.byName)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,l);d=u(...e.params,a.token)}else{if(void 0!==c&&c.parameterStructures===o.ParameterStructures.byPosition)return void n(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,l);d=u(e.params,a.token)}else O&&(d=O(e.method,e.params,a.token));const h=d;d?h.then?h.then((n=>{j.delete(i),t(n,e.method,l)}),(t=>{j.delete(i),t instanceof o.ResponseError?n(t,e.method,l):t&&r.string(t.message)?n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(j.delete(i),t(d,e.method,l)):(j.delete(i),s(d,e.method,l))}catch(s){j.delete(i),s instanceof o.ResponseError?t(s,e.method,l):s&&r.string(s.message)?n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${s.message}`),e.method,l):n(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else n(new o.ResponseError(o.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):o.Message.isNotification(e)?function(e){if(te())return;let t,i;if(e.method===u.type.method){const t=e.params.id;return W.delete(t),void ce(e)}{const n=M.get(e.method);n&&(i=n.handler,t=n.type)}if(i||I)try{if(ce(e),i)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==o.ParameterStructures.byName&&S.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),i();else if(Array.isArray(e.params)){const n=e.params;e.method===d.type.method&&2===n.length&&l.is(n[0])?i({token:n[0],value:n[1]}):(void 0!==t&&(t.parameterStructures===o.ParameterStructures.byName&&S.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&S.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${n.length} arguments`)),i(...n))}else void 0!==t&&t.parameterStructures===o.ParameterStructures.byPosition&&S.error(`Notification ${e.method} defines parameters by position but received parameters by name`),i(e.params);else I&&I(e.method,e.params)}catch(t){t.message?S.error(`Notification handler '${e.method}' failed with message: ${t.message}`):S.error(`Notification handler '${e.method}' failed unexpectedly.`)}else V.fire(e)}(e):o.Message.isResponse(e)?function(e){if(te())return;if(null===e.id)e.error?S.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):S.error("Received response message without id. No further error information provided.");else{const t=e.id,i=q.get(t);if(function(e,t){if(U===g.Off||!A)return;if(K===p.Text){let i;if(U!==g.Verbose&&U!==g.Compact||(e.error&&e.error.data?i=`Error data: ${se(e.error.data)}\n\n`:e.result?i=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),t){const n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";A.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,i)}else A.log(`Received response ${e.id} without active response promise.`,i)}else ue("receive-response",e)}(e,i),void 0!==i){q.delete(t);try{if(e.error){const t=e.error;i.reject(new o.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");i.resolve(e.result)}}catch(e){e.message?S.error(`Response handler '${i.method}' failed with message: ${e.message}`):S.error(`Response handler '${i.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void S.error("Received empty message.");S.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(r.string(t.id)||r.number(t.id)){const e=t.id,i=q.get(e);i&&i.reject(new Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(ie),e.onError((function(e){H.fire([e,void 0,void 0])})),i.onClose(ie),i.onError((function(e){H.fire(e)}));const oe=e=>{try{if(o.Message.isNotification(e)&&e.method===u.type.method){const t=e.params.id,n=Y(t),r=L.get(n);if(o.Message.isRequest(r)){const o=C?.connectionStrategy,s=o&&o.cancelUndispatched?o.cancelUndispatched(r,Q):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return L.delete(n),j.delete(t),s.id=r.id,ae(s,e.method,Date.now()),void i.write(s).catch((()=>S.error("Sending response for canceled message failed.")))}const s=j.get(t);if(void 0!==s)return s.cancel(),void ce(e);W.add(t)}X(L,e)}finally{ne()}};function se(e){if(null!=e)switch(U){case g.Verbose:return JSON.stringify(e,null,4);case g.Compact:return JSON.stringify(e);default:return}}function ae(e,t,i){if(U!==g.Off&&A)if(K===p.Text){let n;U!==g.Verbose&&U!==g.Compact||(e.error&&e.error.data?n=`Error data: ${se(e.error.data)}\n\n`:e.result?n=`Result: ${se(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),A.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-i}ms`,n)}else ue("send-response",e)}function ce(e){if(U!==g.Off&&A&&e.method!==v.type.method)if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),A.log(`Received notification '${e.method}'.`,t)}else ue("receive-notification",e)}function ue(e,t){if(!A||U===g.Off)return;const i={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};A.log(i)}function le(){if(ee())throw new E(y.Closed,"Connection is closed.");if(te())throw new E(y.Disposed,"Connection is disposed.")}function de(e){return void 0===e?null:e}function he(e){return null===e?void 0:e}function ge(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function fe(e,t){switch(e){case o.ParameterStructures.auto:return ge(t)?he(t):[de(t)];case o.ParameterStructures.byName:if(!ge(t))throw new Error("Received parameters by name but param is not an object literal.");return he(t);case o.ParameterStructures.byPosition:return[de(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function pe(e,t){let i;const n=e.numberOfParams;switch(n){case 0:i=void 0;break;case 1:i=fe(e.parameterStructures,t[0]);break;default:i=[];for(let e=0;e<t.length&&e<n;e++)i.push(de(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)i.push(null)}return i}const me={sendNotification:(e,...t)=>{let n,s;if(le(),r.string(e)){n=e;const i=t[0];let r=0,a=o.ParameterStructures.auto;o.ParameterStructures.is(i)&&(r=1,a=i);let c=t.length;const u=c-r;switch(u){case 0:s=void 0;break;case 1:s=fe(a,t[r]);break;default:if(a===o.ParameterStructures.byName)throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`);s=t.slice(r,c).map((e=>de(e)))}}else{const i=t;n=e.method,s=pe(e,i)}const a={jsonrpc:P,method:n,params:s};return function(e){if(U!==g.Off&&A)if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||(t=e.params?`Params: ${se(e.params)}\n\n`:"No parameters provided.\n\n"),A.log(`Sending notification '${e.method}'.`,t)}else ue("send-notification",e)}(a),i.write(a).catch((e=>{throw S.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let i;return le(),r.func(e)?I=e:t&&(r.string(e)?(i=e,M.set(e,{type:void 0,handler:t})):(i=e.method,M.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==i?M.delete(i):I=void 0}}},onProgress:(e,t,i)=>{if(F.has(t))throw new Error(`Progress handler for token ${t} already registered`);return F.set(t,i),{dispose:()=>{F.delete(t)}}},sendProgress:(e,t,i)=>me.sendNotification(d.type,{token:t,value:i}),onUnhandledProgress:B.event,sendRequest:(e,...t)=>{let n,s,a;if(le(),function(){if(!Z())throw new Error("Call listen() first.")}(),r.string(e)){n=e;const i=t[0],r=t[t.length-1];let u=0,l=o.ParameterStructures.auto;o.ParameterStructures.is(i)&&(u=1,l=i);let d=t.length;c.CancellationToken.is(r)&&(d-=1,a=r);const h=d-u;switch(h){case 0:s=void 0;break;case 1:s=fe(l,t[u]);break;default:if(l===o.ParameterStructures.byName)throw new Error(`Received ${h} parameters for 'by Name' request parameter structure.`);s=t.slice(u,d).map((e=>de(e)))}}else{const i=t;n=e.method,s=pe(e,i);const r=e.numberOfParams;a=c.CancellationToken.is(i[r])?i[r]:void 0}const u=R++;let l;a&&(l=a.onCancellationRequested((()=>{const e=G.sender.sendCancellation(me,u);return void 0===e?(S.log(`Received no promise from cancellation strategy when cancelling id ${u}`),Promise.resolve()):e.catch((()=>{S.log(`Sending cancellation messages for id ${u} failed`)}))})));const d={jsonrpc:P,id:u,method:n,params:s};return function(e){if(U!==g.Off&&A)if(K===p.Text){let t;U!==g.Verbose&&U!==g.Compact||!e.params||(t=`Params: ${se(e.params)}\n\n`),A.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ue("send-request",e)}(d),"function"==typeof G.sender.enableCancellation&&G.sender.enableCancellation(d),new Promise((async(e,t)=>{const r={method:n,timerStart:Date.now(),resolve:t=>{e(t),G.sender.cleanup(u),l?.dispose()},reject:e=>{t(e),G.sender.cleanup(u),l?.dispose()}};try{q.set(u,r),await i.write(d)}catch(e){throw q.delete(u),r.reject(new o.ResponseError(o.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),S.error("Sending request failed."),e}}))},onRequest:(e,t)=>{le();let i=null;return h.is(e)?(i=void 0,O=e):r.string(e)?(i=null,void 0!==t&&(i=e,x.set(e,{handler:t,type:void 0}))):void 0!==t&&(i=e.method,x.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==i&&(void 0!==i?x.delete(i):O=void 0)}}},hasPendingResponse:()=>q.size>0,trace:async(e,t,i)=>{let n=!1,o=p.Text;void 0!==i&&(r.boolean(i)?n=i:(n=i.sendNotification||!1,o=i.traceFormat||p.Text)),U=e,K=o,A=U===g.Off?void 0:t,!n||ee()||te()||await me.sendNotification(m.type,{value:g.toString(e)})},onError:H.event,onClose:z.event,onUnhandledNotification:V.event,onDispose:J.event,end:()=>{i.end()},dispose:()=>{if(te())return;$=T.Disposed,J.fire(void 0);const t=new o.ResponseError(o.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of q.values())e.reject(t);q=new Map,j=new Map,W=new Set,L=new s.LinkedMap,r.func(i.dispose)&&i.dispose(),r.func(e.dispose)&&e.dispose()},listen:()=>{le(),function(){if(Z())throw new E(y.AlreadyListening,"Connection is already listening")}(),$=T.Listening,e.listen(oe)},inspect:()=>{(0,n.default)().console.log("inspect")}};return me.onNotification(v.type,(e=>{if(U===g.Off||!A)return;const t=U===g.Verbose||U===g.Compact;A.log(e.message,t?e.verbose:void 0)})),me.onNotification(d.type,(e=>{const t=F.get(e.token);t?t(e.value):B.fire(e)})),me}},45264:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,function(e){e.create=function(e){return{dispose:e}}}(i||(t.Disposable=i={}))},1437:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const n=i(2969);var r;!function(e){const t={dispose(){}};e.None=function(){return t}}(r||(t.Event=r={}));class o{add(e,t=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let i=!1;for(let n=0,r=this._callbacks.length;n<r;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);i=!0}if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],i=this._callbacks.slice(0),r=this._contexts.slice(0);for(let o=0,s=i.length;o<s;o++)try{t.push(i[o].apply(r[o],e))}catch(e){(0,n.default)().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,i)=>{this._callbacks||(this._callbacks=new o),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const n={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),n.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(n),n}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},82611:function(e,t){"use strict";function i(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=i,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every((e=>i(e)))}},3865:function(e,t){"use strict";var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n||(t.Touch=n={}));class r{constructor(){this[i]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let r=this._map.get(e);if(r)r.value=t,i!==n.None&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(r);break;case n.First:this.addItemFirst(r);break;case n.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return i}[(i=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(t.previous=i,i.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,i=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=i,i.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,i)=>{e.push([i,t])})),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}t.LinkedMap=r;t.LRUCache=class extends r{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},37542:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0;t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,i=0,n=0,r=0;e:for(;i<this._chunks.length;){const e=this._chunks[i];for(n=0;n<e.length;){switch(e[n]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,n++;break e;default:t=0}break;default:t=0}n++}r+=e.byteLength,i++}if(4!==t)return;const o=this._read(r+n),s=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return s;for(let t=0;t<a.length-2;t++){const i=a[t],n=i.indexOf(":");if(-1===n)throw new Error(`Message header must separate key and value using ':'\n${i}`);const r=i.substr(0,n),o=i.substr(n+1).trim();s.set(e?r.toLowerCase():r,o)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],i=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,i}const t=this.allocNative(e);let i=0;for(;e>0;){const n=this._chunks[0];if(n.byteLength>e){const r=n.slice(0,e);t.set(r,i),i+=e,this._chunks[0]=n.slice(e),this._totalLength-=e,e-=e}else t.set(n,i),i+=n.byteLength,this._chunks.shift(),this._totalLength-=n.byteLength,e-=n.byteLength}return t}}},23397:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const n=i(2969),r=i(82611),o=i(1437),s=i(16113);var a,c;!function(e){e.is=function(e){let t=e;return t&&r.func(t.listen)&&r.func(t.dispose)&&r.func(t.onError)&&r.func(t.onClose)&&r.func(t.onPartialMessage)}}(a||(t.MessageReader=a={}));class u{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter,this.partialMessageEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=u,function(e){e.fromOptions=function(e){let t,i;const r=new Map;let o;const s=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(i=e.contentDecoder,r.set(i.name,i)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)r.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(o=e.contentTypeDecoder,s.set(o.name,o)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===o&&(o=(0,n.default)().applicationJson.decoder,s.set(o.name,o)),{charset:t,contentDecoder:i,contentDecoders:r,contentTypeDecoder:o,contentTypeDecoders:s}}}(c||(c={}));t.ReadableStreamMessageReader=class extends u{constructor(e,t){super(),this.readable=e,this.options=c.fromOptions(t),this.buffer=(0,n.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){try{for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error(`Header must provide a Content-Length property.\n${JSON.stringify(Object.fromEntries(e))}`));const i=parseInt(t);if(isNaN(i))return void this.fireError(new Error(`Content-Length value must be a number. Got ${t}`));this.nextMessageLength=i}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,i=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(i)})).catch((e=>{this.fireError(e)}))}}catch(e){this.fireError(e)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,n.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},594:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const n=i(2969),r=i(82611),o=i(16113),s=i(1437);var a,c;!function(e){e.is=function(e){let t=e;return t&&r.func(t.dispose)&&r.func(t.onClose)&&r.func(t.onError)&&r.func(t.write)}}(a||(t.MessageWriter=a={}));class u{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,i){this.errorEmitter.fire([this.asError(e),t,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${r.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=u,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,n.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,n.default)().applicationJson.encoder}}}(c||(c={}));t.WriteableStreamMessageWriter=class extends u{constructor(e,t){super(),this.writable=e,this.options=c.fromOptions(t),this.errorCount=0,this.writeSemaphore=new o.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const i=[];return i.push("Content-Length: ",t.byteLength.toString(),"\r\n"),i.push("\r\n"),this.doWrite(e,i,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,i){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(i)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},9010:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const n=i(82611);var r,o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(r||(t.ErrorCodes=r={}));class s extends Error{constructor(e,t,i){super(t),this.code=n.number(e)?e:r.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}t.ResponseError=s;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class c{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=c;t.RequestType0=class extends c{constructor(e){super(e,0)}};t.RequestType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.RequestType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.RequestType2=class extends c{constructor(e){super(e,2)}};t.RequestType3=class extends c{constructor(e){super(e,3)}};t.RequestType4=class extends c{constructor(e){super(e,4)}};t.RequestType5=class extends c{constructor(e){super(e,5)}};t.RequestType6=class extends c{constructor(e){super(e,6)}};t.RequestType7=class extends c{constructor(e){super(e,7)}};t.RequestType8=class extends c{constructor(e){super(e,8)}};t.RequestType9=class extends c{constructor(e){super(e,9)}};t.NotificationType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.NotificationType0=class extends c{constructor(e){super(e,0)}};t.NotificationType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};t.NotificationType2=class extends c{constructor(e){super(e,2)}};t.NotificationType3=class extends c{constructor(e){super(e,3)}};t.NotificationType4=class extends c{constructor(e){super(e,4)}};t.NotificationType5=class extends c{constructor(e){super(e,5)}};t.NotificationType6=class extends c{constructor(e){super(e,6)}};t.NotificationType7=class extends c{constructor(e){super(e,7)}};t.NotificationType8=class extends c{constructor(e){super(e,8)}};t.NotificationType9=class extends c{constructor(e){super(e,9)}},function(e){e.isRequest=function(e){const t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))},e.isNotification=function(e){const t=e;return t&&n.string(t.method)&&void 0===e.id},e.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(n.string(t.id)||n.number(t.id)||null===t.id)}}(o||(t.Message=o={}))},2969:function(e,t){"use strict";let i;function n(){if(void 0===i)throw new Error("No runtime abstraction layer installed");return i}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");i=e}}(n||(n={})),t.default=n},16113:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const n=i(2969);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,i)=>{this._waiting.push({thunk:e,resolve:t,reject:i}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,n.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},66564:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=void 0;const n=i(6e3);var r;!function(e){e.Continue=0,e.Cancelled=1}(r||(r={}));t.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=r.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const i=this.buffers.get(t);if(void 0===i)return;const n=new Int32Array(i,0,1);Atomics.store(n,0,r.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class o{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===r.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class s{constructor(e){this.token=new o(e)}cancel(){}dispose(){}}t.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new n.CancellationTokenSource:new s(t)}}},30885:function(e,t,i){"use strict";i.r(t),i.d(t,{EditorAppBase:function(){return Yo},EditorAppClassic:function(){return Xo},EditorAppExtended:function(){return Zo},LanguageClientWrapper:function(){return cs},ModelUpdateType:function(){return Ho},MonacoEditorLanguageClientWrapper:function(){return hs},createUrl:function(){return Uo},evaluateCodeModel:function(){return Jo},evaluateCodeUpdate:function(){return Vo},getEditorUri:function(){return $o},isCodeUpdateRequired:function(){return zo},isEqual:function(){return Go},isModelUpdateRequired:function(){return Bo},verifyUrlOrCreateDataUrl:function(){return Ko}});i(55973),i(17332),i(57743),i(34615),i(23061),i(16355),i(12726),i(21574),i(6281),i(55258),i(4917),i(41265),i(99341),i(62982),i(33685),i(84206),i(77873),i(12185),i(76281),i(50962),i(23588),i(37231),i(45743),i(64398),i(63489),i(36517),i(76341),i(87949),i(76437),i(41231),i(69961),i(72562),i(5532),i(87603),i(9837),i(74844),i(11732),i(30889),i(95109),i(6112),i(76167),i(7253),i(85611),i(96918),i(45354),i(4994),i(96108),i(67430),i(96121),i(87236),i(75448),i(59495),i(77754),i(74900),i(2507),i(87377),i(46261),i(76006),i(65789),i(38948),i(66913),i(20106),i(99685),i(92463),i(74026),i(10693);var n=i(51083),r=i(47638),o=i(50208),s=i(7428),a=i(88023),c=i(42731),u=i(80676),l=i(97713),d=i(20080),h=i(72034),g=i(44335),f=i(84557),p=i(38612),m=i(28277),v=i(27291),y=i(18712),C=i(47391),w=i(17896),S=i(46039),R=i(82416),_=i(9102),b=i(37362),k=i(52716),D=i(73864),T=i(83289),E=i(59348),P=i(40699),O=i(45493),x=i(16725),I=i(27654),M=i(6101),F=i(49452),N=i(10517),A=i(60478),L=i(83101),q=i(44799),W=i(75104),j=i(2820),U=i(66891),K=i(29999),$=i(70532),H=i(84712),z=(i(17126),i(78074)),V=i(32374),B=i(97309),J=i(27667),G=i(52231),Y=i(54316),X=i(14366);(0,u.Z)(".monaco-component.multiDiffEditor{background:var(--vscode-multiDiffEditor-background);height:100%;overflow-y:hidden;position:relative;width:100%;>div{height:100%;left:0;position:absolute;top:0;width:100%;&.placeholder{display:grid;place-content:center;place-items:center;visibility:hidden;&.visible{visibility:visible}}}.active{--vscode-multiDiffEditor-border:var(--vscode-focusBorder)}.multiDiffEntry{display:flex;flex:1;flex-direction:column;overflow:hidden;.collapse-button{cursor:pointer;margin:0 5px;a{display:block}}.header{background:var(--vscode-editor-background);z-index:1000;&:not(.collapsed) .header-content{border-bottom:1px solid var(--vscode-sideBarSectionHeader-border)}.header-content{align-items:center;background:var(--vscode-multiDiffEditor-headerBackground);border-top:1px solid var(--vscode-multiDiffEditor-border);color:var(--vscode-foreground);display:flex;margin:8px 0 0;padding:4px 5px;&.shadow{box-shadow:var(--vscode-scrollbar-shadow) 0 6px 6px -6px}.file-path{display:flex;flex:1;min-width:0;.title{font-size:14px;line-height:22px;&.original{flex:1;min-width:0;text-overflow:ellipsis}}.status{font-weight:600;line-height:22px;margin:0 10px;opacity:.75}}.actions{padding:0 8px}}}.editorParent{border-bottom:1px solid var(--vscode-multiDiffEditor-border);display:flex;flex:1;flex-direction:column;overflow:hidden}.editorContainer{flex:1}}}",{});var Q=i(10333),Z=i(23775),ee=i(70383),te=i(77492),ie=i(28019),ne=i(80195),re=i(67376),oe=i(21931),se=i(80685),ae=i(76808),ce=i(69287),ue=i(12664);class le{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let de=class extends s.JT{constructor(e,t,i,n){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=(0,U.uh)(this,void 0),this._collapsed=(0,K.nK)(this,(e=>this._viewModel.read(e)?.collapsed.read(e))),this._editorContentHeight=(0,U.uh)(this,500),this.contentHeight=(0,K.nK)(this,(e=>(this._collapsed.read(e)?0:this._editorContentHeight.read(e))+this._outerEditorHeight)),this._modifiedContentWidth=(0,U.uh)(this,0),this._modifiedWidth=(0,U.uh)(this,0),this._originalContentWidth=(0,U.uh)(this,0),this._originalWidth=(0,U.uh)(this,0),this.maxScroll=(0,K.nK)(this,(e=>{const t=this._modifiedContentWidth.read(e)-this._modifiedWidth.read(e),i=this._originalContentWidth.read(e)-this._originalWidth.read(e);return t>i?{maxScroll:t,width:this._modifiedWidth.read(e)}:{maxScroll:i,width:this._originalWidth.read(e)}})),this._elements=(0,B.h)("div.multiDiffEntry",[(0,B.h)("div.header@header",[(0,B.h)("div.header-content",[(0,B.h)("div.collapse-button@collapseButton"),(0,B.h)("div.file-path",[(0,B.h)("div.title.modified.show-file-icons@primaryPath",[]),(0,B.h)("div.status.deleted@status",["R"]),(0,B.h)("div.title.original.show-file-icons@secondaryPath",[])]),(0,B.h)("div.actions@actions")])]),(0,B.h)("div.editorParent",[(0,B.h)("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(se.p,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=he(this.editor.getModifiedEditor()),this.isOriginalFocused=he(this.editor.getOriginalEditor()),this.isFocused=(0,K.nK)(this,(e=>this.isModifedFocused.read(e)||this.isOriginalFocused.read(e))),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=new s.SL,this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const r=new re.zx(this._elements.collapseButton,{});this._register((0,$.EH)((e=>{r.element.className="",r.icon=this._collapsed.read(e)?oe.lA.chevronRight:oe.lA.chevronDown}))),this._register(r.onDidClick((()=>{this._viewModel.get()?.collapsed.set(!this._collapsed.get(),void 0)}))),this._register((0,$.EH)((e=>{this._elements.editor.style.display=this._collapsed.read(e)?"none":"block"}))),this._register(this.editor.getModifiedEditor().onDidLayoutChange((e=>{const t=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(t,void 0)}))),this._register(this.editor.getOriginalEditor().onDidLayoutChange((e=>{const t=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(t,void 0)}))),this._register(this.editor.onDidContentSizeChange((e=>{(0,U.Bl)((t=>{this._editorContentHeight.set(e.contentHeight,t),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),t),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),t)}))}))),this._register(this.editor.getOriginalEditor().onDidScrollChange((e=>{if(this._isSettingScrollTop)return;if(!e.scrollTopChanged||!this._data)return;const t=e.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(t)}))),this._register((0,$.EH)((e=>{const t=this._viewModel.read(e)?.isActive.read(e);this._elements.root.classList.toggle("active",t)}))),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._register(this._instantiationService.createInstance(ae.rz,this._elements.actions,N.eH.MultiDiffEditorFileToolbar,{actionRunner:this._register(new ce.D((()=>this._viewModel.get()?.modifiedUri))),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:e=>e.startsWith("navigation")},actionViewItemProvider:(e,t)=>(0,ue.Id)(n,e,t)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){function t(e){return{...e,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}this._data=e;const i=e.viewModel.entry.value;i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange((()=>{this.editor.updateOptions(t(i.options??{}))}))),(0,U.Bl)((n=>{this._resourceLabel?.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:void 0===e.viewModel.modifiedUri});let r=!1,o=!1,s=!1,a="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(a="R",r=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(a="A",s=!0):(a="D",o=!0),this._elements.status.classList.toggle("renamed",r),this._elements.status.classList.toggle("deleted",o),this._elements.status.classList.toggle("added",s),this._elements.status.innerText=a,this._resourceLabel2?.setUri(r?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setModel(e.viewModel.diffEditorViewModel,n),this.editor.updateOptions(t(i.options??{}))}))}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const r=e.length-this._headerHeight,o=Math.max(0,Math.min(n.start-e.start,r));this._elements.header.style.transform=`translateY(${o}px)`,(0,U.Bl)((i=>{this.editor.layout({width:t-16-2,height:e.length-this._outerEditorHeight})}));try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",o>0||i>0),this._elements.header.classList.toggle("collapsed",o===r)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};function he(e){return(0,H.rD)((t=>{const i=new s.SL;return i.add(e.onDidFocusEditorWidget((()=>t(!0)))),i.add(e.onDidBlurEditorWidget((()=>t(!1)))),i}),(()=>e.hasTextFocus()))}de=(0,O.g)([(0,O.f)(3,ie.TG)],de);class ge{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(0===this._unused.size)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find((t=>this._itemData.get(t).getId()===e.getId()))??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var fe=i(67525);let pe=class extends s.JT{constructor(e,t,i,n,r,o){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=r,this._parentInstantiationService=o,this._scrollableElements=(0,B.h)("div.scrollContent",[(0,B.h)("div@content",{style:{overflow:"hidden"}}),(0,B.h)("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new X.Rm({forceIntegerValues:!1,scheduleAtNextAnimationFrame:e=>(0,B.jL)((0,B.Jj)(this._element),e),smoothScrollDuration:100})),this._scrollableElement=this._register(new J.$Z(this._scrollableElements.root,{vertical:X.g_.Auto,horizontal:X.g_.Auto,useShadows:!1},this._scrollable)),this._elements=(0,B.h)("div.monaco-component.multiDiffEditor",{},[(0,B.h)("div",{},[this._scrollableElement.getDomNode()]),(0,B.h)("div.placeholder@placeholder",{},[(0,B.h)("div",[(0,fe.C$)("vs/editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl",0,"No Changed Files")])])]),this._sizeObserver=this._register(new V.DU(this._element,void 0)),this._objectPool=this._register(new ge((e=>{const t=this._instantiationService.createInstance(de,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return t.setData(e),t}))),this.scrollTop=(0,H.rD)(this,this._scrollableElement.onScroll,(()=>this._scrollableElement.getScrollPosition().scrollTop)),this.scrollLeft=(0,H.rD)(this,this._scrollableElement.onScroll,(()=>this._scrollableElement.getScrollPosition().scrollLeft)),this._viewItemsInfo=(0,K.Be)(this,((e,t)=>{const i=this._viewModel.read(e);if(!i)return{items:[],getItem:e=>{throw new Y.he}};const n=i.items.read(e),r=new Map;return{items:n.map((e=>{const i=t.add(new me(e,this._objectPool,this.scrollLeft,(e=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+e})}))),n=this._lastDocStates?.[i.getKey()];return n&&(0,U.PS)((e=>{i.setViewState(n,e)})),r.set(e,i),i})),getItem:e=>r.get(e)}})),this._viewItems=this._viewItemsInfo.map(this,(e=>e.items)),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,((e,t)=>e.reduce(((e,i)=>e+i.contentHeight.read(t)+this._spaceBetweenPx),0))),this.activeControl=(0,K.nK)(this,(e=>{const t=this._viewModel.read(e)?.activeDiffItem.read(e);if(!t)return;const i=this._viewItemsInfo.read(e).getItem(t);return i.template.read(e)?.editor})),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new ne.y([te.i,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(ee.u.inMultiDiffEditor.key,!0),this._register((0,$.gp)(((e,t)=>{const i=this._viewModel.read(e);if(i&&i.contextKeys)for(const[e,n]of Object.entries(i.contextKeys)){const i=this._contextKeyService.createKey(e,void 0);i.set(n),t.add((0,s.OF)((()=>i.reset())))}})));const a=this._parentContextKeyService.createKey(ee.u.multiDiffEditorAllCollapsed.key,!1);this._register((0,$.EH)((e=>{const t=this._viewModel.read(e);if(t){const i=t.items.read(e).every((t=>t.collapsed.read(e)));a.set(i)}}))),this._register((0,$.EH)((e=>{const t=this._dimension.read(e);this._sizeObserver.observe(t)}))),this._register((0,$.EH)((e=>{const t=this._viewItems.read(e);this._elements.placeholder.classList.toggle("visible",0===t.length)}))),this._scrollableElements.content.style.position="relative",this._register((0,$.EH)((e=>{const t=this._sizeObserver.height.read(e);this._scrollableElements.root.style.height=`${t}px`;const i=this._totalHeight.read(e);this._scrollableElements.content.style.height=`${i}px`;const n=this._sizeObserver.width.read(e);let r=n;const o=this._viewItems.read(e),s=(0,G.hV)(o,(0,z.tT)((t=>t.maxScroll.read(e).maxScroll),z.fv));if(s){r=n+s.maxScroll.read(e).maxScroll}this._scrollableElement.setScrollDimensions({width:n,height:t,scrollHeight:i,scrollWidth:r})}))),e.replaceChildren(this._elements.root),this._register((0,s.OF)((()=>{e.replaceChildren()}))),this._register(this._register((0,$.EH)((e=>{(0,U.Bl)((t=>{this.render(e)}))}))))}setScrollState(e){this._scrollableElement.setScrollPosition({scrollLeft:e.left,scrollTop:e.top})}reveal(e,t){const i=this._viewItems.get(),n=i.findIndex((t=>t.viewModel.originalUri?.toString()===e.original?.toString()&&t.viewModel.modifiedUri?.toString()===e.modified?.toString()));if(-1===n)throw new Y.he("Resource not found in diff editor");const r=i[n];this._viewModel.get().activeDiffItem.setCache(r.viewModel,void 0);let o=0;for(let e=0;e<n;e++)o+=i[e].contentHeight.get()+this._spaceBetweenPx;this._scrollableElement.setScrollPosition({scrollTop:o});const s=r.template.get()?.editor,a="original"in e?s?.getOriginalEditor():s?.getModifiedEditor();a&&t?.range&&(a.revealRangeInCenter(t.range),function(e,t){const i=e.getModel(),n=e.createDecorationsCollection([{range:t,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{e.getModel()===i&&n.clear()}),350)}(a,t.range))}getViewState(){return{scrollState:{top:this.scrollTop.get(),left:this.scrollLeft.get()},docStates:Object.fromEntries(this._viewItems.get().map((e=>[e.getKey(),e.getViewState()])))}}setViewState(e){this.setScrollState(e.scrollState),this._lastDocStates=e.docStates,(0,U.PS)((t=>{if(e.docStates)for(const i of this._viewItems.get()){const n=e.docStates[i.getKey()];n&&i.setViewState(n,t)}}))}tryGetCodeEditor(e){const t=this._viewItems.get().find((t=>t.viewModel.diffEditorViewModel.model.modified.uri.toString()===e.toString()||t.viewModel.diffEditorViewModel.model.original.uri.toString()===e.toString())),i=t?.template.get()?.editor;if(i)return t.viewModel.diffEditorViewModel.model.modified.uri.toString()===e.toString()?{diffEditor:i,editor:i.getModifiedEditor()}:{diffEditor:i,editor:i.getOriginalEditor()}}render(e){const t=this.scrollTop.read(e);let i=0,n=0,r=0;const o=this._sizeObserver.height.read(e),s=Q.q.ofStartAndLength(t,o),a=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const u=c.contentHeight.read(e),l=Math.min(u,o),d=Q.q.ofStartAndLength(n,l),h=Q.q.ofStartAndLength(r,u);if(h.isBefore(s))i-=u-l,c.hide();else if(h.isAfter(s))c.hide();else{const e=Math.max(0,Math.min(s.start-h.start,u-l));i-=e;const n=Q.q.ofStartAndLength(t+i,o);c.render(d,e,a,n)}n+=l+this._spaceBetweenPx,r+=u+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};pe=(0,O.g)([(0,O.f)(4,te.i),(0,O.f)(5,ie.TG)],pe);class me extends s.JT{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register((0,U.DN)(this,void 0)),this.contentHeight=(0,K.nK)(this,(e=>this._templateRef.read(e)?.object.contentHeight?.read(e)??this.viewModel.lastTemplateData.read(e).contentHeight)),this.maxScroll=(0,K.nK)(this,(e=>this._templateRef.read(e)?.object.maxScroll.read(e)??{maxScroll:0,scrollWidth:0})),this.template=(0,K.nK)(this,(e=>this._templateRef.read(e)?.object)),this._isHidden=(0,U.uh)(this,!1),this._isFocused=(0,K.nK)(this,(e=>this.template.read(e)?.isFocused.read(e)??!1)),this.viewModel.setIsFocused(this._isFocused,void 0),this._register((0,$.EH)((e=>{const t=this._scrollLeft.read(e);this._templateRef.read(e)?.object.setScrollLeft(t)}))),this._register((0,$.EH)((e=>{const t=this._templateRef.read(e);if(!t)return;if(!this._isHidden.read(e))return;t.object.isFocused.read(e)||this._clear()})))}dispose(){this._clear(),super.dispose()}toString(){return`VirtualViewItem(${this.viewModel.entry.value.modified?.uri.toString()})`}getKey(){return this.viewModel.getKey()}getViewState(){return(0,U.PS)((e=>{this._updateTemplateData(e)})),{collapsed:this.viewModel.collapsed.get(),selections:this.viewModel.lastTemplateData.get().selections}}setViewState(e,t){this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=e.selections?.map(Z.Y.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const r=this._templateRef.get();r&&n&&r.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&(0,U.PS)((t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)}))}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let r=this._templateRef.get();if(!r){r=this._objectPool.getUnusedObj(new le(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(r,void 0);const e=this.viewModel.lastTemplateData.get().selections;e&&r.object.editor.setSelections(e)}r.object.render(e,i,t,n)}}var ve=i(89015),ye=i(44186);i(672),i(80172),i(87703),i(25412),i(7299),i(43866),i(53776),i(25777),i(47721),i(32317);const Ce="vs/editor/browser/widget/multiDiffEditor/colors";(0,ye.P6)("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},(0,fe.C$)(Ce,0,"The background color of the diff editor's header")),(0,ye.P6)("multiDiffEditor.background","editorBackground",(0,fe.C$)(Ce,1,"The background color of the multi file diff editor")),(0,ye.P6)("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},(0,fe.C$)(Ce,2,"The border color of the multi file diff editor"));var we=i(81557);let Se=class extends s.JT{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=(0,U.uh)(this,void 0),this._viewModel=(0,U.uh)(this,void 0),this._widgetImpl=(0,K.Be)(this,((e,t)=>((0,V.NW)(de,e),t.add(this._instantiationService.createInstance((0,V.NW)(pe,e),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory))))),this._activeControl=(0,K.nK)(this,(e=>this._widgetImpl.read(e).activeControl.read(e))),this.onDidChangeActiveControl=we.ju.fromObservableLight(this._activeControl),this._register((0,H.DN)(this._widgetImpl))}reveal(e,t){this._widgetImpl.get().reveal(e,t)}createViewModel(e){return new ve.U(e,this._instantiationService)}setViewModel(e){this._viewModel.set(e,void 0)}layout(e){this._dimension.set(e,void 0)}getActiveControl(){return this._activeControl.get()}getViewState(){return this._widgetImpl.get().getViewState()}setViewState(e){this._widgetImpl.get().setViewState(e)}tryGetCodeEditor(e){return this._widgetImpl.get().tryGetCodeEditor(e)}};Se=(0,O.g)([(0,O.f)(2,ie.TG)],Se);var Re=i(10707),_e=i(3918),be=i(80084),ke=i(89350),De=i(1467),Te=i(47635),Ee=i(82998),Pe=(i(52885),i(91661),i(88001)),Oe=i(8561),xe=(i(4878),i(77264)),Ie=i(47740),Me=i(29275),Fe=i(53976),Ne=i(61312),Ae=i(80165),Le=i(22317),qe=i(40046),We=i(10508),je=i(25393),Ue=i(32181),Ke=i(26713),$e=i(42207);function He(e){const t=e;return class extends t{constructor(...t){super(...t.slice(1),...function(e,t){return e.invokeFunction((e=>ie.I8.getServiceDependencies(t).sort(((e,t)=>e.index-t.index)).map((t=>e.get(t.id)))))}(t[0],e))}}}var ze=i(28898);function Ve(e,t){const i=(0,Te.Kn)(e.editor)?(0,Ee.I8)(e.editor):Object.create(null);return Object.assign(i,(0,Ee.I8)(t)),i}function Be(e,t){const i=Ve(e);if((0,Te.Kn)(e.diffEditor)){const t=(0,Ee.I8)(e.diffEditor);t.diffCodeLens=t.codeLens,delete t.codeLens,t.diffWordWrap=t.wordWrap,delete t.wordWrap,Object.assign(i,t)}return i.accessibilityVerbose=e.accessibility?.verbosity?.diffEditor??!1,Object.assign(i,(0,Ee.I8)(t)),i}function Je(e){let t=class extends e{constructor(e,t={},i,n){const{theme:r,autoDetectHighContrast:o,model:s,value:a,language:c,accessibilityHelpUrl:u,ariaContainerElement:l,overflowWidgetsDomNode:d,dimension:h,...g}=t,f=Ve(n.getValue(t.model?.uri),g);super(i,e,{...f,overflowWidgetsDomNode:d,dimension:h,theme:r,autoDetectHighContrast:o,model:s,value:a,language:c,accessibilityHelpUrl:u,ariaContainerElement:l}),this.textResourceConfigurationService=n,this.optionsOverrides={},this.lastAppliedEditorOptions=f,this.optionsOverrides=g,this._register(n.onDidChangeConfiguration((e=>{const t=this.getModel()?.uri;null!=t&&e.affectsConfiguration(t,"editor")&&this.updateEditorConfiguration()}))),this._register(this.onDidChangeModelLanguage((()=>this.updateEditorConfiguration()))),this._register(this.onDidChangeModel((()=>this.updateEditorConfiguration()))),this.updateEditorConfiguration();const p=i.createChild(new ne.y([te.i,this._contextKeyService])),m=this._register(p.createInstance(qe.f1));this.onDidChangeModel((e=>{m.set(e.newModelUrl)})),m.set(this.getModel()?.uri)}updateEditorConfiguration(){if(!this.hasModel()||null==this.textResourceConfigurationService)return;const e=this.getModel().uri,t=this.textResourceConfigurationService.getValue(e);if(null==t)return;const i=Ve(t,this.optionsOverrides);let n=i;null!=this.lastAppliedEditorOptions&&(n=(0,Ee.EB)(this.lastAppliedEditorOptions,n)),Object.keys(n).length>0&&(this.lastAppliedEditorOptions=i,super.updateOptions(n))}updateOptions(e){this.optionsOverrides??(this.optionsOverrides={});Ie.fz.applyUpdate(this.optionsOverrides,e)&&this.updateEditorConfiguration()}};return t=(0,O.g)([(0,O.f)(2,ie.TG),(0,O.f)(3,De.V)],t),t}const Ge=Je(He(I.gh)),Ye=Je(He(I.Dq));let Xe=class extends(He(I.AF)){constructor(e,t={},i,n){const{theme:r,autoDetectHighContrast:o,modifiedAriaLabel:s,originalAriaLabel:a,overflowWidgetsDomNode:c,dimension:u,...l}=t,d=Be(n.getValue(void 0),l);super(i,e,{...d,overflowWidgetsDomNode:c,dimension:u,theme:r,autoDetectHighContrast:o,modifiedAriaLabel:s,originalAriaLabel:a}),this.textResourceConfigurationService=n,this.optionsOverrides={},this.lastAppliedEditorOptions=d,this.optionsOverrides=l,this._register(n.onDidChangeConfiguration((e=>{const t=this._targetEditor.getModel()?.uri;null!=t&&(e.affectsConfiguration(t,"editor")||e.affectsConfiguration(t,"diffEditor")||e.affectsConfiguration(t,"accessibility.verbosity.diffEditor"))&&this.updateEditorConfiguration()}))),this._register(this._targetEditor.onDidChangeModelLanguage((()=>this.updateEditorConfiguration()))),this._register(this.onDidChangeModel((()=>this.updateEditorConfiguration()))),this.updateEditorConfiguration()}updateEditorConfiguration(){if(null==this.getModel()||null==this.textResourceConfigurationService)return;const e=this._targetEditor.getModel()?.uri,t=this.textResourceConfigurationService.getValue(e);if(null==t)return;const i=Be(t,this.optionsOverrides);let n=i;null!=this.lastAppliedEditorOptions&&(n=(0,Ee.EB)(this.lastAppliedEditorOptions,n)),Object.keys(n).length>0&&(this.lastAppliedEditorOptions=i,super.updateOptions(n))}updateOptions(e){this.optionsOverrides??(this.optionsOverrides={}),this.optionsOverrides={...this.optionsOverrides,...e},this.updateEditorConfiguration()}_createInnerEditor(e,t,i){return e.createInstance(Ge,t,i)}};async function Qe(e,t){const i=await(0,ze.ko)(Le.s);await i.writeFile(e,Fe.KN.fromString(t))}async function Ze(e,t){null!=t&&await Qe(e,t);const i=await(0,ze.ko)(Me.S);return await i.createModelReference(e)}Xe=(0,O.g)([(0,O.f)(2,ie.TG),(0,O.f)(3,De.V)],Xe);let et=class extends M.zC{constructor(e,t,i,n,r,o,s){super(t,i,n,r,o,s),this.delegate=e,this._register(e.registerKeybindingProvider({provideKeybindings:()=>this.getUserKeybindingItems(),onDidChangeKeybindings:this.onDidUpdateKeybindings}))}_getResolver(){return this.delegate._getResolver()}resolveKeyboardEvent(e){return this.delegate.resolveKeyboardEvent(e)}resolveKeybinding(e){return this.delegate.resolveKeybinding(e)}resolveUserBinding(e){return this.delegate.resolveUserBinding(e)}_dumpDebugInfo(){return this.delegate._dumpDebugInfo()}_dumpDebugInfoJSON(){return this.delegate._dumpDebugInfoJSON()}registerSchemaContribution(e){return this.delegate.registerSchemaContribution(e)}enableKeybindingHoldMode(e){return this.delegate.enableKeybindingHoldMode(e)}};et=(0,O.g)([(0,O.f)(1,te.i),(0,O.f)(2,We.H),(0,O.f)(3,je.b),(0,O.f)(4,Ue.l),(0,O.f)(5,Ke.V),(0,O.f)(6,h.$)],et);let tt=null;function it(e){if(null==tt){const t=new ne.y;t.set($e.e,new Ae.M(Ne.E8,[],!0));const i=e.get(q.d);i instanceof M.zC||!function(e){return null!=e.registerKeybindingProvider}(i)||t.set(q.d,new Ae.M(et,[i],!0)),tt=e.get(ie.TG).createChild(t)}return tt}Oe.I,xe.IP;var nt,rt;function ot(e){return!function(e){return Array.isArray(e)}(e)}function st(e){return"string"==typeof e}function at(e){return!st(e)}function ct(e){return!e}function ut(e,t){return e.ignoreCase&&t?t.toLowerCase():t}function lt(e){return e.replace(/[&<>'"_]/g,"-")}function dt(e,t){return new Error(`${e.languageId}: ${t}`)}function ht(e,t,i,n,r){let o=null;return t.replace(/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g,(function(t,s,a,c,u,l,d,h,g){return ct(a)?ct(c)?!ct(u)&&u<n.length?ut(e,n[u]):!ct(d)&&e&&"string"==typeof e[d]?e[d]:(null===o&&(o=r.split("."),o.unshift(r)),!ct(l)&&l<o.length?ut(e,o[l]):""):ut(e,i):"$"}))}function gt(e,t){let i=t;for(;i&&i.length>0;){const t=e.tokenizer[i];if(t)return t;const n=i.lastIndexOf(".");i=n<0?null:i.substr(0,n)}return null}(0,u.Z)('.monaco-editor.standalone{--monaco-monospace-font:"SF Mono",Monaco,Menlo,Consolas,"Ubuntu Mono","Liberation Mono","DejaVu Sans Mono","Courier New",monospace;font-family:-apple-system,BlinkMacSystemFont,Segoe WPC,Segoe UI,HelveticaNeue-Light,system-ui,Ubuntu,Droid Sans,sans-serif}.monaco-editor.standalone.hc-black .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label,.monaco-editor.standalone.hc-light .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label,.monaco-editor.standalone.vs-dark .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label,.monaco-menu .monaco-action-bar.vertical .action-item .action-menu-item:focus .action-label{stroke-width:1.2px}.monaco-hover p{margin:0}.monaco-aria-container{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute!important;top:0;width:1px}.monaco-diff-editor.standalone .synthetic-focus,.monaco-diff-editor.standalone [tabindex="-1"]:focus,.monaco-diff-editor.standalone [tabindex="0"]:focus,.monaco-diff-editor.standalone button:focus,.monaco-diff-editor.standalone input[type=button]:focus,.monaco-diff-editor.standalone input[type=checkbox]:focus,.monaco-diff-editor.standalone input[type=search]:focus,.monaco-diff-editor.standalone input[type=text]:focus,.monaco-diff-editor.standalone select:focus,.monaco-diff-editor.standalone textarea:focus,.monaco-editor.standalone .synthetic-focus,.monaco-editor.standalone [tabindex="-1"]:focus,.monaco-editor.standalone [tabindex="0"]:focus,.monaco-editor.standalone button:focus,.monaco-editor.standalone input[type=button]:focus,.monaco-editor.standalone input[type=checkbox]:focus,.monaco-editor.standalone input[type=search]:focus,.monaco-editor.standalone input[type=text]:focus,.monaco-editor.standalone select:focus,.monaco-editor.standalone textarea:focus{opacity:1;outline-color:var(--vscode-focusBorder);outline-offset:-1px;outline-style:solid;outline-width:1px}',{}),function(e){e[e.None=0]="None",e[e.Open=1]="Open",e[e.Close=-1]="Close"}(nt||(nt={}));class ft{static{this._INSTANCE=new ft(5)}static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(null!==e&&e.depth>=this._maxCacheDepth)return new pt(e,t);let i=pt.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new pt(e,t),this._entries[i]=n,n)}}class pt{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;null!==e;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;null!==e&&null!==t;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return null===e&&null===t}equals(e){return pt._equals(this,e)}push(e){return ft.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return ft.create(this.parent,e)}}class mt{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new mt(this.languageId,this.state)}}class vt{static{this._INSTANCE=new vt(5)}static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(null!==t)return new yt(e,t);if(null!==e&&e.depth>=this._maxCacheDepth)return new yt(e,t);const i=pt.getStackElementId(e);let n=this._entries[i];return n||(n=new yt(e,null),this._entries[i]=n,n)}}class yt{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:vt.create(this.stack,this.embeddedLanguageData)}equals(e){return e instanceof yt&&(!!this.stack.equals(e.stack)&&(null===this.embeddedLanguageData&&null===e.embeddedLanguageData||null!==this.embeddedLanguageData&&null!==e.embeddedLanguageData&&this.embeddedLanguageData.equals(e.embeddedLanguageData)))}}class Ct{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new v.WU(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,s=v.RW.get(r);if(!s)return this.enterLanguage(r),this.emit(n,""),o;const a=s.tokenize(e,t,o);if(0!==n)for(const e of a.tokens)this._tokens.push(new v.WU(e.offset+n,e.type,e.language));else this._tokens=this._tokens.concat(a.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,a.endState}finalize(e){return new v.hG(this._tokens,e)}}class wt{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=D.bC.Null,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|D.E6.BALANCED_BRACKETS_MASK;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=null!==e?e.length:0,r=t.length,o=null!==i?i.length:0;if(0===n&&0===r&&0===o)return new Uint32Array(0);if(0===n&&0===r)return i;if(0===r&&0===o)return e;const s=new Uint32Array(n+r+o);null!==e&&s.set(e);for(let e=0;e<r;e++)s[n+e]=t[e];return null!==i&&s.set(i,n+r),s}nestedLanguageTokenize(e,t,i,n){const r=i.languageId,o=i.state,s=v.RW.get(r);if(!s)return this.enterLanguage(r),this.emit(n,""),o;const a=s.tokenizeEncoded(e,t,o);if(0!==n)for(let e=0,t=a.tokens.length;e<t;e+=2)a.tokens[e]+=n;return this._prependTokens=wt._merge(this._prependTokens,this._tokens,a.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,a.endState}finalize(e){return new v.DI(wt._merge(this._prependTokens,this._tokens,null),e)}}let St=rt=class extends s.JT{constructor(e,t,i,n,r){super(),this._configurationService=r,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._register(v.RW.onDidChange((e=>{if(o)return;let t=!1;for(let i=0,n=e.changedLanguages.length;i<n;i++){const n=e.changedLanguages[i];if(this._embeddedLanguages[n]){t=!0;break}}t&&(o=!0,v.RW.handleChange([this._languageId]),o=!1)}))),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))})))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=v.RW.get(t);if(i){if(i instanceof rt){const t=i.getLoadStatus();!1===t.loaded&&e.push(t.promise)}}else v.RW.isResolved(t)||e.push(v.RW.getOrCreate(t))}return 0===e.length?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then((e=>{}))}}getInitialState(){const e=ft.create(null,this._lexer.start);return vt.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return(0,S.Ri)(this._languageId,i);const n=new Ct,r=this._tokenize(e,t,i,n);return n.finalize(r)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return(0,S.Dy)(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new wt(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),r=this._tokenize(e,t,i,n);return n.finalize(r)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=gt(this._lexer,t.stack.state),!i))throw dt(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,r=!1;for(const o of i){if(!at(o.action)||"@pop"!==o.action.nextEmbedded)continue;r=!0;let i=o.resolveRegex(t.stack.state);const s=i.source;if("^(?:"===s.substr(0,4)&&")"===s.substr(s.length-1,1)){const e=(i.ignoreCase?"i":"")+(i.unicode?"u":"");i=new RegExp(s.substr(4,s.length-5),e)}const a=e.search(i);-1===a||0!==a&&o.matchOnlyAtLineStart||(-1===n||a<n)&&(n=a)}if(!r)throw dt(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,r){const o=this._findLeavingNestedLanguageOffset(e,i);if(-1===o){const o=r.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return vt.create(i.stack,new mt(i.embeddedLanguageData.languageId,o))}const s=e.substring(0,o);s.length>0&&r.nestedLanguageTokenize(s,!1,i.embeddedLanguageData,n);const a=e.substring(o);return this._myTokenize(a,t,i,n+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,r){r.enterLanguage(this._languageId);const o=e.length,s=t&&this._lexer.includeLF?e+"\n":e,a=s.length;let c=i.embeddedLanguageData,u=i.stack,l=0,d=null,h=!0;for(;h||l<a;){const i=l,p=u.depth,m=d?d.groups.length:0,v=u.state;let y=null,C=null,w=null,S=null,R=null;if(d){y=d.matches;const e=d.groups.shift();C=e.matched,w=e.action,S=d.rule,0===d.groups.length&&(d=null)}else{if(!h&&l>=a)break;h=!1;let e=this._lexer.tokenizer[v];if(!e&&(e=gt(this._lexer,v),!e))throw dt(this._lexer,"tokenizer state is not defined: "+v);const t=s.substr(l);for(const i of e)if((0===l||!i.matchOnlyAtLineStart)&&(y=t.match(i.resolveRegex(v)),y)){C=y[0],w=i.action;break}}if(y||(y=[""],C=""),w||(l<a&&(y=[s.charAt(l)],C=y[0]),w=this._lexer.defaultToken),null===C)break;for(l+=C.length;ot(w)&&at(w)&&w.test;)w=w.test(C,y,v,l===a);let _=null;if("string"==typeof w||Array.isArray(w))_=w;else if(w.group)_=w.group;else if(null!==w.token&&void 0!==w.token){if(_=w.tokenSubst?ht(this._lexer,w.token,C,y,v):w.token,w.nextEmbedded)if("@pop"===w.nextEmbedded){if(!c)throw dt(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw dt(this._lexer,"cannot enter embedded language from within an embedded language");R=ht(this._lexer,w.nextEmbedded,C,y,v)}if(w.goBack&&(l=Math.max(0,l-w.goBack)),w.switchTo&&"string"==typeof w.switchTo){let e=ht(this._lexer,w.switchTo,C,y,v);if("@"===e[0]&&(e=e.substr(1)),!gt(this._lexer,e))throw dt(this._lexer,"trying to switch to a state '"+e+"' that is undefined in rule: "+this._safeRuleName(S));u=u.switchTo(e)}else{if(w.transform&&"function"==typeof w.transform)throw dt(this._lexer,"action.transform not supported");if(w.next)if("@push"===w.next){if(u.depth>=this._lexer.maxStack)throw dt(this._lexer,"maximum tokenizer stack size reached: ["+u.state+","+u.parent.state+",...]");u=u.push(v)}else if("@pop"===w.next){if(u.depth<=1)throw dt(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(S));u=u.pop()}else if("@popall"===w.next)u=u.popall();else{let e=ht(this._lexer,w.next,C,y,v);if("@"===e[0]&&(e=e.substr(1)),!gt(this._lexer,e))throw dt(this._lexer,"trying to set a next state '"+e+"' that is undefined in rule: "+this._safeRuleName(S));u=u.push(e)}}w.log&&"string"==typeof w.log&&(g=this._lexer,f=this._lexer.languageId+": "+ht(this._lexer,w.log,C,y,v),console.log(`${g.languageId}: ${f}`))}if(null===_)throw dt(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(S));const b=i=>{const o=this._languageService.getLanguageIdByLanguageName(i)||this._languageService.getLanguageIdByMimeType(i)||i,s=this._getNestedEmbeddedLanguageData(o);if(l<a){const i=e.substr(l);return this._nestedTokenize(i,t,vt.create(u,s),n+l,r)}return vt.create(u,s)};if(Array.isArray(_)){if(d&&d.groups.length>0)throw dt(this._lexer,"groups cannot be nested: "+this._safeRuleName(S));if(y.length!==_.length+1)throw dt(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(S));let e=0;for(let t=1;t<y.length;t++)e+=y[t].length;if(e!==C.length)throw dt(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(S));d={rule:S,matches:y,groups:[]};for(let e=0;e<_.length;e++)d.groups[e]={action:_[e],matched:y[e+1]};l-=C.length}else{{if("@rematch"===_&&(l-=C.length,C="",y=null,_="",null!==R))return b(R);if(0===C.length){if(0===a||p!==u.depth||v!==u.state||(d?d.groups.length:0)!==m)continue;throw dt(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(S))}let e=null;if(st(_)&&0===_.indexOf("@brackets")){const t=_.substr(9),i=Rt(this._lexer,C);if(!i)throw dt(this._lexer,"@brackets token returned but no bracket defined as: "+C);e=lt(i.token+t)}else{e=lt(""===_?"":_+this._lexer.tokenPostfix)}i<o&&r.emit(i+n,e)}if(null!==R)return b(R)}}var g,f;return vt.create(u,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new mt(e,S.TJ);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),v.RW.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=v.RW.get(e);return new mt(e,t?t.getInitialState():S.TJ)}};function Rt(e,t){if(!t)return null;t=ut(e,t);const i=e.brackets;for(const e of i){if(e.open===t)return{token:e.token,bracketType:nt.Open};if(e.close===t)return{token:e.token,bracketType:nt.Close}}return null}St=rt=(0,O.g)([(0,O.f)(4,x.U)],St);const _t=(0,k.Z)("standaloneColorizer",{createHTML:e=>e});class bt{static colorizeElement(e,t,i,n){const r=(n=n||{}).theme||"vs",o=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const s=t.getLanguageIdByMimeType(o)||o;e.setTheme(r);const a=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+r;return this.colorize(t,a||"",s,n).then((e=>{const t=_t?.createHTML(e)??e;i.innerHTML=t}),(e=>console.error(e)))}static async colorize(e,t,i,n){const r=e.languageIdCodec;let o=4;n&&"number"==typeof n.tabSize&&(o=n.tabSize),(0,a.uS)(t)&&(t=t.substr(1));const s=(0,a.uq)(t);if(!e.isRegisteredLanguageId(i))return kt(s,o,r);const c=await v.RW.getOrCreate(i);return c?function(e,t,i,n){return new Promise(((r,o)=>{const s=()=>{const a=function(e,t,i,n){let r=[],o=i.getInitialState();for(let s=0,a=e.length;s<a;s++){const a=e[s],c=i.tokenizeEncoded(a,!0,o);T.A.convertToEndOffset(c.tokens,a.length);const u=new T.A(c.tokens,a,n),l=P.wA.isBasicASCII(a,!0),d=P.wA.containsRTL(a,l,!0),h=(0,E.tF)(new E.IJ(!1,!0,a,!1,l,d,0,u.inflate(),[],t,0,0,0,0,-1,"none",!1,!1,null));r=r.concat(h.html),r.push("<br/>"),o=c.endState}return r.join("")}(e,t,i,n);if(i instanceof St){const e=i.getLoadStatus();if(!1===e.loaded)return void e.promise.then(s,o)}r(a)};s()}))}(s,o,c,r):kt(s,o,r)}static colorizeLine(e,t,i,n,r=4){const o=P.wA.isBasicASCII(e,t),s=P.wA.containsRTL(e,o,i);return(0,E.tF)(new E.IJ(!1,!0,e,!1,o,s,0,n,[],r,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const r=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),r,i)}}function kt(e,t,i){let n=[];const r=(D.Hd.None<<D.E6.FONT_STYLE_OFFSET|D.$.DefaultForeground<<D.E6.FOREGROUND_OFFSET|D.$.DefaultBackground<<D.E6.BACKGROUND_OFFSET)>>>0,o=new Uint32Array(2);o[0]=0,o[1]=r;for(let r=0,s=e.length;r<s;r++){const s=e[r];o[0]=s.length;const a=new T.A(o,s,i),c=P.wA.isBasicASCII(s,!0),u=P.wA.containsRTL(s,c,!0),l=(0,E.tF)(new E.IJ(!1,!0,s,!1,c,u,0,a,[],t,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(l.html),n.push("<br/>")}return n.join("")}function Dt(e,t,i){return M.IO.initialize(i||{}).createInstance(I.Dq,e,t)}function Tt(e){return M.IO.get(h.$).onCodeEditorAdd((t=>{e(t)}))}function Et(e){return M.IO.get(h.$).onDiffEditorAdd((t=>{e(t)}))}function Pt(){return M.IO.get(h.$).listCodeEditors()}function Ot(){return M.IO.get(h.$).listDiffEditors()}function xt(e,t,i){return M.IO.initialize(i||{}).createInstance(I.AF,e,t)}function It(e,t){const i=M.IO.initialize(t||{});return new Se(e,{},i)}function Mt(e){if("string"!=typeof e.id||"function"!=typeof e.run)throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return A.P.registerCommand(e.id,e.run)}function Ft(e){if("string"!=typeof e.id||"string"!=typeof e.label||"function"!=typeof e.run)throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const t=L.Ao.deserialize(e.precondition),i=new s.SL;if(i.add(A.P.registerCommand(e.id,((i,...n)=>d._l.runEditorCommand(i,n,t,((t,i,n)=>Promise.resolve(e.run(i,...n))))))),e.contextMenuGroupId){const n={command:{id:e.id,title:e.label},when:t,group:e.contextMenuGroupId,order:e.contextMenuOrder||0};i.add(N.BH.appendMenuItem(N.eH.EditorContext,n))}if(Array.isArray(e.keybindings)){const n=M.IO.get(q.d);if(n instanceof M.zC){const r=L.Ao.and(t,L.Ao.deserialize(e.keybindingContext));i.add(n.addDynamicKeybindings(e.keybindings.map((t=>({keybinding:t,command:e.id,when:r})))))}else console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService")}return i}function Nt(e){return At([e])}function At(e){const t=M.IO.get(q.d);return t instanceof M.zC?t.addDynamicKeybindings(e.map((e=>({keybinding:e.keybinding,command:e.command,commandArgs:e.commandArgs,when:L.Ao.deserialize(e.when)})))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),s.JT.None)}function Lt(e,t,i){const n=M.IO.get(y.O),r=n.getLanguageIdByMimeType(t)||t;return(0,I.eR)(M.IO.get(_.q),n,e,r,i)}function qt(e,t){const i=M.IO.get(y.O),n=i.getLanguageIdByMimeType(t)||t||w.bd;e.setLanguage(i.createById(n))}function Wt(e,t,i){if(e){M.IO.get(W.l).changeOne(t,e.uri,i)}}function jt(e){M.IO.get(W.l).changeAll(e,[])}function Ut(e){return M.IO.get(W.l).read(e)}function Kt(e){return M.IO.get(W.l).onMarkerChanged(e)}function $t(e){return M.IO.get(_.q).getModel(e)}function Ht(){return M.IO.get(_.q).getModels()}function zt(e){return M.IO.get(_.q).onModelAdded(e)}function Vt(e){return M.IO.get(_.q).onModelRemoved(e)}function Bt(e){return M.IO.get(_.q).onModelLanguageChanged((t=>{e({model:t.model,oldLanguage:t.oldLanguageId})}))}function Jt(e){return(0,g.j)(M.IO.get(_.q),M.IO.get(C.c_),e)}function Gt(e,t){const i=M.IO.get(y.O),n=M.IO.get(F.Z);return bt.colorizeElement(n,i,e,t).then((()=>{n.registerEditorContainer(e)}))}function Yt(e,t,i){const n=M.IO.get(y.O);return M.IO.get(F.Z).registerEditorContainer(o.Ex.document.body),bt.colorize(n,e,t,i)}function Xt(e,t,i=4){return M.IO.get(F.Z).registerEditorContainer(o.Ex.document.body),bt.colorizeModelLine(e,t,i)}function Qt(e,t){v.RW.getOrCreate(t);const i=function(e){const t=v.RW.get(e);return t||{getInitialState:()=>S.TJ,tokenize:(t,i,n)=>(0,S.Ri)(e,n)}}(t),n=(0,a.uq)(e),r=[];let o=i.getInitialState();for(let e=0,t=n.length;e<t;e++){const t=n[e],s=i.tokenize(t,!0,o);r[e]=s.tokens,o=s.endState}return r}function Zt(e,t){M.IO.get(F.Z).defineTheme(e,t)}function ei(e){M.IO.get(F.Z).setTheme(e)}function ti(){l.g.clearAllFontInfos()}function ii(e,t){return A.P.registerCommand({id:e,handler:t})}function ni(e){return M.IO.get(j.v).registerOpener({async open(t){return"string"==typeof t&&(t=c.ov.parse(t)),e.open(t)}})}function ri(e){return M.IO.get(h.$).registerCodeEditorOpenHandler((async(t,i,n)=>{if(!i)return null;const r=t.options?.selection;let o;return r&&"number"==typeof r.endLineNumber&&"number"==typeof r.endColumn?o=r:r&&(o={lineNumber:r.startLineNumber,column:r.startColumn}),await e.openCodeEditor(i,t.resource,o)?i:null}))}function oi(e,t){return"boolean"==typeof e?e:t}function si(e,t){return"string"==typeof e?e:t}function ai(e,t=!1){t&&(e=e.map((function(e){return e.toLowerCase()})));const i=function(e){const t={};for(const i of e)t[i]=!0;return t}(e);return t?function(e){return void 0!==i[e.toLowerCase()]&&i.hasOwnProperty(e.toLowerCase())}:function(e){return void 0!==i[e]&&i.hasOwnProperty(e)}}function ci(e,t,i){t=t.replace(/@@/g,"");let n,r=0;do{n=!1,t=t.replace(/@(\w+)/g,(function(i,r){n=!0;let o="";if("string"==typeof e[r])o=e[r];else{if(!(e[r]&&e[r]instanceof RegExp))throw void 0===e[r]?dt(e,"language definition does not contain attribute '"+r+"', used at: "+t):dt(e,"attribute reference '"+r+"' must be a string, used at: "+t);o=e[r].source}return ct(o)?"":"(?:"+o+")"})),r++}while(n&&r<5);t=t.replace(/\x01/g,"@");const o=(e.ignoreCase?"i":"")+(e.unicode?"u":"");if(i){if(t.match(/\$[sS](\d\d?)/g)){let i=null,n=null;return r=>(n&&i===r||(i=r,n=new RegExp(function(e,t,i){let n=null;return t.replace(/\$[sS](\d\d?)/g,(function(t,r){return null===n&&(n=i.split("."),n.unshift(i)),!ct(r)&&r<n.length?ut(e,n[r]):""}))}(e,t,r),o)),n)}}return new RegExp(t,o)}function ui(e,t,i,n){let r=-1,o=i,s=i.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);s&&(s[3]&&(r=parseInt(s[3]),s[2]&&(r+=100)),o=s[4]);let a,c="~",u=o;if(o&&0!==o.length?/^\w*$/.test(u)?c="==":(s=o.match(/^(@|!@|~|!~|==|!=)(.*)$/),s&&(c=s[1],u=s[2])):(c="!=",u=""),"~"!==c&&"!~"!==c||!/^(\w|\|)*$/.test(u))if("@"===c||"!@"===c){const i=e[u];if(!i)throw dt(e,"the @ match target '"+u+"' is not defined, in rule: "+t);if(!function(e,t){if(!t)return!1;if(!Array.isArray(t))return!1;for(const i of t)if(!e(i))return!1;return!0}((function(e){return"string"==typeof e}),i))throw dt(e,"the @ match target '"+u+"' must be an array of strings, in rule: "+t);const n=ai(i,e.ignoreCase);a=function(e){return"@"===c?n(e):!n(e)}}else if("~"===c||"!~"===c)if(u.indexOf("$")<0){const t=ci(e,"^"+u+"$",!1);a=function(e){return"~"===c?t.test(e):!t.test(e)}}else a=function(t,i,n,r){return ci(e,"^"+ht(e,u,i,n,r)+"$",!1).test(t)};else if(u.indexOf("$")<0){const t=ut(e,u);a=function(e){return"=="===c?e===t:e!==t}}else{const t=ut(e,u);a=function(i,n,r,o,s){const a=ht(e,t,n,r,o);return"=="===c?i===a:i!==a}}else{const t=ai(u.split("|"),e.ignoreCase);a=function(e){return"~"===c?t(e):!t(e)}}return-1===r?{name:i,value:n,test:function(e,t,i,n){return a(e,e,t,i,n)}}:{name:i,value:n,test:function(e,t,i,n){const o=function(e,t,i,n){if(n<0)return e;if(n<t.length)return t[n];if(n>=100){n-=100;const e=i.split(".");if(e.unshift(i),n<e.length)return e[n]}return null}(e,t,i,r);return a(o||"",e,t,i,n)}}}function li(e,t,i){if(i){if("string"==typeof i)return i;if(i.token||""===i.token){if("string"!=typeof i.token)throw dt(e,"a 'token' attribute must be of type string, in rule: "+t);{const n={token:i.token};if(i.token.indexOf("$")>=0&&(n.tokenSubst=!0),"string"==typeof i.bracket)if("@open"===i.bracket)n.bracket=nt.Open;else{if("@close"!==i.bracket)throw dt(e,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+t);n.bracket=nt.Close}if(i.next){if("string"!=typeof i.next)throw dt(e,"the next state must be a string value in rule: "+t);{let r=i.next;if(!/^(@pop|@push|@popall)$/.test(r)&&("@"===r[0]&&(r=r.substr(1)),r.indexOf("$")<0&&!function(e,t){let i=t;for(;i&&i.length>0;){if(e.stateNames[i])return!0;const t=i.lastIndexOf(".");i=t<0?null:i.substr(0,t)}return!1}(e,ht(e,r,"",[],""))))throw dt(e,"the next state '"+i.next+"' is not defined in rule: "+t);n.next=r}}return"number"==typeof i.goBack&&(n.goBack=i.goBack),"string"==typeof i.switchTo&&(n.switchTo=i.switchTo),"string"==typeof i.log&&(n.log=i.log),"string"==typeof i.nextEmbedded&&(n.nextEmbedded=i.nextEmbedded,e.usesEmbedded=!0),n}}if(Array.isArray(i)){const n=[];for(let r=0,o=i.length;r<o;r++)n[r]=li(e,t,i[r]);return{group:n}}if(i.cases){const n=[];for(const r in i.cases)if(i.cases.hasOwnProperty(r)){const o=li(e,t,i.cases[r]);"@default"===r||"@"===r||""===r?n.push({test:void 0,value:o,name:r}):"@eos"===r?n.push({test:function(e,t,i,n){return n},value:o,name:r}):n.push(ui(e,t,r,o))}const r=e.defaultToken;return{test:function(e,t,i,o){for(const r of n){if(!r.test||r.test(e,t,i,o))return r.value}return r}}}throw dt(e,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+t)}return{token:""}}class di{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if("string"==typeof t)i=t;else{if(!(t instanceof RegExp))throw dt(e,"rules must start with a match string or regular expression: "+this.name);i=t.source}this.matchOnlyAtLineStart=i.length>0&&"^"===i[0],this.name=this.name+": "+i,this.regex=ci(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=li(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function hi(e,t){if(!t||"object"!=typeof t)throw new Error("Monarch: expecting a language definition object");const i={languageId:e,includeLF:oi(t.includeLF,!1),noThrow:!1,maxStack:100,start:"string"==typeof t.start?t.start:null,ignoreCase:oi(t.ignoreCase,!1),unicode:oi(t.unicode,!1),tokenPostfix:si(t.tokenPostfix,"."+e),defaultToken:si(t.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},n=t;function r(e,o,s){for(const a of s){let s=a.include;if(s){if("string"!=typeof s)throw dt(i,"an 'include' attribute must be a string at: "+e);if("@"===s[0]&&(s=s.substr(1)),!t.tokenizer[s])throw dt(i,"include target '"+s+"' is not defined at: "+e);r(e+"."+s,o,t.tokenizer[s])}else{const t=new di(e);if(Array.isArray(a)&&a.length>=1&&a.length<=3)if(t.setRegex(n,a[0]),a.length>=3)if("string"==typeof a[1])t.setAction(n,{token:a[1],next:a[2]});else{if("object"!=typeof a[1])throw dt(i,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+e);{const e=a[1];e.next=a[2],t.setAction(n,e)}}else t.setAction(n,a[1]);else{if(!a.regex)throw dt(i,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+e);a.name&&"string"==typeof a.name&&(t.name=a.name),a.matchOnlyAtStart&&(t.matchOnlyAtLineStart=oi(a.matchOnlyAtLineStart,!1)),t.setRegex(n,a.regex),t.setAction(n,a.action)}o.push(t)}}}if(n.languageId=e,n.includeLF=i.includeLF,n.ignoreCase=i.ignoreCase,n.unicode=i.unicode,n.noThrow=i.noThrow,n.usesEmbedded=i.usesEmbedded,n.stateNames=t.tokenizer,n.defaultToken=i.defaultToken,!t.tokenizer||"object"!=typeof t.tokenizer)throw dt(i,"a language definition must define the 'tokenizer' attribute as an object");i.tokenizer=[];for(const e in t.tokenizer)if(t.tokenizer.hasOwnProperty(e)){i.start||(i.start=e);const n=t.tokenizer[e];i.tokenizer[e]=new Array,r("tokenizer."+e,i.tokenizer[e],n)}if(i.usesEmbedded=n.usesEmbedded,t.brackets){if(!Array.isArray(t.brackets))throw dt(i,"the 'brackets' attribute must be defined as an array")}else t.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const o=[];for(const e of t.brackets){let t=e;if(t&&Array.isArray(t)&&3===t.length&&(t={token:t[2],open:t[0],close:t[1]}),t.open===t.close)throw dt(i,"open and close brackets in a 'brackets' attribute must be different: "+t.open+"\n hint: use the 'bracket' attribute if matching on equal brackets is required.");if("string"!=typeof t.open||"string"!=typeof t.token||"string"!=typeof t.close)throw dt(i,"every element in the 'brackets' array must be a '{open,close,token}' object or array");o.push({token:t.token+i.tokenPostfix,open:ut(i,t.open),close:ut(i,t.close)})}return i.brackets=o,i.noThrow=!0,i}function gi(e){w.dQ.registerLanguage(e)}function fi(){let e=[];return e=e.concat(w.dQ.getLanguages()),e}function pi(e){return M.IO.get(y.O).languageIdCodec.encodeLanguageId(e)}function mi(e,t){return M.IO.withServices((()=>{const i=M.IO.get(y.O).onDidRequestRichLanguageFeatures((n=>{n===e&&(i.dispose(),t())}));return i}))}function vi(e,t){return M.IO.withServices((()=>{const i=M.IO.get(y.O).onDidRequestBasicLanguageFeatures((n=>{n===e&&(i.dispose(),t())}));return i}))}function yi(e,t){if(!M.IO.get(y.O).isRegisteredLanguageId(e))throw new Error(`Cannot set configuration for unknown language ${e}`);return M.IO.get(C.c_).register(e,t,100)}class Ci{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if("function"==typeof this._actual.tokenize)return wi.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new v.DI(n.tokens,n.endState)}}class wi{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let r=0,o=e.length;r<o;r++){const o=e[r];let s=o.startIndex;0===r?s=0:s<n&&(s=n),i[r]=new v.WU(s,o.scopes,t),n=s}return i}static adaptTokenize(e,t,i,n){const r=t.tokenize(i,n),o=wi._toClassicTokens(r.tokens,e);let s;return s=r.endState.equals(n)?n:r.endState,new v.hG(o,s)}tokenize(e,t,i){return wi.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,r=[];let o=0,s=0;for(let e=0,a=t.length;e<a;e++){const a=t[e],c=n.match(i,a.scopes)|D.E6.BALANCED_BRACKETS_MASK;if(o>0&&r[o-1]===c)continue;let u=a.startIndex;0===e?u=0:u<s&&(u=s),r[o++]=u,r[o++]=c,s=u}const a=new Uint32Array(o);for(let e=0;e<o;e++)a[e]=r[e];return a}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),r=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let o;return o=n.endState.equals(i)?i:n.endState,new v.DI(r,o)}}function Si(e){return e&&"function"==typeof e.then}function Ri(e){const t=M.IO.get(F.Z);if(e){const i=[null];for(let t=1,n=e.length;t<n;t++)i[t]=Re.Il.fromHex(e[t]);t.setColorMapOverride(i)}else t.setColorMapOverride(null)}function _i(e,t){return function(e){return"tokenizeEncoded"in e}(t)?new Ci(e,t):new wi(e,t,M.IO.get(y.O),M.IO.get(F.Z))}function bi(e,t){const i=new v.MO((async()=>{const i=await Promise.resolve(t.create());return i?"function"==typeof i.getInitialState?_i(e,i):new St(M.IO.get(y.O),M.IO.get(F.Z),e,hi(e,i),M.IO.get(x.U)):null}));return v.RW.registerFactory(e,i)}function ki(e,t){if(!M.IO.get(y.O).isRegisteredLanguageId(e))throw new Error(`Cannot set tokens provider for unknown language ${e}`);return Si(t)?bi(e,{create:()=>t}):v.RW.register(e,_i(e,t))}function Di(e,t){return Si(t)?bi(e,{create:()=>t}):v.RW.register(e,(t=>new St(M.IO.get(y.O),M.IO.get(F.Z),e,hi(e,t),M.IO.get(x.U)))(t))}function Ti(e,t){return M.IO.get(be.p).referenceProvider.register(e,t)}function Ei(e,t){return M.IO.get(be.p).renameProvider.register(e,t)}function Pi(e,t){return M.IO.get(be.p).newSymbolNamesProvider.register(e,t)}function Oi(e,t){return M.IO.get(be.p).signatureHelpProvider.register(e,t)}function xi(e,t){return M.IO.get(be.p).hoverProvider.register(e,{provideHover:async(e,i,n,r)=>{const o=e.getWordAtPosition(i);return Promise.resolve(t.provideHover(e,i,n,r)).then((e=>{if(e)return!e.range&&o&&(e.range=new _e.e(i.lineNumber,o.startColumn,i.lineNumber,o.endColumn)),e.range||(e.range=new _e.e(i.lineNumber,i.column,i.lineNumber,i.column)),e}))}})}function Ii(e,t){return M.IO.get(be.p).documentSymbolProvider.register(e,t)}function Mi(e,t){return M.IO.get(be.p).documentHighlightProvider.register(e,t)}function Fi(e,t){return M.IO.get(be.p).linkedEditingRangeProvider.register(e,t)}function Ni(e,t){return M.IO.get(be.p).definitionProvider.register(e,t)}function Ai(e,t){return M.IO.get(be.p).implementationProvider.register(e,t)}function Li(e,t){return M.IO.get(be.p).typeDefinitionProvider.register(e,t)}function qi(e,t){return M.IO.get(be.p).codeLensProvider.register(e,t)}function Wi(e,t,i){return M.IO.get(be.p).codeActionProvider.register(e,{providedCodeActionKinds:i?.providedCodeActionKinds,documentation:i?.documentation,provideCodeActions:(e,i,n,r)=>{const o=M.IO.get(W.l).read({resource:e.uri}).filter((e=>_e.e.areIntersectingOrTouching(e,i)));return t.provideCodeActions(e,i,{markers:o,only:n.only,trigger:n.trigger},r)},resolveCodeAction:t.resolveCodeAction})}function ji(e,t){return M.IO.get(be.p).documentFormattingEditProvider.register(e,t)}function Ui(e,t){return M.IO.get(be.p).documentRangeFormattingEditProvider.register(e,t)}function Ki(e,t){return M.IO.get(be.p).onTypeFormattingEditProvider.register(e,t)}function $i(e,t){return M.IO.get(be.p).linkProvider.register(e,t)}function Hi(e,t){return M.IO.get(be.p).completionProvider.register(e,t)}function zi(e,t){return M.IO.get(be.p).colorProvider.register(e,t)}function Vi(e,t){return M.IO.get(be.p).foldingRangeProvider.register(e,t)}function Bi(e,t){return M.IO.get(be.p).declarationProvider.register(e,t)}function Ji(e,t){return M.IO.get(be.p).selectionRangeProvider.register(e,t)}function Gi(e,t){return M.IO.get(be.p).documentSemanticTokensProvider.register(e,t)}function Yi(e,t){return M.IO.get(be.p).documentRangeSemanticTokensProvider.register(e,t)}function Xi(e,t){return M.IO.get(be.p).inlineCompletionsProvider.register(e,t)}function Qi(e,t){return M.IO.get(be.p).inlineEditProvider.register(e,t)}function Zi(e,t){return M.IO.get(be.p).inlayHintsProvider.register(e,t)}n.BH.wrappingIndent.defaultValue=n.up.None,n.BH.glyphMargin.defaultValue=!1,n.BH.autoIndent.defaultValue=n.rf.Advanced,n.BH.overviewRulerLanes.defaultValue=2,ke.xC.setFormatterSelector(((e,t,i)=>Promise.resolve(e[0])));const en=(0,r.O)();en.editor={create:Dt,getEditors:Pt,getDiffEditors:Ot,onDidCreateEditor:Tt,onDidCreateDiffEditor:Et,createDiffEditor:xt,addCommand:Mt,addEditorAction:Ft,addKeybindingRule:Nt,addKeybindingRules:At,createModel:Lt,setModelLanguage:qt,setModelMarkers:Wt,getModelMarkers:Ut,removeAllMarkers:jt,onDidChangeMarkers:Kt,getModels:Ht,getModel:$t,onDidCreateModel:zt,onWillDisposeModel:Vt,onDidChangeModelLanguage:Bt,createWebWorker:Jt,colorizeElement:Gt,colorize:Yt,colorizeModelLine:Xt,tokenize:Qt,defineTheme:Zt,setTheme:ei,remeasureFonts:ti,registerCommand:ii,registerLinkOpener:ni,registerEditorOpener:ri,AccessibilitySupport:b.ao,ContentWidgetPositionPreference:b.r3,CursorChangeReason:b.Vi,DefaultEndOfLine:b._x,EditorAutoIndentStrategy:b.rf,EditorOption:b.wT,EndOfLinePreference:b.gm,EndOfLineSequence:b.jl,MinimapPosition:b.F5,MinimapSectionHeaderStyle:b.WG,MouseTargetType:b.MG,OverlayWidgetPositionPreference:b.E$,OverviewRulerLane:b.sh,GlyphMarginLane:b.U,RenderLineNumbersType:b.Lu,RenderMinimap:b.vQ,ScrollbarVisibility:b.g_,ScrollType:b.g4,TextEditorCursorBlinkingStyle:b.In,TextEditorCursorStyle:b.d2,TrackedRangeStickiness:b.OI,WrappingIndent:b.up,InjectedTextCursorStops:b.RM,PositionAffinity:b.py,ShowLightbulbIconMode:b.$r,ConfigurationChangedEvent:n.Bb,BareFontInfo:p.E4,FontInfo:p.pR,TextModelResolvedOptions:R.dJ,FindMatch:R.tk,ApplyUpdateResult:n.rk,EditorZoom:f.C,createMultiFileDiffEditor:It,EditorType:m.gg,EditorOptions:n.BH},en.languages={register:gi,getLanguages:fi,onLanguage:mi,onLanguageEncountered:vi,getEncodedLanguageId:pi,setLanguageConfiguration:yi,setColorMap:Ri,registerTokensProviderFactory:bi,setTokensProvider:ki,setMonarchTokensProvider:Di,registerReferenceProvider:Ti,registerRenameProvider:Ei,registerNewSymbolNameProvider:Pi,registerCompletionItemProvider:Hi,registerSignatureHelpProvider:Oi,registerHoverProvider:xi,registerDocumentSymbolProvider:Ii,registerDocumentHighlightProvider:Mi,registerLinkedEditingRangeProvider:Fi,registerDefinitionProvider:Ni,registerImplementationProvider:Ai,registerTypeDefinitionProvider:Li,registerCodeLensProvider:qi,registerCodeActionProvider:Wi,registerDocumentFormattingEditProvider:ji,registerDocumentRangeFormattingEditProvider:Ui,registerOnTypeFormattingEditProvider:Ki,registerLinkProvider:$i,registerColorProvider:zi,registerFoldingRangeProvider:Vi,registerDeclarationProvider:Bi,registerSelectionRangeProvider:Ji,registerDocumentSemanticTokensProvider:Gi,registerDocumentRangeSemanticTokensProvider:Yi,registerInlineCompletionsProvider:Xi,registerInlineEditProvider:Qi,registerInlayHintsProvider:Zi,DocumentHighlightKind:b.MY,CompletionItemKind:b.cm,CompletionItemTag:b.we,CompletionItemInsertTextRule:b.a7,SymbolKind:b.cR,SymbolTag:b.r4,IndentAction:b.wU,CompletionTriggerKind:b.Ij,SignatureHelpTriggerKind:b.WW,InlayHintKind:b.gl,InlineCompletionTriggerKind:b.bw,InlineEditTriggerKind:b.rn,CodeActionTriggerType:b.np,NewSymbolNameTag:b.w,NewSymbolNameTriggerKind:b.Ll,PartialAcceptTriggerKind:b.NA,HoverVerbosityAction:b.bq,FoldingRangeKind:v.AD,SelectedSuggestionInfo:v.ln};en.CancellationTokenSource,en.Emitter,en.KeyCode,en.KeyMod,en.Position,en.Range,en.Selection,en.SelectionDirection,en.MarkerSeverity,en.MarkerTag,en.Uri,en.Token;const tn=en.editor,nn=en.languages,rn=globalThis.MonacoEnvironment;(rn?.globalAPI||"function"==typeof define&&define.amd)&&(globalThis.monaco=en);const on=nn.onLanguage;nn.onLanguage=(e,t)=>(0,ze.h5)((()=>on(e,t)));const sn=nn.onLanguage;nn.onLanguageEncountered=(e,t)=>(0,ze.h5)((()=>sn(e,t))),tn.create=(e,t,i)=>M.IO.initialize(i??{}).invokeFunction(it).createInstance(Ye,e,t),tn.createDiffEditor=(e,t,i)=>M.IO.initialize(i??{}).invokeFunction(it).createInstance(Xe,e,t),tn.createModelReference=Ze,tn.writeFile=Qe;var an;i(76265),i(60949),i(16811),i(85550),i(78283),i(7139),i(72481);self.MonacoEnvironment=(an={editorWorkerService:"editor.worker.js",json:"json.worker.js",typescript:"ts.worker.js",javascript:"ts.worker.js"},{globalAPI:!1,getWorkerUrl:function(e,t){var n=i.p,r=(n?n.replace(/\/$/,"")+"/":"")+an[t];if(/^((http:)|(https:)|(file:)|(\/\/))/.test(r)){var o=String(window.location),s=o.substr(0,o.length-window.location.hash.length-window.location.search.length-window.location.pathname.length);if(r.substring(0,s.length)!==s){/^(\/\/)/.test(r)&&(r=window.location.protocol+r);var a=new Blob(["/*"+t+'*/importScripts("'+r+'");'],{type:"application/javascript"});return URL.createObjectURL(a)}}return r}});var cn=i(59301),un=i(92004),ln=i(20495),dn=i(4030);let hn=class extends s.JT{constructor(e,t,i){super(),this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=this._register(new we.Q5),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._register(this.configurationService.onDidChangeConfiguration((e=>this._onDidChangeConfiguration.fire(this.toResourceConfigurationChangeEvent(e)))))}getValue(e,t,i){return"string"==typeof i?this._getValue(e,ln.L.isIPosition(t)?t:null,i):this._getValue(e,null,"string"==typeof t?t:void 0)}updateValue(e,t,i,n){const r=this.getLanguage(e,null),o=this.configurationService.inspect(t,{resource:e,overrideIdentifier:r});void 0===n&&(n=this.deriveConfigurationTarget(o,r));const s=r&&o.overrideIdentifiers?.includes(r)?r:void 0;return this.configurationService.updateValue(t,i,{resource:e,overrideIdentifier:s},n)}deriveConfigurationTarget(e,t){if(t){if(void 0!==e.memory?.override)return dn.JD.MEMORY;if(void 0!==e.workspaceFolder?.override)return dn.JD.WORKSPACE_FOLDER;if(void 0!==e.workspace?.override)return dn.JD.WORKSPACE;if(void 0!==e.userRemote?.override)return dn.JD.USER_REMOTE;if(void 0!==e.userLocal?.override)return dn.JD.USER_LOCAL}return void 0!==e.memory?.value?dn.JD.MEMORY:void 0!==e.workspaceFolder?.value?dn.JD.WORKSPACE_FOLDER:void 0!==e.workspace?.value?dn.JD.WORKSPACE:void 0!==e.userRemote?.value?dn.JD.USER_REMOTE:dn.JD.USER_LOCAL}_getValue(e,t,i){const n=e?this.getLanguage(e,t):void 0;return void 0===i?this.configurationService.getValue({resource:e,overrideIdentifier:n}):this.configurationService.getValue(i,{resource:e,overrideIdentifier:n})}inspect(e,t,i){const n=e?this.getLanguage(e,t):void 0;return this.configurationService.inspect(i,{resource:e,overrideIdentifier:n})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}toResourceConfigurationChangeEvent(e){return{affectedKeys:e.affectedKeys,affectsConfiguration:(t,i)=>{const n=t?this.getLanguage(t,null):void 0;return e.affectsConfiguration(i,{resource:t,overrideIdentifier:n})}}}};hn=(0,O.g)([(0,O.f)(0,x.U),(0,O.f)(1,_.q),(0,O.f)(2,y.O)],hn);var gn=i(83780),fn=i(72318),pn=i(36810),mn=i(70092),vn=i(31437),yn=i(23783);const Cn=".vscode",wn="settings",Sn=`${Cn}/${wn}.json`,Rn="vscode://schemas/settings/workspace",_n=(xe.ue.APPLICATION,[xe.ue.MACHINE,xe.ue.WINDOW,xe.ue.RESOURCE,xe.ue.LANGUAGE_OVERRIDABLE,xe.ue.MACHINE_OVERRIDABLE]),bn=[xe.ue.WINDOW,xe.ue.RESOURCE,xe.ue.LANGUAGE_OVERRIDABLE],kn=[xe.ue.APPLICATION,...bn],Dn=[xe.ue.MACHINE,xe.ue.WINDOW,xe.ue.RESOURCE,xe.ue.LANGUAGE_OVERRIDABLE,xe.ue.MACHINE_OVERRIDABLE],Tn=[xe.ue.WINDOW,xe.ue.RESOURCE,xe.ue.LANGUAGE_OVERRIDABLE,xe.ue.MACHINE_OVERRIDABLE],En=[xe.ue.RESOURCE,xe.ue.LANGUAGE_OVERRIDABLE,xe.ue.MACHINE_OVERRIDABLE],Pn="tasks",On="launch",xn=Object.create(null);xn[Pn]=`${Cn}/${Pn}.json`,xn[On]=`${Cn}/${On}.json`;const In=Object.create(null);In[Pn]=`${Pn}.json`;const Mn="workbench.settings.applyToAllProfiles";var Fn=i(26258),Nn=i(59082),An=i(99360);const Ln="vs/workbench/api/common/configurationExtensionPoint",qn=Pe.B.as(Oe.I.JSONContribution),Wn=Pe.B.as(xe.IP.Configuration),jn={type:"object",defaultSnippets:[{body:{title:"",properties:{}}}],properties:{title:{description:(0,fe.C$)(Ln,0,"A title for the current category of settings. This label will be rendered in the Settings editor as a subheading. If the title is the same as the extension display name, then the category will be grouped under the main extension heading."),type:"string"},order:{description:(0,fe.C$)(Ln,1,"When specified, gives the order of this category of settings relative to other categories."),type:"integer"},properties:{description:(0,fe.C$)(Ln,2,"Description of the configuration properties."),type:"object",propertyNames:{pattern:"\\S+",patternErrorMessage:(0,fe.C$)(Ln,3,"Property should not be empty.")},additionalProperties:{anyOf:[{title:(0,fe.C$)(Ln,4,"Schema of the configuration property."),$ref:"http://json-schema.org/draft-07/schema#"},{type:"object",properties:{scope:{type:"string",enum:["application","machine","window","resource","language-overridable","machine-overridable"],default:"window",enumDescriptions:[(0,fe.C$)(Ln,5,"Configuration that can be configured only in the user settings."),(0,fe.C$)(Ln,6,"Configuration that can be configured only in the user settings or only in the remote settings."),(0,fe.C$)(Ln,7,"Configuration that can be configured in the user, remote or workspace settings."),(0,fe.C$)(Ln,8,"Configuration that can be configured in the user, remote, workspace or folder settings."),(0,fe.C$)(Ln,9,"Resource configuration that can be configured in language specific settings."),(0,fe.C$)(Ln,10,"Machine configuration that can be configured also in workspace or folder settings.")],markdownDescription:(0,fe.C$)(Ln,11,"Scope in which the configuration is applicable. Available scopes are `application`, `machine`, `window`, `resource`, and `machine-overridable`.")},enumDescriptions:{type:"array",items:{type:"string"},description:(0,fe.C$)(Ln,12,"Descriptions for enum values")},markdownEnumDescriptions:{type:"array",items:{type:"string"},description:(0,fe.C$)(Ln,13,"Descriptions for enum values in the markdown format.")},enumItemLabels:{type:"array",items:{type:"string"},markdownDescription:(0,fe.C$)(Ln,14,"Labels for enum values to be displayed in the Settings editor. When specified, the {0} values still show after the labels, but less prominently.","`enum`")},markdownDescription:{type:"string",description:(0,fe.C$)(Ln,15,"The description in the markdown format.")},deprecationMessage:{type:"string",description:(0,fe.C$)(Ln,16,"If set, the property is marked as deprecated and the given message is shown as an explanation.")},markdownDeprecationMessage:{type:"string",description:(0,fe.C$)(Ln,17,"If set, the property is marked as deprecated and the given message is shown as an explanation in the markdown format.")},editPresentation:{type:"string",enum:["singlelineText","multilineText"],enumDescriptions:[(0,fe.C$)(Ln,18,"The value will be shown in an inputbox."),(0,fe.C$)(Ln,19,"The value will be shown in a textarea.")],default:"singlelineText",description:(0,fe.C$)(Ln,20,"When specified, controls the presentation format of the string setting.")},order:{type:"integer",description:(0,fe.C$)(Ln,21,"When specified, gives the order of this setting relative to other settings within the same category. Settings with an order property will be placed before settings without this property set.")},ignoreSync:{type:"boolean",description:(0,fe.C$)(Ln,22,"When enabled, Settings Sync will not sync the user value of this configuration by default.")}}}]}}}};let Un;const Kn=yn.ut.registerExtensionPoint({extensionPoint:"configurationDefaults",jsonSchema:{$ref:xe.Tk}});Kn.setHandler(((e,{added:t,removed:i})=>{Un&&Wn.deltaConfiguration(Un);const n=Un={};if(queueMicrotask((()=>{Un===n&&(Wn.deltaConfiguration(Un),Un=void 0)})),i.length){const e=i.map((e=>({overrides:(0,Ee.I8)(e.value),source:{id:e.description.identifier.value,displayName:e.description.displayName}})));Un.removedDefaults=e}if(t.length){const e=Wn.getConfigurationProperties(),i=[xe.ue.MACHINE_OVERRIDABLE,xe.ue.WINDOW,xe.ue.RESOURCE,xe.ue.LANGUAGE_OVERRIDABLE],n=t.map((t=>{const n=(0,Ee.I8)(t.value);for(const r of Object.keys(n))if(!xe.eU.test(r)){const o=e[r];o?.scope&&!i.includes(o.scope)&&(t.collector.warn((0,fe.C$)(Ln,23,"Cannot register configuration defaults for '{0}'. Only defaults for machine-overridable, window, resource and language overridable scoped settings are supported.",r)),delete n[r])}return{overrides:n,source:{id:t.description.identifier.value,displayName:t.description.displayName}}}));Un.addedDefaults=n}}));const $n=yn.ut.registerExtensionPoint({extensionPoint:"configuration",deps:[Kn],jsonSchema:{description:(0,fe.C$)(Ln,24,"Contributes configuration settings."),oneOf:[jn,{type:"array",items:jn}]}}),Hn=new Fn.C1;$n.setHandler(((e,{added:t,removed:i})=>{if(Un??={},i.length){const e=[];for(const t of i)e.push(...Hn.get(t.description.identifier)||[]),Hn.delete(t.description.identifier);Un.removedConfigurations=e}const n=new Set;function r(e,t){const i=[],n=(0,Ee.I8)(e);return n.title&&"string"!=typeof n.title&&t.collector.error((0,fe.C$)(Ln,25,"'configuration.title' must be a string")),o(n,t),n.id=e.id||t.description.identifier.value,n.extensionInfo={id:t.description.identifier.value,displayName:t.description.displayName},n.restrictedProperties="limited"===t.description.capabilities?.untrustedWorkspaces?.supported?t.description.capabilities?.untrustedWorkspaces.restrictedConfigurations:void 0,n.title=n.title||t.description.displayName||t.description.identifier.value,i.push(n),i}function o(e,t){const i=e.properties;if(i){"object"!=typeof i&&(t.collector.error((0,fe.C$)(Ln,26,"'configuration.properties' must be an object")),e.properties={});for(const e in i){const r=i[e],o=(0,xe.uO)(e,r);o?(delete i[e],t.collector.warn(o)):n.has(e)?(delete i[e],t.collector.warn((0,fe.C$)(Ln,27,"Cannot register '{0}'. This property is already registered.",e))):(0,Te.Kn)(r)?(n.add(e),r.scope?"application"===r.scope.toString()?r.scope=xe.ue.APPLICATION:"machine"===r.scope.toString()?r.scope=xe.ue.MACHINE:"resource"===r.scope.toString()?r.scope=xe.ue.RESOURCE:"machine-overridable"===r.scope.toString()?r.scope=xe.ue.MACHINE_OVERRIDABLE:"language-overridable"===r.scope.toString()?r.scope=xe.ue.LANGUAGE_OVERRIDABLE:r.scope=xe.ue.WINDOW:r.scope=xe.ue.WINDOW):(delete i[e],t.collector.error((0,fe.C$)(Ln,28,"configuration.properties property '{0}' must be an object",e)))}}const r=e.allOf;if(r){t.collector.error((0,fe.C$)(Ln,29,"'configuration.allOf' is deprecated and should no longer be used. Instead, pass multiple configuration sections as an array to the 'configuration' contribution point."));for(const e of r)o(e,t)}}if(t.length){const e=[];for(const i of t){const t=[],n=i.value;Array.isArray(n)?n.forEach((e=>t.push(...r(e,i)))):t.push(...r(n,i)),Hn.set(i.description.identifier,t),e.push(...t)}Un.addedConfigurations=e}Wn.deltaConfiguration(Un),Un=void 0})),qn.registerSchema("vscode://schemas/workspaceConfig",{allowComments:!0,allowTrailingCommas:!0,default:{folders:[{path:""}],settings:{}},required:["folders"],properties:{folders:{minItems:0,uniqueItems:!0,description:(0,fe.C$)(Ln,30,"List of folders to be loaded in the workspace."),items:{type:"object",defaultSnippets:[{body:{path:"$1"}}],oneOf:[{properties:{path:{type:"string",description:(0,fe.C$)(Ln,31,"A file path. e.g. `/root/folderA` or `./folderA` for a relative path that will be resolved against the location of the workspace file.")},name:{type:"string",description:(0,fe.C$)(Ln,32,"An optional name for the folder. ")}},required:["path"]},{properties:{uri:{type:"string",description:(0,fe.C$)(Ln,33,"URI of the folder")},name:{type:"string",description:(0,fe.C$)(Ln,32,"An optional name for the folder. ")}},required:["uri"]}]}},settings:{type:"object",default:{},description:(0,fe.C$)(Ln,34,"Workspace settings"),$ref:Rn},launch:{type:"object",default:{configurations:[],compounds:[]},description:(0,fe.C$)(Ln,35,"Workspace launch configurations"),$ref:"vscode://schemas/launch"},tasks:{type:"object",default:{version:"2.0.0",tasks:[]},description:(0,fe.C$)(Ln,36,"Workspace task configurations"),$ref:"vscode://schemas/tasks"},extensions:{type:"object",default:{},description:(0,fe.C$)(Ln,37,"Workspace extensions"),$ref:"vscode://schemas/extensions"},remoteAuthority:{type:"string",doNotSuggest:!0,description:(0,fe.C$)(Ln,38,"The remote server where the workspace is located.")},transient:{type:"boolean",doNotSuggest:!0,description:(0,fe.C$)(Ln,39,"A transient workspace will disappear when restarting or reloading.")}},errorMessage:(0,fe.C$)(Ln,40,"Unknown workspace configuration property")});class zn extends s.JT{constructor(){super(...arguments),this.type="table"}shouldRender(e){return!!e.contributes?.configuration}render(e){const t=e.contributes?.configuration;let i={};Array.isArray(t)?t.forEach((e=>{i={...i,...e.properties}})):t&&(i=t.properties);const n=i?Object.keys(i):[];return{data:{headers:[(0,fe.C$)(Ln,41,"ID"),(0,fe.C$)(Ln,42,"Description"),(0,fe.C$)(Ln,43,"Default")],rows:n.sort(((e,t)=>e.localeCompare(t))).map((e=>[(new An.W5).appendMarkdown(`\`${e}\``),i[e].markdownDescription?new An.W5(i[e].markdownDescription,!1):i[e].description??"",(new An.W5).appendCodeblock("json",JSON.stringify((0,Te.o8)(i[e].default)?(0,xe.oG)(i[e].type):i[e].default,null,2))]))},dispose:()=>{}}}}Pe.B.as(Nn.I.ExtensionFeaturesRegistry).registerExtensionFeature({id:"configuration",label:(0,fe.C$)(Ln,44,"Settings"),access:{canToggle:!1},renderer:new Ae.M(zn)});var Vn=i(79898),Bn=i(51470),Jn=i(56940),Gn=i(54253),Yn=i(81647),Xn=i(84517),Qn=i(22997),Zn=i(76199),er=i(53114),tr=i(16435),ir=i(74120);const nr="vs/workbench/contrib/workspaces/browser/workspaces.contribution";let rr=class extends s.JT{constructor(e,t,i,n,r,o){super(),this.contextService=e,this.notificationService=t,this.fileService=i,this.quickInputService=n,this.hostService=r,this.storageService=o,this.findWorkspaces()}async findWorkspaces(){const e=this.contextService.getWorkspace().folders[0];if(!e||this.contextService.getWorkbenchState()!==Jn.Xe.FOLDER||(0,er.wB)(this.contextService.getWorkspace()))return;const t=(await this.fileService.resolve(e.uri)).children?.map((e=>e.name));if(Array.isArray(t)){const i=t.filter(Jn.g);i.length>0&&this.doHandleWorkspaceFiles(e.uri,i)}}doHandleWorkspaceFiles(e,t){const i={id:"workspaces.dontPromptToOpen",scope:Gn.YB.WORKSPACE,isSecondary:!0};if(1===t.length){const n=t[0];this.notificationService.prompt(ir.Z.Info,(0,fe.C$)(nr,0,"This folder contains a workspace file '{0}'. Do you want to open it? [Learn more]({1}) about workspace files.",n,"https://go.microsoft.com/fwlink/?linkid=2025315"),[{label:(0,fe.C$)(nr,1,"Open Workspace"),run:()=>this.hostService.openWindow([{workspaceUri:(0,Yn.Vo)(e,n)}])}],{neverShowAgain:i,priority:this.storageService.isNew(Qn.fO.WORKSPACE)?void 0:Gn.RX.SILENT})}else t.length>1&&this.notificationService.prompt(ir.Z.Info,(0,fe.C$)(nr,2,"This folder contains multiple workspace files. Do you want to open one? [Learn more]({0}) about workspace files.","https://go.microsoft.com/fwlink/?linkid=2025315"),[{label:(0,fe.C$)(nr,3,"Select Workspace"),run:()=>{this.quickInputService.pick(t.map((e=>({label:e}))),{placeHolder:(0,fe.C$)(nr,4,"Select a workspace to open")}).then((t=>{t&&this.hostService.openWindow([{workspaceUri:(0,Yn.Vo)(e,t.label)}])}))}}],{neverShowAgain:i,priority:this.storageService.isNew(Qn.fO.WORKSPACE)?void 0:Gn.RX.SILENT})}};rr=(0,O.g)([(0,O.f)(0,mn.e),(0,O.f)(1,Ue.l),(0,O.f)(2,Le.s),(0,O.f)(3,$e.e),(0,O.f)(4,Xn.$),(0,O.f)(5,Zn.U)],rr),Pe.B.as(Vn.IP.Workbench).registerWorkbenchContribution(rr,Bn.BL.Eventually),(0,N.r1)(class extends N.Ke{constructor(){super({id:"workbench.action.openWorkspaceFromEditor",title:(0,fe.OQ)(nr,1,"Open Workspace"),f1:!1,menu:{id:N.eH.EditorContent,when:L.Ao.and(qe.f1.Extension.isEqualTo(Jn.l2),qe.cM.isEqualTo(tr.dD),qe.gu.toNegated())}})}async run(e,t){const i=e.get(Xn.$),n=e.get(mn.e),r=e.get(Ue.l);if(n.getWorkbenchState()===Jn.Xe.WORKSPACE){const e=n.getWorkspace().configuration;if(e&&(0,Yn.Xy)(e,t))return void r.info((0,fe.C$)(nr,5,"This workspace is already open."))}return i.openWindow([{workspaceUri:t}])}});var or=i(18910),sr=i(35820),ar=i(2756),cr=i(45043);class ur extends ar.wU{constructor(e,t){super(e,t),this._folders=[],this._transient=!1,this._settingsModelParser=new ar.wU(e,t),this._launchModel=ar.VV.createEmptyModel(t),this._tasksModel=ar.VV.createEmptyModel(t)}get folders(){return this._folders}get transient(){return this._transient}get settingsModel(){return this._settingsModelParser.configurationModel}get launchModel(){return this._launchModel}get tasksModel(){return this._tasksModel}reparseWorkspaceSettings(e){this._settingsModelParser.reparse(e)}getRestrictedWorkspaceSettings(){return this._settingsModelParser.restrictedConfigurations}doParseRaw(e,t){return this._folders=e.folders||[],this._transient=(0,Te.jn)(e.transient)&&e.transient,this._settingsModelParser.parseRaw(e.settings,t),this._launchModel=this.createConfigurationModelFrom(e,"launch"),this._tasksModel=this.createConfigurationModelFrom(e,"tasks"),super.doParseRaw(e,t)}createConfigurationModelFrom(e,t){const i=e[t];if(i){const e=(0,dn.Od)(i,(e=>console.error(`Conflict in settings file ${this._name}: ${e}`))),n=Object.create(null);n[t]=e;const r=Object.keys(i).map((e=>`${t}.${e}`));return new ar.VV(n,r,[],void 0,this.logService)}return ar.VV.createEmptyModel(this.logService)}}class lr extends ar.wU{constructor(e,t,i){super(e,i),this.scope=t}doParseRaw(e,t){const i=(0,dn.Od)(e,(e=>console.error(`Conflict in settings file ${this._name}: ${e}`))),n=Object.create(null);n[this.scope]=i;return{contents:n,keys:Object.keys(e).map((e=>`${this.scope}.${e}`)),overrides:[]}}}class dr extends ar.VK{constructor(e,t,i,n,r,o,s,a,c,u,l){super(e,t,i,n,r,o,s,a,c,l),this._workspace=u}getValue(e,t={}){return super.getValue(e,t,this._workspace)}inspect(e,t={}){return super.inspect(e,t,this._workspace)}keys(){return super.keys(this._workspace)}compareAndDeleteFolderConfiguration(e){return this._workspace&&this._workspace.folders.length>0&&this._workspace.folders[0].uri.toString()===e.toString()?{keys:[],overrides:[]}:super.compareAndDeleteFolderConfiguration(e)}compare(e){const t=(t,i,n)=>{const r=[];return r.push(...i.filter((e=>-1===t.indexOf(e)))),r.push(...t.filter((e=>-1===i.indexOf(e)))),r.push(...t.filter((t=>-1!==i.indexOf(t)&&(!(0,Ee.fS)(this.getValue(t,{overrideIdentifier:n}),e.getValue(t,{overrideIdentifier:n}))||this._workspace&&this._workspace.folders.some((i=>!(0,Ee.fS)(this.getValue(t,{resource:i.uri,overrideIdentifier:n}),e.getValue(t,{resource:i.uri,overrideIdentifier:n})))))))),r},i=t(this.allKeys(),e.allKeys()),n=[],r=(0,z.EB)([...this.allOverrideIdentifiers(),...e.allOverrideIdentifiers()]);for(const i of r){const r=t(this.getAllKeysForOverrideIdentifier(i),e.getAllKeysForOverrideIdentifier(i),i);r.length&&n.push([i,r])}return{keys:i,overrides:n}}}var hr=i(24363),gr=i(58826),fr=i(12646),pr=i(1991),mr=i(15229),vr=i(11547),yr=i(16585);function Cr(e){return e.hasOwnProperty("folderUri")}function wr(e){return Sr(e)||Rr(e)}function Sr(e){const t=e;return"string"==typeof t?.path&&(!t.name||"string"==typeof t.name)}function Rr(e){const t=e;return"string"==typeof t?.uri&&(!t.name||"string"==typeof t.name)}function _r(e,t,i,n,r){if(e.scheme!==n.scheme)return{name:i,uri:e.toString(!0)};let o=t?void 0:r.relativePath(n,e);if(void 0!==o)0===o.length?o=".":vr.ED&&(o=br(o));else if(e.scheme===cn.lg.file)o=e.fsPath,vr.ED&&(o=br(o));else{if(!r.isEqualAuthority(e.authority,n.authority))return{name:i,uri:e.toString(!0)};o=e.path}return{name:i,path:o}}function br(e){return e=(0,pr.DT)(e),(0,hr._g)(e)||(e=(0,hr.ej)(e)),e}function kr(e,t,i){const n=[],r=new Set,o=i.dirname(t);for(const t of e){let e;if(Sr(t))t.path&&(e=i.resolvePath(o,t.path));else if(Rr(t))try{e=c.ov.parse(t.uri),e.path[0]!==mr.KR.sep&&(e=e.with({path:mr.KR.sep+e.path}))}catch(e){console.warn(e)}if(e){const o=i.getComparisonKey(e);if(!r.has(o)){r.add(o);const s=t.name||i.basenameOrAuthority(e);n.push(new Jn.md({uri:e,name:s,index:n.length},t))}}}return n}function Dr(e,t,i,n,r){const o=function(e,t){const i=(0,gr.Qc)(t);if(!i||!Array.isArray(i.folders))throw new Error(`${e} looks like an invalid workspace file.`);i.folders=i.folders.filter((e=>wr(e)));return i}(t,e),s=r.dirname(t),a=r.dirname(n),u=[];for(const e of o.folders){const t=Sr(e)?r.resolvePath(s,e.path):c.ov.parse(e.uri);let n;n=!i&&(!Sr(e)||(0,mr.YP)(e.path)),u.push(_r(t,n,e.name,a,r))}const l={insertSpaces:!1,tabSize:4,eol:vr.IJ||vr.dz?"\n":"\r\n"},d=(0,fr.Hn)(e,["folders"],u,l);let h=(0,fr.Jj)(e,d);return(0,Yn.x5)(o.remoteAuthority,(0,yr.ik)(n))&&(h=(0,fr.Jj)(h,(0,fr.jX)(h,["remoteAuthority"],l))),h}var Tr=i(93115);const Er=(0,ie.LO)(x.U);var Pr=i(28698),Or=i(7907),xr=i(12593),Ir=i(44861),Mr=i(51580);const Fr="vs/workbench/services/configuration/common/configurationEditing";var Nr,Ar;!function(e){e[e.ERROR_UNKNOWN_KEY=0]="ERROR_UNKNOWN_KEY",e[e.ERROR_INVALID_WORKSPACE_CONFIGURATION_APPLICATION=1]="ERROR_INVALID_WORKSPACE_CONFIGURATION_APPLICATION",e[e.ERROR_INVALID_WORKSPACE_CONFIGURATION_MACHINE=2]="ERROR_INVALID_WORKSPACE_CONFIGURATION_MACHINE",e[e.ERROR_INVALID_FOLDER_CONFIGURATION=3]="ERROR_INVALID_FOLDER_CONFIGURATION",e[e.ERROR_INVALID_USER_TARGET=4]="ERROR_INVALID_USER_TARGET",e[e.ERROR_INVALID_WORKSPACE_TARGET=5]="ERROR_INVALID_WORKSPACE_TARGET",e[e.ERROR_INVALID_FOLDER_TARGET=6]="ERROR_INVALID_FOLDER_TARGET",e[e.ERROR_INVALID_RESOURCE_LANGUAGE_CONFIGURATION=7]="ERROR_INVALID_RESOURCE_LANGUAGE_CONFIGURATION",e[e.ERROR_NO_WORKSPACE_OPENED=8]="ERROR_NO_WORKSPACE_OPENED",e[e.ERROR_CONFIGURATION_FILE_DIRTY=9]="ERROR_CONFIGURATION_FILE_DIRTY",e[e.ERROR_CONFIGURATION_FILE_MODIFIED_SINCE=10]="ERROR_CONFIGURATION_FILE_MODIFIED_SINCE",e[e.ERROR_INVALID_CONFIGURATION=11]="ERROR_INVALID_CONFIGURATION",e[e.ERROR_POLICY_CONFIGURATION=12]="ERROR_POLICY_CONFIGURATION",e[e.ERROR_INTERNAL=13]="ERROR_INTERNAL"}(Nr||(Nr={}));class Lr extends Y.QD{constructor(e,t){super(e),this.code=t}}!function(e){e[e.USER_LOCAL=1]="USER_LOCAL",e[e.USER_REMOTE=2]="USER_REMOTE",e[e.WORKSPACE=3]="WORKSPACE",e[e.WORKSPACE_FOLDER=4]="WORKSPACE_FOLDER"}(Ar||(Ar={}));let qr=class{constructor(e,t,i,n,r,o,s,a,c,u,l,d){this.remoteSettingsResource=e,this.configurationService=t,this.contextService=i,this.userDataProfileService=n,this.userDataProfilesService=r,this.fileService=o,this.textModelResolverService=s,this.textFileService=a,this.notificationService=c,this.preferencesService=u,this.editorService=l,this.uriIdentityService=d,this.queue=new sr.ci}async writeConfiguration(e,t,i={}){const n=this.getConfigurationEditOperation(e,t,i.scopes||{});return this.queue.queue((async()=>{try{await this.doWriteConfiguration(n,i)}catch(e){if(i.donotNotifyError)throw e;await this.onError(e,n,i.scopes)}}))}async doWriteConfiguration(e,t){await this.validate(e.target,e,!t.handleDirtyFile,t.scopes||{});const i=e.resource,n=await this.resolveModelReference(i);try{const i=this.getFormattingOptions(n.object.textEditorModel);await this.updateConfiguration(e,n.object.textEditorModel,i,t)}finally{n.dispose()}}async updateConfiguration(e,t,i,n){if(this.hasParseErrors(t.getValue(),e))throw this.toConfigurationEditingError(Nr.ERROR_INVALID_CONFIGURATION,e.target,e);if(this.textFileService.isDirty(t.uri)&&n.handleDirtyFile)switch(n.handleDirtyFile){case"save":await this.save(t,e);break;case"revert":await this.textFileService.revert(t.uri)}const r=this.getEdits(e,t.getValue(),i)[0];r&&this.applyEditsToBuffer(r,t)&&await this.save(t,e)}async save(e,t){try{await this.textFileService.save(e.uri,{ignoreErrorHandler:!0})}catch(e){if(e.fileOperationResult===Pr.PK.FILE_MODIFIED_SINCE)throw this.toConfigurationEditingError(Nr.ERROR_CONFIGURATION_FILE_MODIFIED_SINCE,t.target,t);throw new Lr((0,fe.C$)(Fr,0,"Error while writing to {0}. {1}",this.stringifyTarget(t.target),e.message),Nr.ERROR_INTERNAL)}}applyEditsToBuffer(e,t){const i=t.getPositionAt(e.offset),n=t.getPositionAt(e.offset+e.length),r=new _e.e(i.lineNumber,i.column,n.lineNumber,n.column),o=t.getValueInRange(r);if(e.content!==o){const n=o?Ir.h.replace(r,e.content):Ir.h.insert(i,e.content);return t.pushEditOperations([new Z.Y(i.lineNumber,i.column,i.lineNumber,i.column)],[n],(()=>[])),!0}return!1}getEdits({value:e,jsonPath:t},i,n){if(t.length)return(0,fr.Hn)(i,t,e,n);return[{content:JSON.stringify(e,null,n.insertSpaces&&n.tabSize?" ".repeat(n.tabSize):"\t"),length:i.length,offset:0}]}getFormattingOptions(e){const{insertSpaces:t,tabSize:i}=e.getOptions();return{insertSpaces:t,tabSize:i,eol:e.getEOL()}}async onError(e,t,i){switch(e.code){case Nr.ERROR_INVALID_CONFIGURATION:this.onInvalidConfigurationError(e,t);break;case Nr.ERROR_CONFIGURATION_FILE_DIRTY:this.onConfigurationFileDirtyError(e,t,i);break;case Nr.ERROR_CONFIGURATION_FILE_MODIFIED_SINCE:return this.doWriteConfiguration(t,{scopes:i,handleDirtyFile:"revert"});default:this.notificationService.error(e.message)}}onInvalidConfigurationError(e,t){const i=t.workspaceStandAloneConfigurationKey===Pn?(0,fe.C$)(Fr,1,"Open Tasks Configuration"):t.workspaceStandAloneConfigurationKey===On?(0,fe.C$)(Fr,2,"Open Launch Configuration"):null;i?this.notificationService.prompt(ir.Z.Error,e.message,[{label:i,run:()=>this.openFile(t.resource)}]):this.notificationService.prompt(ir.Z.Error,e.message,[{label:(0,fe.C$)(Fr,3,"Open Settings"),run:()=>this.openSettings(t)}])}onConfigurationFileDirtyError(e,t,i){const n=t.workspaceStandAloneConfigurationKey===Pn?(0,fe.C$)(Fr,1,"Open Tasks Configuration"):t.workspaceStandAloneConfigurationKey===On?(0,fe.C$)(Fr,2,"Open Launch Configuration"):null;n?this.notificationService.prompt(ir.Z.Error,e.message,[{label:(0,fe.C$)(Fr,4,"Save and Retry"),run:()=>{const e=t.key?`${t.workspaceStandAloneConfigurationKey}.${t.key}`:t.workspaceStandAloneConfigurationKey;this.writeConfiguration(t.target,{key:e,value:t.value},{handleDirtyFile:"save",scopes:i})}},{label:n,run:()=>this.openFile(t.resource)}]):this.notificationService.prompt(ir.Z.Error,e.message,[{label:(0,fe.C$)(Fr,4,"Save and Retry"),run:()=>this.writeConfiguration(t.target,{key:t.key,value:t.value},{handleDirtyFile:"save",scopes:i})},{label:(0,fe.C$)(Fr,3,"Open Settings"),run:()=>this.openSettings(t)}])}openSettings(e){const t={jsonEditor:!0};switch(e.target){case Ar.USER_LOCAL:this.preferencesService.openUserSettings(t);break;case Ar.USER_REMOTE:this.preferencesService.openRemoteSettings(t);break;case Ar.WORKSPACE:this.preferencesService.openWorkspaceSettings(t);break;case Ar.WORKSPACE_FOLDER:if(e.resource){const t=this.contextService.getWorkspaceFolder(e.resource);t&&this.preferencesService.openFolderSettings({folderUri:t.uri,jsonEditor:!0})}}}openFile(e){this.editorService.openEditor({resource:e,options:{pinned:!0}})}toConfigurationEditingError(e,t,i){const n=this.toErrorMessage(e,t,i);return new Lr(n,e)}toErrorMessage(e,t,i){switch(e){case Nr.ERROR_POLICY_CONFIGURATION:return(0,fe.C$)(Fr,5,"Unable to write {0} because it is configured in system policy.",i.key);case Nr.ERROR_UNKNOWN_KEY:return(0,fe.C$)(Fr,6,"Unable to write to {0} because {1} is not a registered configuration.",this.stringifyTarget(t),i.key);case Nr.ERROR_INVALID_WORKSPACE_CONFIGURATION_APPLICATION:return(0,fe.C$)(Fr,7,"Unable to write {0} to Workspace Settings. This setting can be written only into User settings.",i.key);case Nr.ERROR_INVALID_WORKSPACE_CONFIGURATION_MACHINE:return(0,fe.C$)(Fr,8,"Unable to write {0} to Workspace Settings. This setting can be written only into User settings.",i.key);case Nr.ERROR_INVALID_FOLDER_CONFIGURATION:return(0,fe.C$)(Fr,9,"Unable to write to Folder Settings because {0} does not support the folder resource scope.",i.key);case Nr.ERROR_INVALID_USER_TARGET:return(0,fe.C$)(Fr,10,"Unable to write to User Settings because {0} does not support for global scope.",i.key);case Nr.ERROR_INVALID_WORKSPACE_TARGET:return(0,fe.C$)(Fr,11,"Unable to write to Workspace Settings because {0} does not support for workspace scope in a multi folder workspace.",i.key);case Nr.ERROR_INVALID_FOLDER_TARGET:return(0,fe.C$)(Fr,12,"Unable to write to Folder Settings because no resource is provided.");case Nr.ERROR_INVALID_RESOURCE_LANGUAGE_CONFIGURATION:return(0,fe.C$)(Fr,13,"Unable to write to Language Settings because {0} is not a resource language setting.",i.key);case Nr.ERROR_NO_WORKSPACE_OPENED:return(0,fe.C$)(Fr,14,"Unable to write to {0} because no workspace is opened. Please open a workspace first and try again.",this.stringifyTarget(t));case Nr.ERROR_INVALID_CONFIGURATION:if(i.workspaceStandAloneConfigurationKey===Pn)return(0,fe.C$)(Fr,15,"Unable to write into the tasks configuration file. Please open it to correct errors/warnings in it and try again.");if(i.workspaceStandAloneConfigurationKey===On)return(0,fe.C$)(Fr,16,"Unable to write into the launch configuration file. Please open it to correct errors/warnings in it and try again.");switch(t){case Ar.USER_LOCAL:return(0,fe.C$)(Fr,17,"Unable to write into user settings. Please open the user settings to correct errors/warnings in it and try again.");case Ar.USER_REMOTE:return(0,fe.C$)(Fr,18,"Unable to write into remote user settings. Please open the remote user settings to correct errors/warnings in it and try again.");case Ar.WORKSPACE:return(0,fe.C$)(Fr,19,"Unable to write into workspace settings. Please open the workspace settings to correct errors/warnings in the file and try again.");case Ar.WORKSPACE_FOLDER:{let e="<<unknown>>";if(i.resource){const t=this.contextService.getWorkspaceFolder(i.resource);t&&(e=t.name)}return(0,fe.C$)(Fr,20,"Unable to write into folder settings. Please open the '{0}' folder settings to correct errors/warnings in it and try again.",e)}default:return""}case Nr.ERROR_CONFIGURATION_FILE_DIRTY:if(i.workspaceStandAloneConfigurationKey===Pn)return(0,fe.C$)(Fr,21,"Unable to write into tasks configuration file because the file has unsaved changes. Please save it first and then try again.");if(i.workspaceStandAloneConfigurationKey===On)return(0,fe.C$)(Fr,22,"Unable to write into launch configuration file because the file has unsaved changes. Please save it first and then try again.");switch(t){case Ar.USER_LOCAL:return(0,fe.C$)(Fr,23,"Unable to write into user settings because the file has unsaved changes. Please save the user settings file first and then try again.");case Ar.USER_REMOTE:return(0,fe.C$)(Fr,24,"Unable to write into remote user settings because the file has unsaved changes. Please save the remote user settings file first and then try again.");case Ar.WORKSPACE:return(0,fe.C$)(Fr,25,"Unable to write into workspace settings because the file has unsaved changes. Please save the workspace settings file first and then try again.");case Ar.WORKSPACE_FOLDER:{let e="<<unknown>>";if(i.resource){const t=this.contextService.getWorkspaceFolder(i.resource);t&&(e=t.name)}return(0,fe.C$)(Fr,26,"Unable to write into folder settings because the file has unsaved changes. Please save the '{0}' folder settings file first and then try again.",e)}default:return""}case Nr.ERROR_CONFIGURATION_FILE_MODIFIED_SINCE:if(i.workspaceStandAloneConfigurationKey===Pn)return(0,fe.C$)(Fr,27,"Unable to write into tasks configuration file because the content of the file is newer.");if(i.workspaceStandAloneConfigurationKey===On)return(0,fe.C$)(Fr,28,"Unable to write into launch configuration file because the content of the file is newer.");switch(t){case Ar.USER_LOCAL:return(0,fe.C$)(Fr,29,"Unable to write into user settings because the content of the file is newer.");case Ar.USER_REMOTE:return(0,fe.C$)(Fr,30,"Unable to write into remote user settings because the content of the file is newer.");case Ar.WORKSPACE:return(0,fe.C$)(Fr,31,"Unable to write into workspace settings because the content of the file is newer.");case Ar.WORKSPACE_FOLDER:return(0,fe.C$)(Fr,32,"Unable to write into folder settings because the content of the file is newer.")}case Nr.ERROR_INTERNAL:return(0,fe.C$)(Fr,33,"Unable to write to {0} because of an internal error.",this.stringifyTarget(t))}}stringifyTarget(e){switch(e){case Ar.USER_LOCAL:return(0,fe.C$)(Fr,34,"User Settings");case Ar.USER_REMOTE:return(0,fe.C$)(Fr,35,"Remote User Settings");case Ar.WORKSPACE:return(0,fe.C$)(Fr,36,"Workspace Settings");case Ar.WORKSPACE_FOLDER:return(0,fe.C$)(Fr,37,"Folder Settings");default:return""}}defaultResourceValue(e){const t=this.uriIdentityService.extUri.basename(e);return t.substr(0,t.length-this.uriIdentityService.extUri.extname(e).length)===Pn?'{\n\t"version": "2.0.0",\n\t"tasks": []\n}':"{}"}async resolveModelReference(e){return await this.fileService.exists(e)||await this.textFileService.write(e,this.defaultResourceValue(e),{encoding:"utf8"}),this.textModelResolverService.createModelReference(e)}hasParseErrors(e,t){if(t.workspaceStandAloneConfigurationKey&&!t.key)return!1;const i=[];return(0,gr.Qc)(e,i,{allowTrailingComma:!0,allowEmptyContent:!0}),i.length>0}async validate(e,t,i,n){if(void 0!==this.configurationService.inspect(t.key).policyValue)throw this.toConfigurationEditingError(Nr.ERROR_POLICY_CONFIGURATION,e,t);const r=Pe.B.as(xe.IP.Configuration).getConfigurationProperties(),o=r[t.key]?.scope;if(!t.workspaceStandAloneConfigurationKey){if(this.configurationService.keys().default.indexOf(t.key)<0&&!xe.eU.test(t.key)&&void 0!==t.value)throw this.toConfigurationEditingError(Nr.ERROR_UNKNOWN_KEY,e,t)}if(t.workspaceStandAloneConfigurationKey&&t.workspaceStandAloneConfigurationKey!==Pn&&(e===Ar.USER_LOCAL||e===Ar.USER_REMOTE))throw this.toConfigurationEditingError(Nr.ERROR_INVALID_USER_TARGET,e,t);if((e===Ar.WORKSPACE||e===Ar.WORKSPACE_FOLDER)&&this.contextService.getWorkbenchState()===Jn.Xe.EMPTY)throw this.toConfigurationEditingError(Nr.ERROR_NO_WORKSPACE_OPENED,e,t);if(e===Ar.WORKSPACE&&!t.workspaceStandAloneConfigurationKey&&!xe.eU.test(t.key)){if(o===xe.ue.APPLICATION)throw this.toConfigurationEditingError(Nr.ERROR_INVALID_WORKSPACE_CONFIGURATION_APPLICATION,e,t);if(o===xe.ue.MACHINE)throw this.toConfigurationEditingError(Nr.ERROR_INVALID_WORKSPACE_CONFIGURATION_MACHINE,e,t)}if(e===Ar.WORKSPACE_FOLDER){if(!t.resource)throw this.toConfigurationEditingError(Nr.ERROR_INVALID_FOLDER_TARGET,e,t);if(!t.workspaceStandAloneConfigurationKey&&!xe.eU.test(t.key)&&void 0!==o&&!En.includes(o))throw this.toConfigurationEditingError(Nr.ERROR_INVALID_FOLDER_CONFIGURATION,e,t)}if(n.overrideIdentifiers?.length&&o!==xe.ue.LANGUAGE_OVERRIDABLE)throw this.toConfigurationEditingError(Nr.ERROR_INVALID_RESOURCE_LANGUAGE_CONFIGURATION,e,t);if(!t.resource)throw this.toConfigurationEditingError(Nr.ERROR_INVALID_FOLDER_TARGET,e,t);if(i&&this.textFileService.isDirty(t.resource))throw this.toConfigurationEditingError(Nr.ERROR_CONFIGURATION_FILE_DIRTY,e,t)}getConfigurationEditOperation(e,t,i){if(t.key){const n=e===Ar.USER_LOCAL?In:xn,r=Object.keys(n);for(const o of r){const r=this.getConfigurationFileResource(e,o,n[o],i.resource,void 0);if(t.key===o){const i=this.isWorkspaceConfigurationResource(r)?[o]:[];return{key:i[i.length-1],jsonPath:i,value:t.value,resource:r??void 0,workspaceStandAloneConfigurationKey:o,target:e}}const s=`${o}.`;if(0===t.key.indexOf(s)){const i=this.isWorkspaceConfigurationResource(r)?[o,t.key.substr(s.length)]:[t.key.substr(s.length)];return{key:i[i.length-1],jsonPath:i,value:t.value,resource:r??void 0,workspaceStandAloneConfigurationKey:o,target:e}}}}const n=t.key,r=Pe.B.as(xe.IP.Configuration).getConfigurationProperties(),o=r[n]?.scope;let s=i.overrideIdentifiers?.length?[(0,xe.np)(i.overrideIdentifiers),n]:[n];if(e===Ar.USER_LOCAL||e===Ar.USER_REMOTE)return{key:n,jsonPath:s,value:t.value,resource:this.getConfigurationFileResource(e,n,"",null,o)??void 0,target:e};const a=this.getConfigurationFileResource(e,n,Sn,i.resource,o);return this.isWorkspaceConfigurationResource(a)&&(s=["settings",...s]),{key:n,jsonPath:s,value:t.value,resource:a??void 0,target:e}}isWorkspaceConfigurationResource(e){const t=this.contextService.getWorkspace();return!(!t.configuration||!e||t.configuration.fsPath!==e.fsPath)}getConfigurationFileResource(e,t,i,n,r){if(e===Ar.USER_LOCAL)return t===Pn?this.userDataProfileService.currentProfile.tasksResource:!this.userDataProfileService.currentProfile.isDefault&&this.configurationService.isSettingAppliedForAllProfiles(t)?this.userDataProfilesService.defaultProfile.settingsResource:this.userDataProfileService.currentProfile.settingsResource;if(e===Ar.USER_REMOTE)return this.remoteSettingsResource;const o=this.contextService.getWorkbenchState();if(o!==Jn.Xe.EMPTY){const t=this.contextService.getWorkspace();if(e===Ar.WORKSPACE){if(o===Jn.Xe.WORKSPACE)return t.configuration??null;if(o===Jn.Xe.FOLDER)return t.folders[0].toResource(i)}if(e===Ar.WORKSPACE_FOLDER&&n){const e=this.contextService.getWorkspaceFolder(n);if(e)return e.toResource(i)}}return null}};qr=(0,O.g)([(0,O.f)(1,Er),(0,O.f)(2,mn.e),(0,O.f)(3,Mr.AP),(0,O.f)(4,pn.l),(0,O.f)(5,Le.s),(0,O.f)(6,Me.S),(0,O.f)(7,Tr.M),(0,O.f)(8,Ue.l),(0,O.f)(9,xr.U),(0,O.f)(10,Or.A),(0,O.f)(11,fn.v)],qr);var Wr=i(87884);class jr extends cr.l0{static{this.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY="DefaultOverridesCacheExists"}constructor(e,t,i){super(i),this.configurationCache=e,this.configurationRegistry=Pe.B.as(xe.IP.Configuration),this.cachedConfigurationDefaultsOverrides={},this.cacheKey={type:"defaults",key:"configurationDefaultsOverrides"},this.updateCache=!1,t.options?.configurationDefaults&&this.configurationRegistry.registerDefaultConfigurations([{overrides:t.options.configurationDefaults}])}getConfigurationDefaultOverrides(){return this.cachedConfigurationDefaultsOverrides}async initialize(){return await this.initializeCachedConfigurationDefaultsOverrides(),super.initialize()}reload(){return this.updateCache=!0,this.cachedConfigurationDefaultsOverrides={},this.updateCachedConfigurationDefaultsOverrides(),super.reload()}hasCachedConfigurationDefaultsOverrides(){return!(0,Te.Qr)(this.cachedConfigurationDefaultsOverrides)}initializeCachedConfigurationDefaultsOverrides(){return this.initiaizeCachedConfigurationDefaultsOverridesPromise||(this.initiaizeCachedConfigurationDefaultsOverridesPromise=(async()=>{try{if(localStorage.getItem(jr.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY)){const e=await this.configurationCache.read(this.cacheKey);e&&(this.cachedConfigurationDefaultsOverrides=JSON.parse(e))}}catch(e){}this.cachedConfigurationDefaultsOverrides=(0,Te.Kn)(this.cachedConfigurationDefaultsOverrides)?this.cachedConfigurationDefaultsOverrides:{}})()),this.initiaizeCachedConfigurationDefaultsOverridesPromise}onDidUpdateConfiguration(e,t){super.onDidUpdateConfiguration(e,t),t&&this.updateCachedConfigurationDefaultsOverrides()}async updateCachedConfigurationDefaultsOverrides(){if(!this.updateCache)return;const e={},t=this.configurationRegistry.getConfigurationDefaultsOverrides();for(const[i,n]of t)xe.eU.test(i)||void 0===n.value||(e[i]=n.value);try{Object.keys(e).length?(localStorage.setItem(jr.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY,"yes"),await this.configurationCache.write(this.cacheKey,JSON.stringify(e))):(localStorage.removeItem(jr.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY),await this.configurationCache.remove(this.cacheKey))}catch(e){}}}class Ur extends ar.PG{constructor(e,t,i,n){super(e.defaultProfile.settingsResource,{scopes:[xe.ue.APPLICATION]},i.extUri,t,n),this._onDidChangeConfiguration=this._register(new we.Q5),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._register(this.onDidChange((()=>this.reloadConfigurationScheduler.schedule()))),this.reloadConfigurationScheduler=this._register(new sr.pY((()=>this.loadConfiguration().then((e=>this._onDidChangeConfiguration.fire(e)))),50))}async initialize(){return this.loadConfiguration()}async loadConfiguration(){const e=await super.loadConfiguration(),t=e.getValue(Mn),i=Array.isArray(t)?t:[];return this.parseOptions.include||i.length?this.reparse({...this.parseOptions,include:i}):e}}class Kr extends s.JT{get hasTasksLoaded(){return this.userConfiguration.value instanceof $r}constructor(e,t,i,n,r,o){super(),this.settingsResource=e,this.tasksResource=t,this.configurationParseOptions=i,this.fileService=n,this.uriIdentityService=r,this.logService=o,this._onDidChangeConfiguration=this._register(new we.Q5),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.userConfiguration=this._register(new s.XK),this.userConfigurationChangeDisposable=this._register(new s.XK),this.userConfiguration.value=new ar.PG(e,this.configurationParseOptions,r.extUri,this.fileService,o),this.userConfigurationChangeDisposable.value=this.userConfiguration.value.onDidChange((()=>this.reloadConfigurationScheduler.schedule())),this.reloadConfigurationScheduler=this._register(new sr.pY((()=>this.userConfiguration.value.loadConfiguration().then((e=>this._onDidChangeConfiguration.fire(e)))),50))}async reset(e,t,i){return this.settingsResource=e,this.tasksResource=t,this.configurationParseOptions=i,this.doReset()}async doReset(e){const t=this.uriIdentityService.extUri.dirname(this.settingsResource),i=this.tasksResource?[[Pn,this.tasksResource]]:[],n=new $r(t.toString(),this.settingsResource,i,this.configurationParseOptions,this.fileService,this.uriIdentityService,this.logService),r=await n.loadConfiguration(e);return this.userConfiguration.value=n,this.userConfigurationChangeDisposable.value&&(this.userConfigurationChangeDisposable.value=this.userConfiguration.value.onDidChange((()=>this.reloadConfigurationScheduler.schedule()))),r}async initialize(){return this.userConfiguration.value.loadConfiguration()}async reload(e){return this.hasTasksLoaded?this.userConfiguration.value.loadConfiguration():this.doReset(e)}reparse(e){return this.configurationParseOptions={...this.configurationParseOptions,...e},this.userConfiguration.value.reparse(this.configurationParseOptions)}getRestrictedSettings(){return this.userConfiguration.value.getRestrictedSettings()}}class $r extends s.JT{constructor(e,t,i,n,r,o,a){super(),this.settingsResource=t,this.standAloneConfigurationResources=i,this.fileService=r,this.uriIdentityService=o,this.logService=a,this._onDidChange=this._register(new we.Q5),this.onDidChange=this._onDidChange.event,this.allResources=[this.settingsResource,...this.standAloneConfigurationResources.map((([,e])=>e))],this._register((0,s.F8)(...this.allResources.map((e=>(0,s.F8)(this.fileService.watch(o.extUri.dirname(e)),this.fileService.watch(e)))))),this._folderSettingsModelParser=new ar.wU(e,a),this._folderSettingsParseOptions=n,this._standAloneConfigurations=[],this._cache=ar.VV.createEmptyModel(this.logService),this._register(we.ju.debounce(we.ju.any(we.ju.filter(this.fileService.onDidFilesChange,(e=>this.handleFileChangesEvent(e))),we.ju.filter(this.fileService.onDidRunOperation,(e=>this.handleFileOperationEvent(e)))),(()=>{}),100)((()=>this._onDidChange.fire())))}async resolveContents(e){const t=async e=>Promise.all(e.map((async e=>{try{return(await this.fileService.readFile(e,{atomic:!0})).value.toString()}catch(t){this.logService.trace(`Error while resolving configuration file '${e.toString()}': ${(0,Y.e$)(t)}`),t.fileOperationResult!==Pr.PK.FILE_NOT_FOUND&&t.fileOperationResult!==Pr.PK.FILE_NOT_DIRECTORY&&this.logService.error(t)}return"{}"}))),[[i],n]=await Promise.all([e?Promise.resolve([void 0]):t([this.settingsResource]),t(this.standAloneConfigurationResources.map((([,e])=>e)))]);return[i,n.map(((e,t)=>[this.standAloneConfigurationResources[t][0],e]))]}async loadConfiguration(e){const[t,i]=await this.resolveContents(!!e);this._standAloneConfigurations=[],this._folderSettingsModelParser.parse("",this._folderSettingsParseOptions),void 0!==t&&this._folderSettingsModelParser.parse(t,this._folderSettingsParseOptions);for(let e=0;e<i.length;e++){const t=i[e][1];if(void 0!==t){const i=new lr(this.standAloneConfigurationResources[e][1].toString(),this.standAloneConfigurationResources[e][0],this.logService);i.parse(t),this._standAloneConfigurations.push(i.configurationModel)}}return this.consolidate(e),this._cache}getRestrictedSettings(){return this._folderSettingsModelParser.restrictedConfigurations}reparse(e){const t=this._folderSettingsModelParser.configurationModel.contents;return this._folderSettingsParseOptions=e,this._folderSettingsModelParser.reparse(this._folderSettingsParseOptions),(0,Ee.fS)(t,this._folderSettingsModelParser.configurationModel.contents)||this.consolidate(),this._cache}consolidate(e){this._cache=(e??this._folderSettingsModelParser.configurationModel).merge(...this._standAloneConfigurations)}handleFileChangesEvent(e){return!!this.allResources.some((t=>e.contains(t)))||!!this.allResources.some((t=>e.contains(this.uriIdentityService.extUri.dirname(t),Pr.zR.DELETED)))}handleFileOperationEvent(e){return!(!(e.isOperation(Pr.si.CREATE)||e.isOperation(Pr.si.COPY)||e.isOperation(Pr.si.DELETE)||e.isOperation(Pr.si.WRITE))||!this.allResources.some((t=>this.uriIdentityService.extUri.isEqual(e.resource,t))))||!(!e.isOperation(Pr.si.DELETE)||!this.allResources.some((t=>this.uriIdentityService.extUri.isEqual(e.resource,this.uriIdentityService.extUri.dirname(t)))))}}class Hr extends s.JT{constructor(e,t,i,n,r,o){super(),this._userConfigurationInitializationPromise=null,this._onDidChangeConfiguration=this._register(new we.Q5),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidInitialize=this._register(new we.Q5),this.onDidInitialize=this._onDidInitialize.event,this._fileService=i,this._userConfiguration=this._cachedConfiguration=new Vr(e,t,{scopes:Dn},o),r.getEnvironment().then((async e=>{if(e){const t=this._register(new zr(e.settingsPath,{scopes:Dn},this._fileService,n,o));this._register(t.onDidChangeConfiguration((e=>this.onDidUserConfigurationChange(e)))),this._userConfigurationInitializationPromise=t.initialize();const i=await this._userConfigurationInitializationPromise;this._userConfiguration.dispose(),this._userConfiguration=t,this.onDidUserConfigurationChange(i),this._onDidInitialize.fire(i)}}))}async initialize(){if(this._userConfiguration instanceof zr)return this._userConfiguration.initialize();let e=await this._userConfiguration.initialize();return this._userConfigurationInitializationPromise&&(e=await this._userConfigurationInitializationPromise,this._userConfigurationInitializationPromise=null),e}reload(){return this._userConfiguration.reload()}reparse(){return this._userConfiguration.reparse({scopes:Dn})}getRestrictedSettings(){return this._userConfiguration.getRestrictedSettings()}onDidUserConfigurationChange(e){this.updateCache(),this._onDidChangeConfiguration.fire(e)}async updateCache(){if(this._userConfiguration instanceof zr){let e;try{e=await this._userConfiguration.resolveContent()}catch(e){if(e.fileOperationResult!==Pr.PK.FILE_NOT_FOUND)return}await this._cachedConfiguration.updateConfiguration(e)}}}class zr extends s.JT{constructor(e,t,i,n,r){super(),this.configurationResource=e,this.fileService=i,this.uriIdentityService=n,this.logService=r,this._onDidChangeConfiguration=this._register(new we.Q5),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.fileWatcherDisposable=this._register(new s.XK),this.directoryWatcherDisposable=this._register(new s.XK),this.parser=new ar.wU(this.configurationResource.toString(),r),this.parseOptions=t,this._register(i.onDidFilesChange((e=>this.handleFileChangesEvent(e)))),this._register(i.onDidRunOperation((e=>this.handleFileOperationEvent(e)))),this.reloadConfigurationScheduler=this._register(new sr.pY((()=>this.reload().then((e=>this._onDidChangeConfiguration.fire(e)))),50)),this._register((0,s.OF)((()=>{this.stopWatchingResource(),this.stopWatchingDirectory()})))}watchResource(){this.fileWatcherDisposable.value=this.fileService.watch(this.configurationResource)}stopWatchingResource(){this.fileWatcherDisposable.value=void 0}watchDirectory(){const e=this.uriIdentityService.extUri.dirname(this.configurationResource);this.directoryWatcherDisposable.value=this.fileService.watch(e)}stopWatchingDirectory(){this.directoryWatcherDisposable.value=void 0}async initialize(){const e=await this.fileService.exists(this.configurationResource);return this.onResourceExists(e),this.reload()}async resolveContent(){return(await this.fileService.readFile(this.configurationResource,{atomic:!0})).value.toString()}async reload(){try{const e=await this.resolveContent();return this.parser.parse(e,this.parseOptions),this.parser.configurationModel}catch(e){return ar.VV.createEmptyModel(this.logService)}}reparse(e){return this.parseOptions=e,this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}handleFileChangesEvent(e){let t=e.contains(this.configurationResource,Pr.zR.UPDATED);e.contains(this.configurationResource,Pr.zR.ADDED)?(t=!0,this.onResourceExists(!0)):e.contains(this.configurationResource,Pr.zR.DELETED)&&(t=!0,this.onResourceExists(!1)),t&&this.reloadConfigurationScheduler.schedule()}handleFileOperationEvent(e){(e.isOperation(Pr.si.CREATE)||e.isOperation(Pr.si.COPY)||e.isOperation(Pr.si.DELETE)||e.isOperation(Pr.si.WRITE))&&this.uriIdentityService.extUri.isEqual(e.resource,this.configurationResource)&&this.reloadConfigurationScheduler.schedule()}onResourceExists(e){e?(this.stopWatchingDirectory(),this.watchResource()):(this.stopWatchingResource(),this.watchDirectory())}}class Vr extends s.JT{constructor(e,t,i,n){super(),this.configurationCache=t,this._onDidChange=this._register(new we.Q5),this.onDidChange=this._onDidChange.event,this.key={type:"user",key:e},this.parser=new ar.wU("CachedRemoteUserConfiguration",n),this.parseOptions=i,this.configurationModel=ar.VV.createEmptyModel(n)}getConfigurationModel(){return this.configurationModel}initialize(){return this.reload()}reparse(e){return this.parseOptions=e,this.parser.reparse(this.parseOptions),this.configurationModel=this.parser.configurationModel,this.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}async reload(){try{const e=await this.configurationCache.read(this.key),t=JSON.parse(e);t.content&&(this.parser.parse(t.content,this.parseOptions),this.configurationModel=this.parser.configurationModel)}catch(e){}return this.configurationModel}async updateConfiguration(e){return e?this.configurationCache.write(this.key,JSON.stringify({content:e})):this.configurationCache.remove(this.key)}}class Br extends s.JT{get initialized(){return this._initialized}constructor(e,t,i,n){super(),this.configurationCache=e,this.fileService=t,this.uriIdentityService=i,this.logService=n,this._workspaceConfigurationDisposables=this._register(new s.SL),this._workspaceIdentifier=null,this._isWorkspaceTrusted=!1,this._onDidUpdateConfiguration=this._register(new we.Q5),this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this._initialized=!1,this.fileService=t,this._workspaceConfiguration=this._cachedConfiguration=new Gr(e,n)}async initialize(e,t){this._workspaceIdentifier=e,this._isWorkspaceTrusted=t,this._initialized||(this.configurationCache.needsCaching(this._workspaceIdentifier.configPath)?(this._workspaceConfiguration=this._cachedConfiguration,this.waitAndInitialize(this._workspaceIdentifier)):this.doInitialize(new Jr(this.fileService,this.uriIdentityService,this.logService))),await this.reload()}async reload(){this._workspaceIdentifier&&await this._workspaceConfiguration.load(this._workspaceIdentifier,{scopes:Tn,skipRestricted:this.isUntrusted()})}getFolders(){return this._workspaceConfiguration.getFolders()}setFolders(e,t){return this._workspaceIdentifier?t.write(this._workspaceIdentifier.configPath,[{path:["folders"],value:e}],!0).then((()=>this.reload())):Promise.resolve()}isTransient(){return this._workspaceConfiguration.isTransient()}getConfiguration(){return this._workspaceConfiguration.getWorkspaceSettings()}updateWorkspaceTrust(e){return this._isWorkspaceTrusted=e,this.reparseWorkspaceSettings()}reparseWorkspaceSettings(){return this._workspaceConfiguration.reparseWorkspaceSettings({scopes:Tn,skipRestricted:this.isUntrusted()}),this.getConfiguration()}getRestrictedSettings(){return this._workspaceConfiguration.getRestrictedSettings()}async waitAndInitialize(e){if(await(0,Pr.vP)(e.configPath,this.fileService),!(this._workspaceConfiguration instanceof Jr)){const t=this._register(new Jr(this.fileService,this.uriIdentityService,this.logService));await t.load(e,{scopes:Tn,skipRestricted:this.isUntrusted()}),this.doInitialize(t),this.onDidWorkspaceConfigurationChange(!1,!0)}}doInitialize(e){this._workspaceConfigurationDisposables.clear(),this._workspaceConfiguration=this._workspaceConfigurationDisposables.add(e),this._workspaceConfigurationDisposables.add(this._workspaceConfiguration.onDidChange((e=>this.onDidWorkspaceConfigurationChange(!0,!1)))),this._initialized=!0}isUntrusted(){return!this._isWorkspaceTrusted}async onDidWorkspaceConfigurationChange(e,t){e&&await this.reload(),this.updateCache(),this._onDidUpdateConfiguration.fire(t)}async updateCache(){if(this._workspaceIdentifier&&this.configurationCache.needsCaching(this._workspaceIdentifier.configPath)&&this._workspaceConfiguration instanceof Jr){const e=await this._workspaceConfiguration.resolveContent(this._workspaceIdentifier);await this._cachedConfiguration.updateWorkspace(this._workspaceIdentifier,e)}}}class Jr extends s.JT{constructor(e,t,i){super(),this.fileService=e,this.logService=i,this._workspaceIdentifier=null,this._onDidChange=this._register(new we.Q5),this.onDidChange=this._onDidChange.event,this.workspaceConfigurationModelParser=new ur("",i),this.workspaceSettings=ar.VV.createEmptyModel(i),this._register(we.ju.any(we.ju.filter(this.fileService.onDidFilesChange,(e=>!!this._workspaceIdentifier&&e.contains(this._workspaceIdentifier.configPath))),we.ju.filter(this.fileService.onDidRunOperation,(e=>!!this._workspaceIdentifier&&(e.isOperation(Pr.si.CREATE)||e.isOperation(Pr.si.COPY)||e.isOperation(Pr.si.DELETE)||e.isOperation(Pr.si.WRITE))&&t.extUri.isEqual(e.resource,this._workspaceIdentifier.configPath))))((()=>this.reloadConfigurationScheduler.schedule()))),this.reloadConfigurationScheduler=this._register(new sr.pY((()=>this._onDidChange.fire()),50)),this.workspaceConfigWatcher=this._register(this.watchWorkspaceConfigurationFile())}get workspaceIdentifier(){return this._workspaceIdentifier}async resolveContent(e){return(await this.fileService.readFile(e.configPath,{atomic:!0})).value.toString()}async load(e,t){this._workspaceIdentifier&&this._workspaceIdentifier.id===e.id||(this._workspaceIdentifier=e,this.workspaceConfigurationModelParser=new ur(this._workspaceIdentifier.id,this.logService),(0,s.B9)(this.workspaceConfigWatcher),this.workspaceConfigWatcher=this._register(this.watchWorkspaceConfigurationFile()));let i="";try{i=await this.resolveContent(this._workspaceIdentifier)}catch(e){await this.fileService.exists(this._workspaceIdentifier.configPath)&&this.logService.error(e)}this.workspaceConfigurationModelParser.parse(i,t),this.consolidate()}getConfigurationModel(){return this.workspaceConfigurationModelParser.configurationModel}getFolders(){return this.workspaceConfigurationModelParser.folders}isTransient(){return this.workspaceConfigurationModelParser.transient}getWorkspaceSettings(){return this.workspaceSettings}reparseWorkspaceSettings(e){return this.workspaceConfigurationModelParser.reparseWorkspaceSettings(e),this.consolidate(),this.getWorkspaceSettings()}getRestrictedSettings(){return this.workspaceConfigurationModelParser.getRestrictedWorkspaceSettings()}consolidate(){this.workspaceSettings=this.workspaceConfigurationModelParser.settingsModel.merge(this.workspaceConfigurationModelParser.launchModel,this.workspaceConfigurationModelParser.tasksModel)}watchWorkspaceConfigurationFile(){return this._workspaceIdentifier?this.fileService.watch(this._workspaceIdentifier.configPath):s.JT.None}}class Gr{constructor(e,t){this.configurationCache=e,this.logService=t,this.onDidChange=we.ju.None,this.workspaceConfigurationModelParser=new ur("",t),this.workspaceSettings=ar.VV.createEmptyModel(t)}async load(e,t){try{const i=this.getKey(e),n=await this.configurationCache.read(i),r=JSON.parse(n);r.content&&(this.workspaceConfigurationModelParser=new ur(i.key,this.logService),this.workspaceConfigurationModelParser.parse(r.content,t),this.consolidate())}catch(e){}}get workspaceIdentifier(){return null}getConfigurationModel(){return this.workspaceConfigurationModelParser.configurationModel}getFolders(){return this.workspaceConfigurationModelParser.folders}isTransient(){return this.workspaceConfigurationModelParser.transient}getWorkspaceSettings(){return this.workspaceSettings}reparseWorkspaceSettings(e){return this.workspaceConfigurationModelParser.reparseWorkspaceSettings(e),this.consolidate(),this.getWorkspaceSettings()}getRestrictedSettings(){return this.workspaceConfigurationModelParser.getRestrictedWorkspaceSettings()}consolidate(){this.workspaceSettings=this.workspaceConfigurationModelParser.settingsModel.merge(this.workspaceConfigurationModelParser.launchModel,this.workspaceConfigurationModelParser.tasksModel)}async updateWorkspace(e,t){try{const i=this.getKey(e);t?await this.configurationCache.write(i,JSON.stringify({content:t})):await this.configurationCache.remove(i)}catch(e){}}getKey(e){return{type:"workspaces",key:e.id}}}class Yr{constructor(e,t,i,n,r){this.configurationCache=n,this.logService=r,this.onDidChange=we.ju.None,this.key={type:"folder",key:(0,Wr.vp)((0,Yn.Vo)(e,t).toString()).toString(16)},this._folderSettingsModelParser=new ar.wU("CachedFolderConfiguration",r),this._folderSettingsParseOptions=i,this._standAloneConfigurations=[],this.configurationModel=ar.VV.createEmptyModel(r)}async loadConfiguration(){try{const e=await this.configurationCache.read(this.key),{content:t}=JSON.parse(e.toString());if(t)for(const e of Object.keys(t))if(e===wn)this._folderSettingsModelParser.parse(t[e],this._folderSettingsParseOptions);else{const i=new lr(e,e,this.logService);i.parse(t[e]),this._standAloneConfigurations.push(i.configurationModel)}this.consolidate()}catch(e){}return this.configurationModel}async updateConfiguration(e,t){const i={};e&&(i[wn]=e),t.forEach((([e,t])=>{t&&(i[e]=t)})),Object.keys(i).length?await this.configurationCache.write(this.key,JSON.stringify({content:i})):await this.configurationCache.remove(this.key)}getRestrictedSettings(){return this._folderSettingsModelParser.restrictedConfigurations}reparse(e){return this._folderSettingsParseOptions=e,this._folderSettingsModelParser.reparse(this._folderSettingsParseOptions),this.consolidate(),this.configurationModel}consolidate(){this.configurationModel=this._folderSettingsModelParser.configurationModel.merge(...this._standAloneConfigurations)}getUnsupportedKeys(){return[]}}class Xr extends s.JT{constructor(e,t,i,n,r,o,s,a,c){super(),this.workspaceFolder=t,this.workbenchState=n,this.workspaceTrusted=r,this.configurationCache=c,this._onDidChange=this._register(new we.Q5),this.onDidChange=this._onDidChange.event,this.scopes=Jn.Xe.WORKSPACE===this.workbenchState?En:Tn,this.configurationFolder=s.extUri.joinPath(t.uri,i),this.cachedFolderConfiguration=new Yr(t.uri,i,{scopes:this.scopes,skipRestricted:this.isUntrusted()},c,a),e&&this.configurationCache.needsCaching(t.uri)?(this.folderConfiguration=this.cachedFolderConfiguration,(0,Pr.vP)(t.uri,o).then((()=>{this.folderConfiguration=this._register(this.createFileServiceBasedConfiguration(o,s,a)),this._register(this.folderConfiguration.onDidChange((e=>this.onDidFolderConfigurationChange()))),this.onDidFolderConfigurationChange()}))):(this.folderConfiguration=this._register(this.createFileServiceBasedConfiguration(o,s,a)),this._register(this.folderConfiguration.onDidChange((e=>this.onDidFolderConfigurationChange()))))}loadConfiguration(){return this.folderConfiguration.loadConfiguration()}updateWorkspaceTrust(e){return this.workspaceTrusted=e,this.reparse()}reparse(){const e=this.folderConfiguration.reparse({scopes:this.scopes,skipRestricted:this.isUntrusted()});return this.updateCache(),e}getRestrictedSettings(){return this.folderConfiguration.getRestrictedSettings()}isUntrusted(){return!this.workspaceTrusted}onDidFolderConfigurationChange(){this.updateCache(),this._onDidChange.fire()}createFileServiceBasedConfiguration(e,t,i){const n=t.extUri.joinPath(this.configurationFolder,`${wn}.json`),r=[Pn,On].map((e=>[e,t.extUri.joinPath(this.configurationFolder,`${e}.json`)]));return new $r(this.configurationFolder.toString(),n,r,{scopes:this.scopes,skipRestricted:this.isUntrusted()},e,t,i)}async updateCache(){if(this.configurationCache.needsCaching(this.configurationFolder)&&this.folderConfiguration instanceof $r){const[e,t]=await this.folderConfiguration.resolveContents();this.cachedFolderConfiguration.updateConfiguration(e,t)}}}var Qr=i(61826),Zr=i(79507),eo=i(35798),to=i(36994),io=i(84030),no=i(13377),ro=i(84608),oo=i(97135),so=i(3284),ao=i(55406);const co="vs/workbench/services/configuration/browser/configurationService";function uo(e,t){return e.isDefault||e.useDefaultFlags?.settings?t?kn:void 0:t?bn:_n}class lo extends Jn.j${constructor(){super(...arguments),this.initialized=!1}}class ho extends s.JT{get restrictedSettings(){return this._restrictedSettings}constructor({remoteAuthority:e,configurationCache:t},i,n,r,o,a,c,u,l){if(super(),this.userDataProfileService=n,this.userDataProfilesService=r,this.fileService=o,this.remoteAgentService=a,this.uriIdentityService=c,this.logService=u,this.initialized=!1,this.applicationConfiguration=null,this.remoteUserConfiguration=null,this._onDidChangeConfiguration=this._register(new we.Q5),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeWorkspaceFolders=this._register(new we.Q5),this.onWillChangeWorkspaceFolders=this._onWillChangeWorkspaceFolders.event,this._onDidChangeWorkspaceFolders=this._register(new we.Q5),this.onDidChangeWorkspaceFolders=this._onDidChangeWorkspaceFolders.event,this._onDidChangeWorkspaceName=this._register(new we.Q5),this.onDidChangeWorkspaceName=this._onDidChangeWorkspaceName.event,this._onDidChangeWorkbenchState=this._register(new we.Q5),this.onDidChangeWorkbenchState=this._onDidChangeWorkbenchState.event,this.isWorkspaceTrusted=!0,this._restrictedSettings={default:[]},this._onDidChangeRestrictedSettings=this._register(new we.Q5),this.onDidChangeRestrictedSettings=this._onDidChangeRestrictedSettings.event,this.configurationRegistry=Pe.B.as(xe.IP.Configuration),this.initRemoteUserConfigurationBarrier=new sr.U8,this.completeWorkspaceBarrier=new sr.U8,this.defaultConfiguration=this._register(new jr(t,i,u)),this.policyConfiguration=l instanceof oo.j?new cr.ET:this._register(new cr.im(this.defaultConfiguration,l,u)),this.configurationCache=t,this._configuration=new dr(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,ar.VV.createEmptyModel(u),ar.VV.createEmptyModel(u),ar.VV.createEmptyModel(u),ar.VV.createEmptyModel(u),new or.Y9,ar.VV.createEmptyModel(u),new or.Y9,this.workspace,u),this.applicationConfigurationDisposables=this._register(new s.SL),this.createApplicationConfiguration(),this.localUserConfiguration=this._register(new Kr(n.currentProfile.settingsResource,n.currentProfile.tasksResource,{scopes:uo(n.currentProfile,!!e)},o,c,u)),this.cachedFolderConfigs=new or.Y9,this._register(this.localUserConfiguration.onDidChangeConfiguration((e=>this.onLocalUserConfigurationChanged(e)))),e){const i=this.remoteUserConfiguration=this._register(new Hr(e,t,o,c,a,u));this._register(i.onDidInitialize((e=>{this._register(i.onDidChangeConfiguration((e=>this.onRemoteUserConfigurationChanged(e)))),this.onRemoteUserConfigurationChanged(e),this.initRemoteUserConfigurationBarrier.open()})))}else this.initRemoteUserConfigurationBarrier.open();this.workspaceConfiguration=this._register(new Br(t,o,c,u)),this._register(this.workspaceConfiguration.onDidUpdateConfiguration((e=>{this.onWorkspaceConfigurationChanged(e).then((()=>{this.workspace.initialized=this.workspaceConfiguration.initialized,this.checkAndMarkWorkspaceComplete(e)}))}))),this._register(this.defaultConfiguration.onDidChangeConfiguration((({properties:e,defaults:t})=>this.onDefaultConfigurationChanged(t,e)))),this._register(this.policyConfiguration.onDidChangeConfiguration((e=>this.onPolicyConfigurationChanged(e)))),this._register(n.onDidChangeCurrentProfile((e=>this.onUserDataProfileChanged(e)))),this.workspaceEditingQueue=new sr.ci}createApplicationConfiguration(){this.applicationConfigurationDisposables.clear(),this.userDataProfileService.currentProfile.isDefault||this.userDataProfileService.currentProfile.useDefaultFlags?.settings?this.applicationConfiguration=null:(this.applicationConfiguration=this.applicationConfigurationDisposables.add(this._register(new Ur(this.userDataProfilesService,this.fileService,this.uriIdentityService,this.logService))),this.applicationConfigurationDisposables.add(this.applicationConfiguration.onDidChangeConfiguration((e=>this.onApplicationConfigurationChanged(e)))))}async getCompleteWorkspace(){return await this.completeWorkspaceBarrier.wait(),this.getWorkspace()}getWorkspace(){return this.workspace}getWorkbenchState(){return this.workspace.configuration?Jn.Xe.WORKSPACE:1===this.workspace.folders.length?Jn.Xe.FOLDER:Jn.Xe.EMPTY}getWorkspaceFolder(e){return this.workspace.getFolder(e)}addFolders(e,t){return this.updateFolders(e,[],t)}removeFolders(e){return this.updateFolders([],e)}async updateFolders(e,t,i){return this.workspaceEditingQueue.queue((()=>this.doUpdateFolders(e,t,i)))}isInsideWorkspace(e){return!!this.getWorkspaceFolder(e)}isCurrentWorkspace(e){switch(this.getWorkbenchState()){case Jn.Xe.FOLDER:{let t;return c.ov.isUri(e)?t=e:(0,Jn.eb)(e)&&(t=e.uri),c.ov.isUri(t)&&this.uriIdentityService.extUri.isEqual(t,this.workspace.folders[0].uri)}case Jn.Xe.WORKSPACE:return(0,Jn.NI)(e)&&this.workspace.id===e.id}return!1}async doUpdateFolders(e,t,i){if(this.getWorkbenchState()!==Jn.Xe.WORKSPACE)return Promise.resolve(void 0);if(e.length+t.length===0)return Promise.resolve(void 0);let n=!1,r=this.getWorkspace().folders,o=r.map((e=>e.raw)).filter(((e,i)=>!wr(e)||!this.contains(t,r[i].uri)));if(n=r.length!==o.length,e.length){const t=this.getWorkspace().configuration,s=this.uriIdentityService.extUri.dirname(t);r=kr(o,t,this.uriIdentityService.extUri);const a=r.map((e=>e.uri)),c=[];for(const t of e){const e=t.uri;if(!this.contains(a,e)){try{if(!(await this.fileService.stat(e)).isDirectory)continue}catch(e){}c.push(_r(e,!1,t.name,s,this.uriIdentityService.extUri))}}c.length>0&&(n=!0,"number"==typeof i&&i>=0&&i<o.length?(o=o.slice(0),o.splice(i,0,...c)):o=[...o,...c])}return n?this.setFolders(o):Promise.resolve(void 0)}async setFolders(e){if(!this.instantiationService)throw new Error("Cannot update workspace folders because workspace service is not yet ready to accept writes.");return await this.instantiationService.invokeFunction((t=>this.workspaceConfiguration.setFolders(e,t.get(so.R)))),this.onWorkspaceConfigurationChanged(!1)}contains(e,t){return e.some((e=>this.uriIdentityService.extUri.isEqual(e,t)))}getConfigurationData(){return this._configuration.toData()}getValue(e,t){const i="string"==typeof e?e:void 0,n=(0,dn.Rw)(e)?e:(0,dn.Rw)(t)?t:void 0;return this._configuration.getValue(i,n)}async updateValue(e,t,i,n,r){const o=(0,dn.BG)(i)?i:(0,dn.Rw)(i)?{resource:i.resource,overrideIdentifiers:i.overrideIdentifier?[i.overrideIdentifier]:void 0}:void 0,s=o?n:i,a=s?[s]:[];if(o?.overrideIdentifiers&&(o.overrideIdentifiers=(0,z.EB)(o.overrideIdentifiers),o.overrideIdentifiers=o.overrideIdentifiers.length?o.overrideIdentifiers:void 0),!a.length){if(o?.overrideIdentifiers&&o.overrideIdentifiers.length>1)throw new Error("Configuration Target is required while updating the value for multiple override identifiers");const i=this.inspect(e,{resource:o?.resource,overrideIdentifier:o?.overrideIdentifiers?o.overrideIdentifiers[0]:void 0});a.push(...this.deriveConfigurationTargets(e,t,i)),!(0,Ee.fS)(t,i.defaultValue)||1!==a.length||a[0]!==dn.JD.USER&&a[0]!==dn.JD.USER_LOCAL||(t=void 0)}await sr.jT.settled(a.map((i=>this.writeConfigurationValue(e,t,i,o,r))))}async reloadConfiguration(e){if(void 0===e){this.reloadDefaultConfiguration();const e=await this.reloadApplicationConfiguration(!0),{local:t,remote:i}=await this.reloadUserConfiguration();return await this.reloadWorkspaceConfiguration(),void await this.loadConfiguration(e,t,i,!0)}if((0,Jn.dV)(e))await this.reloadWorkspaceFolderConfiguration(e);else switch(e){case dn.JD.DEFAULT:return void this.reloadDefaultConfiguration();case dn.JD.USER:{const{local:e,remote:t}=await this.reloadUserConfiguration();return void await this.loadConfiguration(this._configuration.applicationConfiguration,e,t,!0)}case dn.JD.USER_LOCAL:return void await this.reloadLocalUserConfiguration();case dn.JD.USER_REMOTE:return void await this.reloadRemoteUserConfiguration();case dn.JD.WORKSPACE:case dn.JD.WORKSPACE_FOLDER:return void await this.reloadWorkspaceConfiguration()}}hasCachedConfigurationDefaultsOverrides(){return this.defaultConfiguration.hasCachedConfigurationDefaultsOverrides()}inspect(e,t){return this._configuration.inspect(e,t)}keys(){return this._configuration.keys()}async whenRemoteConfigurationLoaded(){await this.initRemoteUserConfigurationBarrier.wait()}async initialize(e){(0,Qr.B)("code/willInitWorkspaceService");const t=this.initialized;this.initialized=!1;const i=await this.createWorkspace(e);await this.updateWorkspaceAndInitializeConfiguration(i,t),this.checkAndMarkWorkspaceComplete(!1),(0,Qr.B)("code/didInitWorkspaceService")}updateWorkspaceTrust(e){if(this.isWorkspaceTrusted!==e){this.isWorkspaceTrusted=e;const t=this._configuration.toData(),i=[];for(const e of this.workspace.folders){const t=this.cachedFolderConfigs.get(e.uri);let n;t&&(n=t.updateWorkspaceTrust(this.isWorkspaceTrusted),this._configuration.updateFolderConfiguration(e.uri,n)),i.push(n)}this.getWorkbenchState()===Jn.Xe.FOLDER?i[0]&&this._configuration.updateWorkspaceConfiguration(i[0]):this._configuration.updateWorkspaceConfiguration(this.workspaceConfiguration.updateWorkspaceTrust(this.isWorkspaceTrusted)),this.updateRestrictedSettings();let n=[];this.restrictedSettings.userLocal&&n.push(...this.restrictedSettings.userLocal),this.restrictedSettings.userRemote&&n.push(...this.restrictedSettings.userRemote),this.restrictedSettings.workspace&&n.push(...this.restrictedSettings.workspace),this.restrictedSettings.workspaceFolder?.forEach((e=>n.push(...e))),n=(0,z.EB)(n),n.length&&this.triggerConfigurationChange({keys:n,overrides:[]},{data:t,workspace:this.workspace},dn.JD.WORKSPACE)}}acquireInstantiationService(e){this.instantiationService=e}isSettingAppliedForAllProfiles(e){if(this.configurationRegistry.getConfigurationProperties()[e]?.scope===xe.ue.APPLICATION)return!0;const t=this.getValue(Mn)??[];return Array.isArray(t)&&t.includes(e)}async createWorkspace(e){return(0,Jn.NI)(e)?this.createMultiFolderWorkspace(e):(0,Jn.eb)(e)?this.createSingleFolderWorkspace(e):this.createEmptyWorkspace(e)}async createMultiFolderWorkspace(e){await this.workspaceConfiguration.initialize({id:e.id,configPath:e.configPath},this.isWorkspaceTrusted);const t=e.configPath,i=kr(this.workspaceConfiguration.getFolders(),t,this.uriIdentityService.extUri),n=e.id,r=new lo(n,i,this.workspaceConfiguration.isTransient(),t,(e=>this.uriIdentityService.extUri.ignorePathCasing(e)));return r.initialized=this.workspaceConfiguration.initialized,r}createSingleFolderWorkspace(e){const t=new lo(e.id,[(0,Jn.fY)(e.uri)],!1,null,(e=>this.uriIdentityService.extUri.ignorePathCasing(e)));return t.initialized=!0,t}createEmptyWorkspace(e){const t=new lo(e.id,[],!1,null,(e=>this.uriIdentityService.extUri.ignorePathCasing(e)));return t.initialized=!0,Promise.resolve(t)}checkAndMarkWorkspaceComplete(e){!this.completeWorkspaceBarrier.isOpen()&&this.workspace.initialized&&(this.completeWorkspaceBarrier.open(),this.validateWorkspaceFoldersAndReload(e))}async updateWorkspaceAndInitializeConfiguration(e,t){const i=!!this.workspace;let n,r,s=[];if(i?(n=this.getWorkbenchState(),r=this.workspace.configuration?this.workspace.configuration.fsPath:void 0,s=this.workspace.folders,this.workspace.update(e)):this.workspace=e,await this.initializeConfiguration(t),i){const e=this.getWorkbenchState();n&&e!==n&&this._onDidChangeWorkbenchState.fire(e);const t=this.workspace.configuration?this.workspace.configuration.fsPath:void 0;(r&&t!==r||e!==n)&&this._onDidChangeWorkspaceName.fire();const i=this.compareFolders(s,this.workspace.folders);i&&(i.added.length||i.removed.length||i.changed.length)&&(await this.handleWillChangeWorkspaceFolders(i,!1),this._onDidChangeWorkspaceFolders.fire(i))}this.localUserConfiguration.hasTasksLoaded||this._register((0,B.se)(o.Ex,(()=>this.reloadLocalUserConfiguration(!1,this._configuration.localUserConfiguration))))}compareFolders(e,t){const i={added:[],removed:[],changed:[]};i.added=t.filter((t=>!e.some((e=>t.uri.toString()===e.uri.toString()))));for(let n=0;n<e.length;n++){const r=e[n];let o=0;for(o=0;o<t.length&&r.uri.toString()!==t[o].uri.toString();o++);o<t.length?n===o&&r.name===t[o].name||i.changed.push(r):i.removed.push(r)}return i}async initializeConfiguration(e){await this.defaultConfiguration.initialize();const t=this.policyConfiguration.initialize(),i=this.applicationConfiguration?this.applicationConfiguration.initialize():Promise.resolve(ar.VV.createEmptyModel(this.logService)),[,n,[r,o]]=await Promise.all([t,i,(async()=>{(0,Qr.B)("code/willInitUserConfiguration");const e=await Promise.all([this.localUserConfiguration.initialize(),this.remoteUserConfiguration?this.remoteUserConfiguration.initialize():Promise.resolve(ar.VV.createEmptyModel(this.logService))]);if(this.applicationConfiguration){const t=await i;e[0]=this.localUserConfiguration.reparse({exclude:t.getValue(Mn)})}return(0,Qr.B)("code/didInitUserConfiguration"),e})()]);(0,Qr.B)("code/willInitWorkspaceConfiguration"),await this.loadConfiguration(n,r,o,e),(0,Qr.B)("code/didInitWorkspaceConfiguration")}reloadDefaultConfiguration(){this.onDefaultConfigurationChanged(this.defaultConfiguration.reload())}async reloadApplicationConfiguration(e){if(!this.applicationConfiguration)return ar.VV.createEmptyModel(this.logService);const t=await this.applicationConfiguration.loadConfiguration();return e||this.onApplicationConfigurationChanged(t),t}async reloadUserConfiguration(){const[e,t]=await Promise.all([this.reloadLocalUserConfiguration(!0),this.reloadRemoteUserConfiguration(!0)]);return{local:e,remote:t}}async reloadLocalUserConfiguration(e,t){const i=await this.localUserConfiguration.reload(t);return e||this.onLocalUserConfigurationChanged(i),i}async reloadRemoteUserConfiguration(e){if(this.remoteUserConfiguration){const t=await this.remoteUserConfiguration.reload();return e||this.onRemoteUserConfigurationChanged(t),t}return ar.VV.createEmptyModel(this.logService)}async reloadWorkspaceConfiguration(){const e=this.getWorkbenchState();return e===Jn.Xe.FOLDER?this.onWorkspaceFolderConfigurationChanged(this.workspace.folders[0]):e===Jn.Xe.WORKSPACE?this.workspaceConfiguration.reload().then((()=>this.onWorkspaceConfigurationChanged(!1))):void 0}reloadWorkspaceFolderConfiguration(e){return this.onWorkspaceFolderConfigurationChanged(e)}async loadConfiguration(e,t,i,n){this.cachedFolderConfigs=new or.Y9;const r=this.workspace.folders,o=await this.loadFolderConfigurations(r),s=this.getWorkspaceConfigurationModel(o),a=new or.Y9;o.forEach(((e,t)=>a.set(r[t].uri,e)));const c=this._configuration;if(this._configuration=new dr(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,e,t,i,s,a,ar.VV.createEmptyModel(this.logService),new or.Y9,this.workspace,this.logService),this.initialized=!0,n){const e=this._configuration.compare(c);this.triggerConfigurationChange(e,{data:c.toData(),workspace:this.workspace},dn.JD.WORKSPACE)}this.updateRestrictedSettings()}getWorkspaceConfigurationModel(e){switch(this.getWorkbenchState()){case Jn.Xe.FOLDER:return e[0];case Jn.Xe.WORKSPACE:return this.workspaceConfiguration.getConfiguration();default:return ar.VV.createEmptyModel(this.logService)}}onUserDataProfileChanged(e){e.join((async()=>{const t=[];t.push(this.localUserConfiguration.reset(e.profile.settingsResource,e.profile.tasksResource,{scopes:uo(e.profile,!!this.remoteUserConfiguration)})),e.previous.isDefault===e.profile.isDefault&&!!e.previous.useDefaultFlags?.settings==!!e.profile.useDefaultFlags?.settings||(this.createApplicationConfiguration(),this.applicationConfiguration&&t.push(this.reloadApplicationConfiguration(!0)));let[i,n]=await Promise.all(t);n=n??this._configuration.applicationConfiguration,this.applicationConfiguration&&(i=this.localUserConfiguration.reparse({exclude:n.getValue(Mn)})),await this.loadConfiguration(n,i,this._configuration.remoteUserConfiguration,!0)})())}onDefaultConfigurationChanged(e,t){if(this.workspace){const i=this._configuration.toData(),n=this._configuration.compareAndUpdateDefaultConfiguration(e,t);if(this.applicationConfiguration&&this._configuration.updateApplicationConfiguration(this.applicationConfiguration.reparse()),this.remoteUserConfiguration&&(this._configuration.updateLocalUserConfiguration(this.localUserConfiguration.reparse()),this._configuration.updateRemoteUserConfiguration(this.remoteUserConfiguration.reparse())),this.getWorkbenchState()===Jn.Xe.FOLDER){const e=this.cachedFolderConfigs.get(this.workspace.folders[0].uri);e&&(this._configuration.updateWorkspaceConfiguration(e.reparse()),this._configuration.updateFolderConfiguration(this.workspace.folders[0].uri,e.reparse()))}else{this._configuration.updateWorkspaceConfiguration(this.workspaceConfiguration.reparseWorkspaceSettings());for(const e of this.workspace.folders){const t=this.cachedFolderConfigs.get(e.uri);t&&this._configuration.updateFolderConfiguration(e.uri,t.reparse())}}this.triggerConfigurationChange(n,{data:i,workspace:this.workspace},dn.JD.DEFAULT),this.updateRestrictedSettings()}}onPolicyConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},i=this._configuration.compareAndUpdatePolicyConfiguration(e);this.triggerConfigurationChange(i,t,dn.JD.DEFAULT)}onApplicationConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},i=this._configuration.applicationConfiguration.getValue(Mn)??[],n=this._configuration.compareAndUpdateApplicationConfiguration(e),r=this.getValue(Mn)??[],o=this.configurationRegistry.getConfigurationProperties(),s=[];for(const e of n.keys)if(o[e]?.scope===xe.ue.APPLICATION){if(s.push(e),e===Mn){for(const e of i)r.includes(e)||s.push(e);for(const e of r)i.includes(e)||s.push(e)}}else r.includes(e)&&s.push(e);n.keys=s,n.keys.includes(Mn)&&this._configuration.updateLocalUserConfiguration(this.localUserConfiguration.reparse({exclude:r})),this.triggerConfigurationChange(n,t,dn.JD.USER)}onLocalUserConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},i=this._configuration.compareAndUpdateLocalUserConfiguration(e);this.triggerConfigurationChange(i,t,dn.JD.USER)}onRemoteUserConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},i=this._configuration.compareAndUpdateRemoteUserConfiguration(e);this.triggerConfigurationChange(i,t,dn.JD.USER)}async onWorkspaceConfigurationChanged(e){if(this.workspace&&this.workspace.configuration){let t=kr(this.workspaceConfiguration.getFolders(),this.workspace.configuration,this.uriIdentityService.extUri);if(this.workspace.initialized){const{added:e,removed:i,changed:n}=this.compareFolders(this.workspace.folders,t);t=e.length||i.length||n.length?await this.toValidWorkspaceFolders(t):this.workspace.folders}await this.updateWorkspaceConfiguration(t,this.workspaceConfiguration.getConfiguration(),e)}}updateRestrictedSettings(){const e=[],t=this.configurationRegistry.getConfigurationProperties(),i=Object.keys(t).filter((e=>t[e].restricted)).sort(((e,t)=>e.localeCompare(t))),n=(0,z.pY)(i,this._restrictedSettings.default,((e,t)=>e.localeCompare(t)));e.push(...n.added,...n.removed);const r=(this.applicationConfiguration?.getRestrictedSettings()||[]).sort(((e,t)=>e.localeCompare(t))),o=(0,z.pY)(r,this._restrictedSettings.application||[],((e,t)=>e.localeCompare(t)));e.push(...o.added,...o.removed);const s=this.localUserConfiguration.getRestrictedSettings().sort(((e,t)=>e.localeCompare(t))),a=(0,z.pY)(s,this._restrictedSettings.userLocal||[],((e,t)=>e.localeCompare(t)));e.push(...a.added,...a.removed);const c=(this.remoteUserConfiguration?.getRestrictedSettings()||[]).sort(((e,t)=>e.localeCompare(t))),u=(0,z.pY)(c,this._restrictedSettings.userRemote||[],((e,t)=>e.localeCompare(t)));e.push(...u.added,...u.removed);const l=new or.Y9;for(const t of this.workspace.folders){const i=this.cachedFolderConfigs.get(t.uri),n=(i?.getRestrictedSettings()||[]).sort(((e,t)=>e.localeCompare(t)));n.length&&l.set(t.uri,n);const r=this._restrictedSettings.workspaceFolder?.get(t.uri)||[],o=(0,z.pY)(n,r,((e,t)=>e.localeCompare(t)));e.push(...o.added,...o.removed)}const d=this.getWorkbenchState()===Jn.Xe.WORKSPACE?this.workspaceConfiguration.getRestrictedSettings().sort(((e,t)=>e.localeCompare(t))):this.workspace.folders[0]&&l.get(this.workspace.folders[0].uri)||[],h=(0,z.pY)(d,this._restrictedSettings.workspace||[],((e,t)=>e.localeCompare(t)));e.push(...h.added,...h.removed),e.length&&(this._restrictedSettings={default:i,application:r.length?r:void 0,userLocal:s.length?s:void 0,userRemote:c.length?c:void 0,workspace:d.length?d:void 0,workspaceFolder:l.size?l:void 0},this._onDidChangeRestrictedSettings.fire(this.restrictedSettings))}async updateWorkspaceConfiguration(e,t,i){const n={data:this._configuration.toData(),workspace:this.workspace},r=this._configuration.compareAndUpdateWorkspaceConfiguration(t),o=this.compareFolders(this.workspace.folders,e);if(o.added.length||o.removed.length||o.changed.length){this.workspace.folders=e;const t=await this.onFoldersChanged();await this.handleWillChangeWorkspaceFolders(o,i),this.triggerConfigurationChange(t,n,dn.JD.WORKSPACE_FOLDER),this._onDidChangeWorkspaceFolders.fire(o)}else this.triggerConfigurationChange(r,n,dn.JD.WORKSPACE);this.updateRestrictedSettings()}async handleWillChangeWorkspaceFolders(e,t){const i=[];this._onWillChangeWorkspaceFolders.fire({join(e){i.push(e)},changes:e,fromCache:t});try{await sr.jT.settled(i)}catch(e){}}async onWorkspaceFolderConfigurationChanged(e){const[t]=await this.loadFolderConfigurations([e]),i={data:this._configuration.toData(),workspace:this.workspace},n=this._configuration.compareAndUpdateFolderConfiguration(e.uri,t);if(this.getWorkbenchState()===Jn.Xe.FOLDER){const e=this._configuration.compareAndUpdateWorkspaceConfiguration(t);this.triggerConfigurationChange((0,ar.nP)(n,e),i,dn.JD.WORKSPACE)}else this.triggerConfigurationChange(n,i,dn.JD.WORKSPACE_FOLDER);this.updateRestrictedSettings()}async onFoldersChanged(){const e=[];for(const t of this.cachedFolderConfigs.keys())if(!this.workspace.folders.filter((e=>e.uri.toString()===t.toString()))[0]){this.cachedFolderConfigs.get(t).dispose(),this.cachedFolderConfigs.delete(t),e.push(this._configuration.compareAndDeleteFolderConfiguration(t))}const t=this.workspace.folders.filter((e=>!this.cachedFolderConfigs.has(e.uri)));if(t.length){(await this.loadFolderConfigurations(t)).forEach(((i,n)=>{e.push(this._configuration.compareAndUpdateFolderConfiguration(t[n].uri,i))}))}return(0,ar.nP)(...e)}loadFolderConfigurations(e){return Promise.all([...e.map((e=>{let t=this.cachedFolderConfigs.get(e.uri);return t||(t=new Xr(!this.initialized,e,Cn,this.getWorkbenchState(),this.isWorkspaceTrusted,this.fileService,this.uriIdentityService,this.logService,this.configurationCache),this._register(t.onDidChange((()=>this.onWorkspaceFolderConfigurationChanged(e)))),this.cachedFolderConfigs.set(e.uri,this._register(t))),t.loadConfiguration()}))])}async validateWorkspaceFoldersAndReload(e){const t=await this.toValidWorkspaceFolders(this.workspace.folders),{removed:i}=this.compareFolders(this.workspace.folders,t);i.length&&await this.updateWorkspaceConfiguration(t,this.workspaceConfiguration.getConfiguration(),e)}async toValidWorkspaceFolders(e){const t=[];for(const i of e){try{if(!(await this.fileService.stat(i.uri)).isDirectory)continue}catch(e){this.logService.warn(`Ignoring the error while validating workspace folder ${i.uri.toString()} - ${(0,to.yJ)(e)}`)}t.push(i)}return t}async writeConfigurationValue(e,t,i,n,r){if(!this.instantiationService)throw new Error("Cannot write configuration because the configuration service is not yet ready to accept writes.");if(i===dn.JD.DEFAULT)throw new Error("Invalid configuration target");if(i===dn.JD.MEMORY){const r={data:this._configuration.toData(),workspace:this.workspace};return this._configuration.updateValue(e,t,n),void this.triggerConfigurationChange({keys:n?.overrideIdentifiers?.length?[(0,xe.np)(n.overrideIdentifiers),e]:[e],overrides:n?.overrideIdentifiers?.length?n.overrideIdentifiers.map((t=>[t,[e]])):[]},r,i)}const o=this.toEditableConfigurationTarget(i,e);if(!o)throw new Error("Invalid configuration target");if(o===Ar.USER_REMOTE&&!this.remoteUserConfiguration)throw new Error("Invalid configuration target");if(n?.overrideIdentifiers?.length&&n.overrideIdentifiers.length>1){const e=this.getConfigurationModelForEditableConfigurationTarget(o,n.resource);if(e){const t=n.overrideIdentifiers.sort(),i=e.overrides.find((e=>(0,z.fS)([...e.identifiers].sort(),t)));i&&(n.overrideIdentifiers=i.identifiers)}}switch(this.configurationEditing=this.configurationEditing??this.createConfigurationEditingService(this.instantiationService),await(await this.configurationEditing).writeConfiguration(o,{key:e,value:t},{scopes:n,...r}),o){case Ar.USER_LOCAL:return void(this.applicationConfiguration&&this.isSettingAppliedForAllProfiles(e)?await this.reloadApplicationConfiguration():await this.reloadLocalUserConfiguration());case Ar.USER_REMOTE:return this.reloadRemoteUserConfiguration().then((()=>{}));case Ar.WORKSPACE:return this.reloadWorkspaceConfiguration();case Ar.WORKSPACE_FOLDER:{const e=n&&n.resource?this.workspace.getFolder(n.resource):null;if(e)return this.reloadWorkspaceFolderConfiguration(e)}}}async createConfigurationEditingService(e){const t=(await this.remoteAgentService.getEnvironment())?.settingsPath??null;return e.createInstance(qr,t)}getConfigurationModelForEditableConfigurationTarget(e,t){switch(e){case Ar.USER_LOCAL:return this._configuration.localUserConfiguration;case Ar.USER_REMOTE:return this._configuration.remoteUserConfiguration;case Ar.WORKSPACE:return this._configuration.workspaceConfiguration;case Ar.WORKSPACE_FOLDER:return t?this._configuration.folderConfigurations.get(t):void 0}}getConfigurationModel(e,t){switch(e){case dn.JD.USER_LOCAL:return this._configuration.localUserConfiguration;case dn.JD.USER_REMOTE:return this._configuration.remoteUserConfiguration;case dn.JD.WORKSPACE:return this._configuration.workspaceConfiguration;case dn.JD.WORKSPACE_FOLDER:return t?this._configuration.folderConfigurations.get(t):void 0;default:return}}deriveConfigurationTargets(e,t,i){if((0,Ee.fS)(t,i.value))return[];const n=[];return void 0!==i.workspaceFolderValue&&n.push(dn.JD.WORKSPACE_FOLDER),void 0!==i.workspaceValue&&n.push(dn.JD.WORKSPACE),void 0!==i.userRemoteValue&&n.push(dn.JD.USER_REMOTE),void 0!==i.userLocalValue&&n.push(dn.JD.USER_LOCAL),void 0!==i.applicationValue&&n.push(dn.JD.APPLICATION),void 0===t?n:[n[0]||dn.JD.USER]}triggerConfigurationChange(e,t,i){if(e.keys.length){i!==dn.JD.DEFAULT&&this.logService.debug(`Configuration keys changed in ${(0,dn.xV)(i)} target`,...e.keys);const n=new ar.YX(e,t,this._configuration,this.workspace,this.logService);n.source=i,this._onDidChangeConfiguration.fire(n)}}toEditableConfigurationTarget(e,t){if(e===dn.JD.APPLICATION)return Ar.USER_LOCAL;if(e===dn.JD.USER){if(this.remoteUserConfiguration){const e=this.configurationRegistry.getConfigurationProperties()[t]?.scope;if(e===xe.ue.MACHINE||e===xe.ue.MACHINE_OVERRIDABLE)return Ar.USER_REMOTE;if(void 0!==this.inspect(t).userRemoteValue)return Ar.USER_REMOTE}return Ar.USER_LOCAL}return e===dn.JD.USER_LOCAL?Ar.USER_LOCAL:e===dn.JD.USER_REMOTE?Ar.USER_REMOTE:e===dn.JD.WORKSPACE?Ar.WORKSPACE:e===dn.JD.WORKSPACE_FOLDER?Ar.WORKSPACE_FOLDER:null}}let go=class extends s.JT{constructor(e,t,i,n,r){super(),this.workspaceContextService=e,this.environmentService=t,this.workspaceTrustManagementService=i,n.whenInstalledExtensionsRegistered().then((()=>{this.registerConfigurationSchemas();const e=Pe.B.as(xe.IP.Configuration),t=this._register(new sr.vp(50));this._register(we.ju.any(e.onDidUpdateConfiguration,e.onDidSchemaChange,i.onDidChangeTrust)((()=>t.trigger((()=>this.registerConfigurationSchemas()),r.phase===Bn.BL.Eventually?void 0:2500))))}))}registerConfigurationSchemas(){const e={properties:xe.zt.properties,patternProperties:xe.zt.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},t=this.environmentService.remoteAuthority?{properties:Object.assign({},xe.w_.properties,xe.dy.properties,xe.Vn.properties),patternProperties:xe.zt.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0}:e,i={properties:Object.assign({},xe.V2.properties,xe.iq.properties,xe.dy.properties,xe.Vn.properties),patternProperties:xe.zt.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},n={properties:Object.assign({},xe.V2.properties,xe.iq.properties,xe.dy.properties,xe.Vn.properties),patternProperties:xe.zt.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},r={properties:Object.assign({},this.checkAndFilterPropertiesRequiringTrust(xe.iq.properties),this.checkAndFilterPropertiesRequiringTrust(xe.dy.properties),this.checkAndFilterPropertiesRequiringTrust(xe.Vn.properties)),patternProperties:xe.zt.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},o={properties:Object.keys(xe.zt.properties).reduce(((e,t)=>(e[t]=Object.assign({deprecationMessage:void 0},xe.zt.properties[t]),e)),{}),patternProperties:Object.keys(xe.zt.patternProperties).reduce(((e,t)=>(e[t]=Object.assign({deprecationMessage:void 0},xe.zt.patternProperties[t]),e)),{}),additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},s=Jn.Xe.WORKSPACE===this.workspaceContextService.getWorkbenchState()?{properties:Object.assign({},this.checkAndFilterPropertiesRequiringTrust(xe.iq.properties),this.checkAndFilterPropertiesRequiringTrust(xe.Vn.properties)),patternProperties:xe.zt.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0}:r,a={type:"object",description:(0,fe.C$)(co,0,"Contribute defaults for configurations"),properties:Object.assign({},xe.iq.properties,xe.dy.properties,xe.Vn.properties),patternProperties:{[xe.G1]:{type:"object",default:{},$ref:xe.NJ}},additionalProperties:!1};this.registerSchemas({defaultSettingsSchema:o,userSettingsSchema:t,profileSettingsSchema:i,machineSettingsSchema:n,workspaceSettingsSchema:r,folderSettingsSchema:s,configDefaultsSchema:a})}registerSchemas(e){const t=Pe.B.as(Oe.I.JSONContribution);t.registerSchema("vscode://schemas/settings/default",e.defaultSettingsSchema),t.registerSchema("vscode://schemas/settings/user",e.userSettingsSchema),t.registerSchema("vscode://schemas/settings/profile",e.profileSettingsSchema),t.registerSchema("vscode://schemas/settings/machine",e.machineSettingsSchema),t.registerSchema(Rn,e.workspaceSettingsSchema),t.registerSchema("vscode://schemas/settings/folder",e.folderSettingsSchema),t.registerSchema(xe.Tk,e.configDefaultsSchema)}checkAndFilterPropertiesRequiringTrust(e){if(this.workspaceTrustManagementService.isWorkspaceTrusted())return e;const t={};return Object.entries(e).forEach((([e,i])=>{i.restricted||(t[e]=i)})),t}};go=(0,O.g)([(0,O.f)(0,mn.e),(0,O.f)(1,Zr.n),(0,O.f)(2,io.Y2),(0,O.f)(3,no.Q),(0,O.f)(4,eo.g)],go);let fo=class extends s.JT{constructor(e,t){super(),e.hasCachedConfigurationDefaultsOverrides()&&t.whenInstalledExtensionsRegistered().then((()=>e.reloadConfiguration(dn.JD.DEFAULT)))}};fo=(0,O.g)([(0,O.f)(0,x.U),(0,O.f)(1,no.Q)],fo);let po=class extends s.JT{static{this.ID="workbench.contrib.updateExperimentalSettingsDefaults"}constructor(e){super(),this.workbenchAssignmentService=e,this.processedExperimentalSettings=new Set,this.configurationRegistry=Pe.B.as(xe.IP.Configuration),this.processExperimentalSettings(Object.keys(this.configurationRegistry.getConfigurationProperties())),this._register(this.configurationRegistry.onDidUpdateConfiguration((({properties:e})=>this.processExperimentalSettings(e))))}async processExperimentalSettings(e){const t={},i=this.configurationRegistry.getConfigurationProperties();for(const n of e){const e=i[n];if(e?.tags?.includes("experimental")&&!this.processedExperimentalSettings.has(n)){this.processedExperimentalSettings.add(n);try{const i=await this.workbenchAssignmentService.getTreatment(`config.${n}`);(0,Te.o8)(i)||(0,Ee.fS)(i,e.default)||(t[n]=i)}catch(e){}}}Object.keys(t).length&&this.configurationRegistry.registerDefaultConfigurations([{overrides:t,source:(0,fe.C$)(co,1,"Experiments")}])}};po=(0,O.g)([(0,O.f)(0,ro.U)],po);const mo=Pe.B.as(Vn.IP.Workbench);mo.registerWorkbenchContribution(go,Bn.BL.Restored),mo.registerWorkbenchContribution(fo,Bn.BL.Eventually),(0,Vn.dz)(po.ID,po,Vn.U9.BlockRestore);Pe.B.as(xe.IP.Configuration).registerConfiguration({...ao.p6,properties:{[Mn]:{type:"array",description:(0,fe.C$)(co,2,"Configure settings to be applied for all profiles."),default:[],scope:xe.ue.APPLICATION,additionalProperties:!0,uniqueItems:!0}}});class vo{constructor(e,t,i){this.donotCacheResourcesWithSchemes=e,this.fileService=i,this.cachedConfigurations=new Map,this.cacheHome=t.cacheHome}needsCaching(e){return!this.donotCacheResourcesWithSchemes.includes(e.scheme)}read(e){return this.getCachedConfiguration(e).read()}write(e,t){return this.getCachedConfiguration(e).save(t)}remove(e){return this.getCachedConfiguration(e).remove()}getCachedConfiguration({type:e,key:t}){const i=`${e}:${t}`;let n=this.cachedConfigurations.get(i);return n||(n=new yo({type:e,key:t},this.cacheHome,this.fileService),this.cachedConfigurations.set(i,n)),n}}class yo{constructor({type:e,key:t},i,n){this.fileService=n,this.cachedConfigurationFolderResource=(0,Yn.Vo)(i,"CachedConfigurations",e,t),this.cachedConfigurationFileResource=(0,Yn.Vo)(this.cachedConfigurationFolderResource,"workspaces"===e?"workspace.json":"configuration.json"),this.queue=new sr.ci}async read(){try{return(await this.fileService.readFile(this.cachedConfigurationFileResource)).value.toString()}catch(e){return""}}async save(e){await this.createCachedFolder()&&await this.queue.queue((async()=>{await this.fileService.writeFile(this.cachedConfigurationFileResource,Fe.KN.fromString(e))}))}async remove(){try{await this.queue.queue((()=>this.fileService.del(this.cachedConfigurationFolderResource,{recursive:!0,useTrash:!1})))}catch(e){if(e.fileOperationResult!==Pr.PK.FILE_NOT_FOUND)throw e}}async createCachedFolder(){if(await this.fileService.exists(this.cachedConfigurationFolderResource))return!0;try{return await this.fileService.createFolder(this.cachedConfigurationFolderResource),!0}catch(e){return!1}}}var Co=i(65952);i(20658);let wo=class{constructor(e,t,i,n){this.configurationService=e,this.environmentService=i,this.storageService=n,this.remoteEnvironment=null,t.getEnvironment().then((e=>this.remoteEnvironment=e))}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});if(i&&"string"==typeof i&&"auto"!==i)return i;const n=this.getOS(e);return n===vr.U5.Linux||n===vr.U5.Macintosh?"\n":"\r\n"}getOS(e){let t=vr.OS;const i=this.environmentService.remoteAuthority;if(i&&e&&e.scheme!==cn.lg.file){const e=`resource.authority.os.${i}`;t=this.remoteEnvironment?this.remoteEnvironment.os:this.storageService.getNumber(e,Qn.fO.WORKSPACE,vr.OS),this.storageService.store(e,t,Qn.fO.WORKSPACE,Qn.fV.MACHINE)}return t}};wo=(0,O.g)([(0,O.f)(0,x.U),(0,O.f)(1,Co.R),(0,O.f)(2,Zr.n),(0,O.f)(3,Zn.U)],wo);var So=i(90765),Ro=i(33944),_o=i(79837);const bo="vs/workbench/services/workspaces/browser/abstractWorkspaceEditingService";let ko=class extends s.JT{constructor(e,t,i,n,r,o,s,a,c,u,l,d,h,g,f,p){super(),this.jsonEditingService=e,this.contextService=t,this.configurationService=i,this.notificationService=n,this.commandService=r,this.fileService=o,this.textFileService=s,this.workspacesService=a,this.environmentService=c,this.fileDialogService=u,this.dialogService=l,this.hostService=d,this.uriIdentityService=h,this.workspaceTrustManagementService=g,this.userDataProfilesService=f,this.userDataProfileService=p}async pickNewWorkspacePath(){const e=[cn.lg.file];this.environmentService.remoteAuthority&&e.unshift(cn.lg.vscodeRemote);let t=await this.fileDialogService.showSaveDialog({saveLabel:(0,pr.pH)((0,fe.C$)(bo,0,"Save")),title:(0,fe.C$)(bo,1,"Save Workspace"),filters:Jn.WB,defaultUri:(0,Yn.Vo)(await this.fileDialogService.defaultWorkspacePath(),this.getNewWorkspaceName()),availableFileSystems:e});if(t)return(0,Jn.g)(t)||(t=t.with({path:`${t.path}.${Jn.A6}`})),t}getNewWorkspaceName(){const e=this.getCurrentWorkspaceIdentifier()?.configPath;if(e&&(0,Jn.AQ)(e,this.environmentService))return(0,Yn.EZ)(e);const t=(0,z.Xh)(this.contextService.getWorkspace().folders);return t?`${(0,Yn.EZ)(t.uri)}.${Jn.A6}`:`workspace.${Jn.A6}`}async updateFolders(e,t,i,n){const r=this.contextService.getWorkspace().folders;let o=[];"number"==typeof t&&(o=r.slice(e,e+t).map((e=>e.uri)));let s=[];Array.isArray(i)&&(s=i.map((e=>({uri:(0,Yn.O2)(e.uri),name:e.name}))));const a=o.length>0,c=s.length>0;if(c||a)return c&&!a?this.doAddFolders(s,e,n):a&&!c?this.removeFolders(o):this.includesSingleFolderWorkspace(o)?this.createAndEnterWorkspace(s):this.contextService.getWorkbenchState()!==Jn.Xe.WORKSPACE?this.doAddFolders(s,e,n):this.doUpdateFolders(s,o,e,n)}async doUpdateFolders(e,t,i,n=!1){try{await this.contextService.updateFolders(e,t,i)}catch(e){if(n)throw e;this.handleWorkspaceConfigurationEditingError(e)}}addFolders(e,t=!1){const i=e.map((e=>({uri:(0,Yn.O2)(e.uri),name:e.name})));return this.doAddFolders(i,void 0,t)}async doAddFolders(e,t,i=!1){const n=this.contextService.getWorkbenchState();if(n!==Jn.Xe.WORKSPACE){let i=this.contextService.getWorkspace().folders.map((e=>({uri:e.uri})));if(i.splice("number"==typeof t?t:i.length,0,...e),i=(0,z.EB)(i,(e=>this.uriIdentityService.extUri.getComparisonKey(e.uri))),n===Jn.Xe.EMPTY&&0===i.length||n===Jn.Xe.FOLDER&&1===i.length)return;return this.createAndEnterWorkspace(i)}try{await this.contextService.addFolders(e,t)}catch(e){if(i)throw e;this.handleWorkspaceConfigurationEditingError(e)}}async removeFolders(e,t=!1){if(this.includesSingleFolderWorkspace(e))return this.createAndEnterWorkspace([]);try{await this.contextService.removeFolders(e)}catch(e){if(t)throw e;this.handleWorkspaceConfigurationEditingError(e)}}includesSingleFolderWorkspace(e){if(this.contextService.getWorkbenchState()===Jn.Xe.FOLDER){const t=this.contextService.getWorkspace().folders[0];return e.some((e=>this.uriIdentityService.extUri.isEqual(e,t.uri)))}return!1}async createAndEnterWorkspace(e,t){if(t&&!await this.isValidTargetWorkspacePath(t))return;const i=this.environmentService.remoteAuthority,n=await this.workspacesService.createUntitledWorkspace(e,i);if(t)try{await this.saveWorkspaceAs(n,t)}finally{await this.workspacesService.deleteUntitledWorkspace(n)}else t=n.configPath,this.userDataProfileService.currentProfile.isDefault||await this.userDataProfilesService.setProfileForWorkspace(n,this.userDataProfileService.currentProfile);return this.enterWorkspace(t)}async saveAndEnterWorkspace(e){const t=this.getCurrentWorkspaceIdentifier();if(t){if((0,Yn.Xy)(t.configPath,e))return this.saveWorkspace(t);if(await this.isValidTargetWorkspacePath(e))return await this.saveWorkspaceAs(t,e),this.enterWorkspace(e)}}async isValidTargetWorkspacePath(e){return!0}async saveWorkspaceAs(e,t){const i=e.configPath;if(!(0,Jn.ql)(t,this.environmentService)&&!this.userDataProfileService.currentProfile.isDefault){const e=await this.workspacesService.getWorkspaceIdentifier(t);await this.userDataProfilesService.setProfileForWorkspace(e,this.userDataProfileService.currentProfile)}if(this.uriIdentityService.extUri.isEqual(i,t))return;const n=(0,Jn.ql)(i,this.environmentService),r=Dr((await this.fileService.readFile(i)).value.toString(),i,n,t,this.uriIdentityService.extUri);await this.textFileService.create([{resource:t,value:r,options:{overwrite:!0}}]),await this.trustWorkspaceConfiguration(t)}async saveWorkspace(e){const t=e.configPath,i=this.textFileService.files.get(t);if(i)return void await i.save({force:!0,reason:_o.tp.EXPLICIT});if(await this.fileService.exists(t))return;const n=Dr(JSON.stringify({folders:[]},null,"\t"),t,!1,t,this.uriIdentityService.extUri);await this.textFileService.create([{resource:t,value:n}])}handleWorkspaceConfigurationEditingError(e){if(e.code===So.E.ERROR_INVALID_FILE)this.onInvalidWorkspaceConfigurationFileError();else this.notificationService.error(e.message)}onInvalidWorkspaceConfigurationFileError(){const e=(0,fe.C$)(bo,2,"Unable to write into workspace configuration file. Please open the file to correct errors/warnings in it and try again.");this.askToOpenWorkspaceConfigurationFile(e)}askToOpenWorkspaceConfigurationFile(e){this.notificationService.prompt(ir.Z.Error,e,[{label:(0,fe.C$)(bo,3,"Open Workspace Configuration"),run:()=>this.commandService.executeCommand("workbench.action.openWorkspaceConfigFile")}])}async doEnterWorkspace(e){if(this.environmentService.extensionTestsLocationURI)throw new Error("Entering a new workspace is not possible in tests.");const t=await this.workspacesService.getWorkspaceIdentifier(e);return this.contextService.getWorkbenchState()===Jn.Xe.FOLDER&&await this.migrateWorkspaceSettings(t),await this.configurationService.initialize(t),this.workspacesService.enterWorkspace(e)}migrateWorkspaceSettings(e){return this.doCopyWorkspaceSettings(e,(e=>e.scope===xe.ue.WINDOW))}copyWorkspaceSettings(e){return this.doCopyWorkspaceSettings(e)}doCopyWorkspaceSettings(e,t){const i=Pe.B.as(xe.IP.Configuration).getConfigurationProperties(),n={};for(const e of this.configurationService.keys().workspace)if(i[e]){if(t&&!t(i[e]))continue;n[e]=this.configurationService.inspect(e).workspaceValue}return this.jsonEditingService.write(e.configPath,[{path:["settings"],value:n}],!0)}async trustWorkspaceConfiguration(e){this.contextService.getWorkbenchState()!==Jn.Xe.EMPTY&&this.workspaceTrustManagementService.isWorkspaceTrusted()&&await this.workspaceTrustManagementService.setUrisTrust([e],!0)}getCurrentWorkspaceIdentifier(){const e=(0,Jn.uT)(this.contextService.getWorkspace());if((0,Jn.NI)(e))return e}};ko=(0,O.g)([(0,O.f)(0,so.R),(0,O.f)(1,mn.e),(0,O.f)(2,Er),(0,O.f)(3,Ue.l),(0,O.f)(4,We.H),(0,O.f)(5,Le.s),(0,O.f)(6,Tr.M),(0,O.f)(7,vn.D),(0,O.f)(8,Zr.n),(0,O.f)(9,Ro.Z),(0,O.f)(10,Ro.S),(0,O.f)(11,Xn.$),(0,O.f)(12,fn.v),(0,O.f)(13,io.Y2),(0,O.f)(14,pn.l),(0,O.f)(15,Mr.AP)],ko);var Do,To=i(78314);let Eo=class extends s.JT{static{Do=this}static{this.RECENTLY_OPENED_KEY="recently.opened"}constructor(e,t,i,n,r,o){super(),this.storageService=e,this.contextService=t,this.logService=i,this.fileService=n,this.environmentService=r,this.uriIdentityService=o,this._onRecentlyOpenedChange=this._register(new we.Q5),this.onDidChangeRecentlyOpened=this._onRecentlyOpenedChange.event,this.addWorkspaceToRecentlyOpened(),this.registerListeners()}registerListeners(){this._register(this.storageService.onDidChangeValue(Qn.fO.APPLICATION,Do.RECENTLY_OPENED_KEY,this._register(new s.SL))((()=>this._onRecentlyOpenedChange.fire()))),this._register(this.contextService.onDidChangeWorkspaceFolders((e=>this.onDidChangeWorkspaceFolders(e))))}onDidChangeWorkspaceFolders(e){if((0,Jn.gC)(this.contextService.getWorkspace()))for(const t of e.added)this.addRecentlyOpened([{folderUri:t.uri}])}addWorkspaceToRecentlyOpened(){const e=this.contextService.getWorkspace(),t=this.environmentService.remoteAuthority;switch(this.contextService.getWorkbenchState()){case Jn.Xe.FOLDER:this.addRecentlyOpened([{folderUri:e.folders[0].uri,remoteAuthority:t}]);break;case Jn.Xe.WORKSPACE:this.addRecentlyOpened([{workspace:{id:e.id,configPath:e.configuration},remoteAuthority:t}])}}async getRecentlyOpened(){const e=this.storageService.get(Do.RECENTLY_OPENED_KEY,Qn.fO.APPLICATION);if(e){const t=function(e,t){const i={workspaces:[],files:[]};if(e){const n=function(e,i){for(let n=0;n<e.length;n++)try{i(e[n],n)}catch(i){t.warn(`Error restoring recent entry ${JSON.stringify(e[n])}: ${i.toString()}. Skip entry.`)}},r=e;Array.isArray(r.entries)&&n(r.entries,(e=>{const t=e.label,n=e.remoteAuthority;!function(e){return e.workspace&&"object"==typeof e.workspace&&"string"==typeof e.workspace.id&&"string"==typeof e.workspace.configPath}(e)?function(e){return"string"==typeof e.folderUri}(e)?i.workspaces.push({label:t,remoteAuthority:n,folderUri:c.ov.parse(e.folderUri)}):function(e){return"string"==typeof e.fileUri}(e)&&i.files.push({label:t,remoteAuthority:n,fileUri:c.ov.parse(e.fileUri)}):i.workspaces.push({label:t,remoteAuthority:n,workspace:{id:e.workspace.id,configPath:c.ov.parse(e.workspace.configPath)}})}))}return i}(JSON.parse(e),this.logService);return t.workspaces=t.workspaces.filter((e=>!(Cr(e)&&e.folderUri.scheme===cn.lg.file&&!(0,Jn.gC)(this.contextService.getWorkspace()))&&(!e.hasOwnProperty("workspace")||!(0,Jn.gC)(e.workspace.configPath)))),t}return{workspaces:[],files:[]}}async addRecentlyOpened(e){const t=await this.getRecentlyOpened();for(const i of e)i.hasOwnProperty("fileUri")?(this.doRemoveRecentlyOpened(t,[i.fileUri]),t.files.unshift(i)):Cr(i)?(this.doRemoveRecentlyOpened(t,[i.folderUri]),t.workspaces.unshift(i)):(this.doRemoveRecentlyOpened(t,[i.workspace.configPath]),t.workspaces.unshift(i));return this.saveRecentlyOpened(t)}async removeRecentlyOpened(e){const t=await this.getRecentlyOpened();return this.doRemoveRecentlyOpened(t,e),this.saveRecentlyOpened(t)}doRemoveRecentlyOpened(e,t){e.files=e.files.filter((e=>!t.some((t=>t.toString()===e.fileUri.toString())))),e.workspaces=e.workspaces.filter((e=>!t.some((t=>t.toString()===(Cr(e)?e.folderUri.toString():e.workspace.configPath.toString())))))}async saveRecentlyOpened(e){return this.storageService.store(Do.RECENTLY_OPENED_KEY,JSON.stringify(function(e){const t={entries:[]};for(const i of e.workspaces)Cr(i)?t.entries.push({folderUri:i.folderUri.toString(),label:i.label,remoteAuthority:i.remoteAuthority}):t.entries.push({workspace:{id:i.workspace.id,configPath:i.workspace.configPath.toString()},label:i.label,remoteAuthority:i.remoteAuthority});for(const i of e.files)t.entries.push({fileUri:i.fileUri.toString(),label:i.label,remoteAuthority:i.remoteAuthority});return t}(e)),Qn.fO.APPLICATION,Qn.fV.USER)}async clearRecentlyOpened(){this.storageService.remove(Do.RECENTLY_OPENED_KEY,Qn.fO.APPLICATION)}async enterWorkspace(e){return{workspace:await this.getWorkspaceIdentifier(e)}}async createUntitledWorkspace(e,t){const i=(Date.now()+Math.round(1e3*Math.random())).toString(),n=(0,Yn.Vo)(this.environmentService.untitledWorkspacesHome,`Untitled-${i}.${Jn.A6}`),r=[];if(e)for(const t of e)r.push(_r(t.uri,!0,t.name,this.environmentService.untitledWorkspacesHome,this.uriIdentityService.extUri));const o={folders:r,remoteAuthority:t};return await this.fileService.writeFile(n,Fe.KN.fromString(JSON.stringify(o,null,"\t"))),this.getWorkspaceIdentifier(n)}async deleteUntitledWorkspace(e){try{await this.fileService.del(e.configPath)}catch(e){if(e.fileOperationResult!==Pr.PK.FILE_NOT_FOUND)throw e}}async getWorkspaceIdentifier(e){return(0,To.H)(e)}async getDirtyWorkspaces(){return[]}};Eo=Do=(0,O.g)([(0,O.f)(0,Zn.U),(0,O.f)(1,mn.e),(0,O.f)(2,Ke.V),(0,O.f)(3,Le.s),(0,O.f)(4,Zr.n),(0,O.f)(5,fn.v)],Eo);var Po=i(7894),Oo=i(42043),xo=i(42403);function Io(){throw new Error("unsupported")}function Mo(e){let t=null;return(...i)=>(null==t&&(t=e(...i)),t)}var Fo=i(82770);c.ov.from({scheme:cn.lg.vscodeUserData,path:"/User/settings.json"});Pe.B.as(xe.IP.Configuration);let No,Ao=class extends ho{constructor(e,t,i,n,r,o,s,a){super({configurationCache:new vo([cn.lg.file,cn.lg.vscodeUserData,cn.lg.tmp],e,n)},e,t,i,n,r,o,s,a)}};Ao=(0,O.g)([(0,O.f)(0,Zr.n),(0,O.f)(1,Mr.AP),(0,O.f)(2,pn.l),(0,O.f)(3,Le.s),(0,O.f)(4,Co.R),(0,O.f)(5,fn.v),(0,O.f)(6,Ke.V),(0,O.f)(7,gn.W)],Ao);class Lo extends ko{constructor(){super(...arguments),this.enterWorkspace=Io}}(0,xo.es)((async e=>{const t=e.get(mn.e);t.acquireInstantiationService(e.get(ie.TG));const i=No??(0,Fo.H7)();if(c.ov.isUri(i)){const n=i.with({path:"/workspace.code-workspace"});try{const t=e.get(Le.s);await t.createFolder(i),await t.writeFile(n,Fe.KN.fromString(JSON.stringify({folders:[{path:i.path}]})))}catch(e){}await t.initialize({id:(0,un.R)(),configPath:n})}else await t.initialize(i)}));const qo=(Wo=Ao,new Proxy(Wo,{construct:Mo(((e,t)=>Reflect.construct(Wo,t)))}));var Wo;var jo=i(9051);const Uo=e=>{let t="";if(e.url){const i=e;if(!i.url.startsWith("ws://")&&!i.url.startsWith("wss://"))throw new Error(`This is not a proper websocket url: ${i.url}`);t=i.url}else{const i=e;if(t=`${i.secured?"wss":"ws"}://${i.host}`,void 0!==i.port&&80!==i.port&&(t+=`:${i.port}`),void 0!==i.path&&(t+=`/${i.path}`),i.extraParams){const e=new URL(t);for(const[t,n]of Object.entries(i.extraParams))e.searchParams.set(t,n instanceof Array?n.join(","):n.toString());t=e.toString()}}return t},Ko=e=>e instanceof URL?e.href:new URL(`data:text/plain;base64,${btoa(e)}`).href,$o=(e,t,i,n)=>Object.hasOwn(i,"uri")?jo.Uri.parse(i.uri):jo.Uri.parse(`${n??"/workspace"}/model${t?"Original":""}${e}.${i.fileExt}`);var Ho;!function(e){e[e.NONE=0]="NONE",e[e.CODE=1]="CODE",e[e.MODEL=2]="MODEL",e[e.CODE_AND_MODEL=3]="CODE_AND_MODEL"}(Ho||(Ho={}));const zo=(e,t)=>{const i=Vo(e?.main),n=Vo(t?.main),r=Vo(e?.original),o=Vo(t?.original);return i!==n||r!==o?Ho.CODE:Ho.NONE},Vo=e=>e&&Object.hasOwn(e,"text")?e.text:void 0,Bo=(e,t)=>{const i=zo(e,t)===Ho.CODE,n=Jo(e?.main),r=Jo(t?.main),o=Jo(e?.original),s=Jo(t?.original),a=n!==r||o!==s;return a&&i?Ho.CODE_AND_MODEL:a?Ho.MODEL:i?Ho.CODE:Ho.NONE},Jo=e=>e?Object.hasOwn(e,"uri")?e.uri:Object.hasOwn(e,"fileExt")?e.fileExt:void 0:void 0,Go=(e,t)=>e instanceof Object&&t instanceof Object?JSON.stringify(e)===JSON.stringify(t):e===t;class Yo{id;logger;editor;diffEditor;modelRef;modelRefOriginal;constructor(e,t){this.id=e,this.logger=t}buildConfig(e){const t={$type:e.$type,codeResources:e.codeResources,useDiffEditor:e.useDiffEditor??!1,readOnly:e.readOnly??!1,domReadOnly:e.domReadOnly??!1,overrideAutomaticLayout:e.overrideAutomaticLayout??!0,awaitExtensionReadiness:e.awaitExtensionReadiness??void 0};return t.editorOptions={...e.editorOptions,automaticLayout:e.overrideAutomaticLayout??!0},t.diffEditorOptions={...e.diffEditorOptions,automaticLayout:e.overrideAutomaticLayout??!0},t}haveEditor(){return void 0!==this.editor||void 0!==this.diffEditor}getEditor(){return this.editor}getDiffEditor(){return this.diffEditor}async createEditors(e){this.getConfig().useDiffEditor?this.diffEditor=tn.createDiffEditor(e,this.getConfig().diffEditorOptions):this.editor=tn.create(e,this.getConfig().editorOptions);const t=await this.buildModelRefs(this.getConfig().codeResources);await this.updateEditorModels(t)}disposeEditors(){this.editor&&(this.modelRef?.dispose(),this.editor.dispose(),this.editor=void 0),this.diffEditor&&(this.modelRef?.dispose(),this.modelRefOriginal?.dispose(),this.diffEditor.dispose(),this.diffEditor=void 0)}getTextModels(){const e=this.getModelRefs();return{text:e.modelRef?.object.textEditorModel??void 0,textOriginal:e.modelRefOriginal?.object.textEditorModel??void 0}}getModelRefs(){return{modelRef:this.modelRef,modelRefOriginal:this.modelRefOriginal}}async updateCodeResources(e){if(!this.editor&&!this.diffEditor)return Promise.reject(new Error("You cannot update the code resources as neither editor or diff editor is available."));const t=Bo(this.getConfig().codeResources,e);if(t!==Ho.NONE&&this.updateCodeResourcesConfig(e),t===Ho.CODE)this.editor?this.editor.setValue(e?.main?.text??""):(this.diffEditor?.getModifiedEditor().setValue(e?.main?.text??""),this.diffEditor?.getOriginalEditor().setValue(e?.original?.text??""));else if(t===Ho.MODEL||t===Ho.CODE_AND_MODEL){const t=await this.buildModelRefs(e);this.updateEditorModels(t)}}async buildModelRefs(e){return{modelRef:await this.buildModelRef(e?.main,!1),modelRefOriginal:await this.buildModelRef(e?.original,!0)}}async buildModelRef(e,t){if(e){const i=$o(this.id,t??!1,e),n=await Ze(i,e.text);return this.checkEnforceLanguageId(n,e.enforceLanguageId),n}}async updateEditorModels(e){if(!this.editor&&!this.diffEditor)return Promise.reject(new Error("You cannot update models as neither editor nor diff editor is available."));let t=!1,i=!1;if(e.modelRef&&(this.modelRef?.dispose(),this.modelRef=e.modelRef,t=!0),e.modelRefOriginal&&(this.modelRefOriginal?.dispose(),this.modelRefOriginal=e.modelRefOriginal,i=!0),this.editor)t&&this.modelRef&&null!==this.modelRef.object.textEditorModel&&this.editor.setModel(this.modelRef.object.textEditorModel);else if(this.diffEditor){if(!t&&!i||!this.modelRef||!this.modelRefOriginal||null===this.modelRef.object.textEditorModel||null===this.modelRefOriginal.object.textEditorModel)return Promise.reject(new Error("You cannot update models, because original model ref is not contained, but required for DiffEditor."));this.diffEditor.setModel({original:this.modelRefOriginal.object.textEditorModel,modified:this.modelRef.object.textEditorModel})}}checkEnforceLanguageId(e,t){void 0!==t&&(e.object.setLanguageId(t),this.logger?.info(`Main languageId is enforced: ${t}`))}updateCodeResourcesConfig(e){const t=this.getConfig();t.codeResources={},e?.main&&(t.codeResources.main=e.main),e?.original&&(t.codeResources.original=e.original)}updateLayout(){this.getConfig().useDiffEditor?this.diffEditor?.layout():this.editor?.layout()}async awaitReadiness(e){if(e){const t=[];for(const i of e)t.push(i());return Promise.all(t)}return Promise.resolve()}updateMonacoEditorOptions(e){this.getEditor()?.updateOptions(e)}async updateUserConfiguration(e){return void 0!==e?async function(e){const t=await(0,ze.ko)(pn.l),i=await(0,ze.ko)(Le.s);await i.writeFile(t.defaultProfile.settingsResource,Fe.KN.fromString(e))}(e):Promise.resolve()}getUserConfiguration(){return async function(){const e=await(0,ze.ko)(pn.l),t=await(0,ze.ko)(Le.s);return(await t.readFile(e.defaultProfile.settingsResource)).value.toString()}()}}class Xo extends Yo{config;constructor(e,t,i){super(e,i);const n=t.wrapperConfig.editorAppConfig;this.config=this.buildConfig(n),this.config.languageDef=n.languageDef}getConfig(){return this.config}async specifyServices(){return{...(0,(await i.e(4152).then(i.bind(i,44152))).default)()}}async init(){await this.awaitReadiness(this.config.awaitExtensionReadiness);const e=this.config.languageDef;if(e){nn.register(e.languageExtensionConfig);0===nn.getLanguages().filter((t=>t.id===e.languageExtensionConfig.id)).length&&nn.register({id:e.languageExtensionConfig.id}),e.monarchLanguage&&nn.setMonarchTokensProvider(e.languageExtensionConfig.id,e.monarchLanguage),e.theme&&(tn.defineTheme(e.theme.name,e.theme.data),tn.setTheme(e.theme.name))}if(void 0!==this.config.editorOptions?.["semanticHighlighting.enabled"]){const e=JSON.stringify({"editor.semanticHighlighting.enabled":this.config.editorOptions["semanticHighlighting.enabled"]});await this.updateUserConfiguration(e)}this.logger?.info("Init of Classic App was completed.")}disposeApp(){this.disposeEditors()}isAppConfigDifferent(e,t,i){let n=!1;i&&(n=Bo(e.codeResources,t.codeResources)!==Ho.NONE);return n=n||["useDiffEditor","domReadOnly","readOnly","awaitExtensionReadiness","overrideAutomaticLayout","editorOptions","diffEditorOptions","theme","languageDef","languageExtensionConfig","themeData"].some((i=>!Go(e[i],t[i]))),n}}var Qo=i(70001);class Zo extends Yo{config;extensionRegisterResults=new Map;subscriptions=new s.SL;constructor(e,t,i){super(e),this.logger=i;const n=t.wrapperConfig.editorAppConfig;this.config=this.buildConfig(n),this.config.extensions=n.extensions??void 0,this.config.userConfiguration=n.userConfiguration??void 0}getConfig(){return this.config}getExtensionRegisterResult(e){return this.extensionRegisterResults.get(e)}async specifyServices(){const e=(await Promise.all([i.e(2417),i.e(7994)]).then(i.bind(i,7994))).default,t=(await Promise.all([i.e(2417),i.e(6331)]).then(i.bind(i,56331))).default;return{...e(),...t()}}async init(){const e=(await i.e(8313).then(i.bind(i,98313))).whenReady,t=(this.config.awaitExtensionReadiness??[]).concat(e);if(await this.awaitReadiness(t),this.config.extensions){const e=[];for(const t of this.config.extensions){const i=t.config,n=(0,Qo.ix)(i,1);if(this.extensionRegisterResults.set(i.name,n),t.filesOrContents&&Object.hasOwn(n,"registerFileUrl"))for(const e of t.filesOrContents){const t=n.registerFileUrl(e[0],Ko(e[1]));this.subscriptions.add(t)}e.push(n.whenReady())}await Promise.all(e)}await this.updateUserConfiguration(this.config.userConfiguration?.json),this.logger?.info("Init of Extended App was completed.")}disposeApp(){this.disposeEditors(),this.extensionRegisterResults.forEach((e=>e?.dispose())),this.subscriptions.dispose()}isAppConfigDifferent(e,t,i){let n=!1;i&&(n=Bo(e.codeResources,t.codeResources)!==Ho.NONE);return n=n||["useDiffEditor","domReadOnly","readOnly","awaitExtensionReadiness","overrideAutomaticLayout","editorOptions","diffEditorOptions","extensions","userConfiguration"].some((i=>!Go(e[i],t[i]))),n}}var es=i(13953);class ts extends es.dp{connectionProvider;constructor({id:e,name:t,clientOptions:i,connectionProvider:n}){super(e??t.toLowerCase(),t,i),this.connectionProvider=n}createMessageTransports(e){return this.connectionProvider.get(e)}}var is=i(23397);class ns extends is.AbstractMessageReader{socket;state="initial";callback;events=[];constructor(e){super(),this.socket=e,this.socket.onMessage((e=>this.readMessage(e))),this.socket.onError((e=>this.fireError(e))),this.socket.onClose(((e,t)=>{if(1e3!==e){const i={name:""+e,message:`Error during socket reconnect: code = ${e}, reason = ${t}`};this.fireError(i)}this.fireClose()}))}listen(e){if("initial"===this.state)for(this.state="listening",this.callback=e;0!==this.events.length;){const e=this.events.pop();void 0!==e.message?this.readMessage(e.message):void 0!==e.error?this.fireError(e.error):this.fireClose()}return{dispose:()=>{this.callback===e&&(this.state="initial",this.callback=void 0)}}}dispose(){super.dispose(),this.state="initial",this.callback=void 0,this.events.splice(0,this.events.length)}readMessage(e){if("initial"===this.state)this.events.splice(0,0,{message:e});else if("listening"===this.state)try{const t=JSON.parse(e);this.callback(t)}catch(e){const t={name:"400",message:`Error during message parsing, reason = ${"object"==typeof e?e.message:"unknown"}`};this.fireError(t)}}fireError(e){"initial"===this.state?this.events.splice(0,0,{error:e}):"listening"===this.state&&super.fireError(e)}fireClose(){"initial"===this.state?this.events.splice(0,0,{}):"listening"===this.state&&super.fireClose(),this.state="closed"}}var rs=i(594);class os extends rs.AbstractMessageWriter{errorCount=0;socket;constructor(e){super(),this.socket=e}end(){}async write(e){try{const t=JSON.stringify(e);this.socket.send(t)}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}}i(81613);function ss(e){return{send:t=>e.send(t),onMessage:t=>{e.onmessage=e=>t(e.data)},onError:t=>{e.onerror=e=>{Object.hasOwn(e,"message")&&t(e.message)}},onClose:t=>{e.onclose=e=>t(e.code,e.reason)},dispose:()=>e.close()}}var as=i(78086);class cs{languageClient;languageClientConfig;messageTransports;connectionProvider;languageId;worker;port;name;logger;async init(e){this.languageClientConfig=e.languageClientConfig,this.name=this.languageClientConfig.name??"unnamed",this.logger=e.logger,this.languageId=this.languageClientConfig.languageId}haveLanguageClient(){return void 0!==this.languageClient}haveLanguageClientConfig(){return void 0!==this.languageClientConfig}getLanguageClient(){return this.languageClient}getWorker(){return this.worker}isStarted(){return void 0!==this.languageClient&&this.languageClient.isRunning()}getMessageTransports(){return this.messageTransports}getConnectionProvider(){return this.connectionProvider}async start(){if(this.languageClientConfig)return this.startLanguageClientConnection();{const e={message:`languageClientWrapper (${this.name}): Unable to start monaco-languageclient. No configuration was provided.`,error:"No error was provided."};return Promise.reject(e)}}async restartLanguageClient(e,t){if(e?await this.disposeLanguageClient(!1):await this.disposeLanguageClient(t),this.worker=e,this.languageClientConfig)return this.logger?.info("Re-Starting monaco-languageclient"),this.startLanguageClientConnection();{const e={message:`languageClientWrapper (${this.name}): Unable to restart languageclient. No configuration was provided.`,error:"No error was provided."};return Promise.reject(e)}}startLanguageClientConnection(){if(this.languageClient&&this.languageClient.isRunning())return this.logger?.info("monaco-languageclient already running!"),Promise.resolve();const e=this.languageClientConfig?.options;return this.connectionProvider=this.languageClientConfig?.connectionProvider,new Promise(((t,i)=>{if("WebSocket"===e?.$type||"WebSocketUrl"===e?.$type){const n=Uo(e),r=new WebSocket(n);r.onopen=async()=>{const e=ss(r);this.messageTransports=await(this.connectionProvider?.get(""))??{reader:new ns(e),writer:new os(e)},this.handleLanguageClientStart(t,i)},r.onerror=e=>{const t={message:`languageClientWrapper (${this.name}): Websocket connection failed.`,error:e.error??"No error was provided."};i(t)}}else{if(!this.worker){if("WorkerConfig"===e?.$type){const t=e;this.worker=new Worker(new URL(t.url,"file:///Users/dangerous/Code/materia/mage-ai/mage_ai/frontend/node_modules/monaco-editor-wrapper/dist/languageClientWrapper.js").href,{type:t.type,name:t.workerName}),this.worker.onerror=e=>{const t={message:`languageClientWrapper (${this.name}): Illegal worker configuration detected. Potentially the url is wrong.`,error:e.error??"No error was provided."};i(t)}}else{const t=e;this.worker=t.worker}e?.messagePort&&(this.port=e.messagePort)}(async e=>{this.messageTransports=await(this.connectionProvider?.get(""))??{reader:new as.BrowserMessageReader(e),writer:new as.BrowserMessageWriter(e)},this.handleLanguageClientStart(t,i)})(this.port?this.port:this.worker)}}))}async handleLanguageClientStart(e,t){this.connectionProvider||(this.connectionProvider={get:()=>Promise.resolve(this.messageTransports)});const i={name:this.languageClientConfig?.name??"Monaco Wrapper Language Client",clientOptions:this.languageClientConfig?.clientOptions??{documentSelector:[this.languageId],errorHandler:{error:()=>({action:es._X.Continue}),closed:()=>({action:es.UY.DoNotRestart})}},connectionProvider:this.connectionProvider};this.languageClient=new ts(i);const n=this.languageClientConfig?.options;this.messageTransports?.reader.onClose((async()=>{if(await(this.languageClient?.stop()),("WebSocket"===n?.$type||"WebSocketUrl"===n?.$type)&&n.stopOptions){const e=n.stopOptions;e.onCall(this.getLanguageClient()),void 0!==e.reportStatus&&this.logger?.info(this.reportStatus().join("\n"))}}));try{if(await this.languageClient.start(),("WebSocket"===n?.$type||"WebSocketUrl"===n?.$type)&&n.startOptions){const e=n.startOptions;e.onCall(this.getLanguageClient()),void 0!==e.reportStatus&&this.logger?.info(this.reportStatus().join("\n"))}}catch(e){t({message:`languageClientWrapper (${this.name}): Start was unsuccessful.`,error:Object.hasOwn(e??{},"cause")?e:"No error was provided."})}this.logger?.info(`languageClientWrapper (${this.name}): Started successfully.`),e()}disposeWorker(e){void 0!==e&&!1!==e||(this.worker?.terminate(),this.worker=void 0)}async disposeLanguageClient(e){if(!this.languageClient)return this.disposeWorker(e),Promise.resolve();if(!this.languageClient.isRunning())return Promise.resolve();try{return await this.languageClient.dispose(),this.disposeWorker(e),this.languageClient=void 0,this.logger?.info("monaco-languageclient and monaco-editor were successfully disposed."),Promise.resolve()}catch(e){const t={message:`languageClientWrapper (${this.name}): Disposing the monaco-languageclient resulted in error.`,error:Object.hasOwn(e??{},"cause")?e:"No error was provided."};return Promise.reject(t)}}reportStatus(){const e=[],t=this.getLanguageClient();return e.push("LanguageClientWrapper status:"),e.push(`LanguageClient: ${t?.name??"Language Client"} is in a '${es.ZM[t?.state??1]}' state`),e}}var us=i(41748),ls=i(18135);const ds=e=>{const t=Object.keys(e??{}).includes("themeService"),i=Object.keys(e??{}).includes("textMateTokenizationFeature"),n=Object.keys(e??{}).includes("markersService"),r=Object.keys(e??{}).includes("viewsService");if(t&&!i)throw new Error('"theme" service requires "textmate" service. Please add it to the "userServices".');if(n&&!r)throw new Error('"markers" service requires "views" service. Please add it to the "userServices".');return!0};class hs{id;editorApp;languageClientWrapper;logger=new ls.Y;initDone=!1;async init(e){if(this.initDone)throw new Error("init was already performed. Please call dispose first if you want to re-start.");const t=e.wrapperConfig.editorAppConfig;if(t.useDiffEditor&&!t.codeResources?.original)throw new Error(`Use diff editor was used without a valid config. code: ${t.codeResources?.main} codeOriginal: ${t.codeResources?.original}`);this.editorApp?.disposeApp(),this.id=e.id??Math.floor(101*Math.random()).toString(),this.logger.updateConfig(e.loggerConfig),"classic"===t.$type?this.editorApp=new Xo(this.id,e,this.logger):this.editorApp=new Zo(this.id,e,this.logger);const i=await this.editorApp.specifyServices(),n=await(async e=>{const t=e.serviceConfig??{};t.debugLogging=!0===e.logger?.isEnabled()&&(!0===t.debugLogging||!0===e.logger.isDebugEnabled()),t.userServices=t.userServices??{};const i=t.userServices.configurationService??void 0,n=t.workspaceConfig??void 0;if(void 0===i){if(n)throw new Error("You provided a workspaceConfig without using the configurationServiceOverride");const e={...(No=r,{...(0,Oo.ZP)(),[x.U.toString()]:new Ae.M(qo,[],!0),[mn.e.toString()]:new Ae.M(qo,[],!0),[De.V.toString()]:new Ae.M(hn,[],!0),[Po.o.toString()]:new Ae.M(Lo,[],!0),[vn.D.toString()]:new Ae.M(Eo,[],!0),[De.y.toString()]:new Ae.M(wo,[],!0)})};(0,us.WR)(e,t.userServices)}var r;return n||(t.workspaceConfig={workspaceProvider:{trusted:!0,workspace:{workspaceUri:jo.Uri.file("/workspace")},async open(){return window.open(window.location.href),!0}}}),(0,us.WR)(e.specificServices??{},t.userServices),t})({serviceConfig:e.wrapperConfig.serviceConfig,specificServices:i,logger:this.logger});await(0,us.fG)({serviceConfig:n,caller:`monaco-editor (${this.id})`,performChecks:ds,logger:this.logger}),e.languageClientConfig&&(this.languageClientWrapper=new cs,await this.languageClientWrapper.init({languageClientConfig:e.languageClientConfig,logger:this.logger})),this.initDone=!0}async initAndStart(e,t){await this.init(e),await this.start(t)}async start(e){if(!this.initDone)throw new Error("No init was performed. Please call init() before start()");if(!e)throw new Error("No HTMLElement provided for monaco-editor.");this.logger.info(`Starting monaco-editor (${this.id})`),await(this.editorApp?.init()),await(this.editorApp?.createEditors(e)),this.languageClientWrapper?.haveLanguageClientConfig()&&await(this.languageClientWrapper?.start())}isInitDone(){return this.initDone}isStarted(){return!!this.editorApp?.haveEditor()&&(!this.languageClientWrapper?.haveLanguageClient()||(this.languageClientWrapper?.isStarted()??!1))}haveLanguageClient(){return void 0!==this.languageClientWrapper}getMonacoEditorApp(){return this.editorApp}getEditor(){return this.editorApp?.getEditor()}getDiffEditor(){return this.editorApp?.getDiffEditor()}getLanguageClientWrapper(){return this.languageClientWrapper}getLanguageClient(){return this.languageClientWrapper?.getLanguageClient()}getTextModels(){return this.editorApp?.getTextModels()}getModelRefs(){return this.editorApp?.getModelRefs()}getWorker(){return this.languageClientWrapper?.getWorker()}async updateCodeResources(e){return this.editorApp?.updateCodeResources(e)}async updateEditorModels(e){return this.editorApp?.updateEditorModels(e)}reportStatus(){const e=[];return e.push("Wrapper status:"),e.push(`Editor: ${this.editorApp?.getEditor()?.getId()}`),e.push(`DiffEditor: ${this.editorApp?.getDiffEditor()?.getId()}`),e}async dispose(){this.editorApp?.disposeApp(),this.languageClientWrapper?.haveLanguageClient()?(await(this.languageClientWrapper?.disposeLanguageClient(!1)),this.editorApp=void 0,await Promise.resolve("Monaco editor and languageclient completed disposed.")):await Promise.resolve("Monaco editor has been disposed."),this.initDone=!1}updateLayout(){this.editorApp?.updateLayout()}isReInitRequired(e,t){let i=!1;const n=e.wrapperConfig.editorAppConfig,r=t.wrapperConfig.editorAppConfig,o=t.languageClientConfig?.options,s=e.languageClientConfig?.options,a="WorkerDirect"===o?.$type,c="WorkerDirect"===s?.$type,u="WorkerConfig"===o?.$type,l="WorkerConfig"===s?.$type;return u&&!a&&l&&!c?i=o.url!==s.url:!u&&a&&!l&&c?i=o.worker!==s.worker:(a&&l||u&&c)&&(i=!0),r.$type!==n.$type?i=!0:("classic"===r.$type&&"classic"===n.$type||"extended"===r.$type&&"extended"===n.$type)&&(i=!0===this.getMonacoEditorApp().isAppConfigDifferent(r,n,!1)),i}}},38987:function(e,t,i){"use strict";var n,r,o,s,a,c,u,l,d,h,g,f,p,m,v,y,C,w,S,R,_,b,k,D,T,E,P,O,x,I,M,F,N,A,L,q,W,j,U,K,$,H,z,V,B,J,G,Y,X,Q,Z,ee,te,ie,ne,re,oe,se,ae,ce,ue,le,de,he,ge,fe,pe,me,ve,ye,Ce,we,Se,Re,_e,be,ke,De;i.r(t),i.d(t,{AnnotatedTextEdit:function(){return k},ChangeAnnotation:function(){return _},ChangeAnnotationIdentifier:function(){return b},CodeAction:function(){return oe},CodeActionContext:function(){return re},CodeActionKind:function(){return ie},CodeActionTriggerKind:function(){return ne},CodeDescription:function(){return C},CodeLens:function(){return se},Color:function(){return d},ColorInformation:function(){return h},ColorPresentation:function(){return g},Command:function(){return S},CompletionItem:function(){return $},CompletionItemKind:function(){return L},CompletionItemLabelDetails:function(){return K},CompletionItemTag:function(){return W},CompletionList:function(){return H},CreateFile:function(){return T},DeleteFile:function(){return P},Diagnostic:function(){return w},DiagnosticRelatedInformation:function(){return m},DiagnosticSeverity:function(){return v},DiagnosticTag:function(){return y},DocumentHighlight:function(){return Y},DocumentHighlightKind:function(){return G},DocumentLink:function(){return ce},DocumentSymbol:function(){return te},DocumentUri:function(){return n},EOL:function(){return Oe},FoldingRange:function(){return p},FoldingRangeKind:function(){return f},FormattingOptions:function(){return ae},Hover:function(){return V},InlayHint:function(){return Ce},InlayHintKind:function(){return ve},InlayHintLabelPart:function(){return ye},InlineCompletionContext:function(){return ke},InlineCompletionItem:function(){return Se},InlineCompletionList:function(){return Re},InlineCompletionTriggerKind:function(){return _e},InlineValueContext:function(){return me},InlineValueEvaluatableExpression:function(){return pe},InlineValueText:function(){return ge},InlineValueVariableLookup:function(){return fe},InsertReplaceEdit:function(){return j},InsertTextFormat:function(){return q},InsertTextMode:function(){return U},Location:function(){return u},LocationLink:function(){return l},MarkedString:function(){return z},MarkupContent:function(){return A},MarkupKind:function(){return N},OptionalVersionedTextDocumentIdentifier:function(){return M},ParameterInformation:function(){return B},Position:function(){return a},Range:function(){return c},RenameFile:function(){return E},SelectedCompletionInfo:function(){return be},SelectionRange:function(){return ue},SemanticTokenModifiers:function(){return de},SemanticTokenTypes:function(){return le},SemanticTokens:function(){return he},SignatureInformation:function(){return J},StringValue:function(){return we},SymbolInformation:function(){return Z},SymbolKind:function(){return X},SymbolTag:function(){return Q},TextDocument:function(){return xe},TextDocumentEdit:function(){return D},TextDocumentIdentifier:function(){return x},TextDocumentItem:function(){return F},TextEdit:function(){return R},URI:function(){return r},VersionedTextDocumentIdentifier:function(){return I},WorkspaceChange:function(){return Pe},WorkspaceEdit:function(){return O},WorkspaceFolder:function(){return De},WorkspaceSymbol:function(){return ee},integer:function(){return o},uinteger:function(){return s}}),function(e){e.is=function(e){return"string"==typeof e}}(n||(n={})),function(e){e.is=function(e){return"string"==typeof e}}(r||(r={})),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(o||(o={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(s||(s={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=s.MAX_VALUE),t===Number.MAX_VALUE&&(t=s.MAX_VALUE),{line:e,character:t}},e.is=function(e){let t=e;return Ie.objectLiteral(t)&&Ie.uinteger(t.line)&&Ie.uinteger(t.character)}}(a||(a={})),function(e){e.create=function(e,t,i,n){if(Ie.uinteger(e)&&Ie.uinteger(t)&&Ie.uinteger(i)&&Ie.uinteger(n))return{start:a.create(e,t),end:a.create(i,n)};if(a.is(e)&&a.is(t))return{start:e,end:t};throw new Error(`Range#create called with invalid arguments[${e}, ${t}, ${i}, ${n}]`)},e.is=function(e){let t=e;return Ie.objectLiteral(t)&&a.is(t.start)&&a.is(t.end)}}(c||(c={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){let t=e;return Ie.objectLiteral(t)&&c.is(t.range)&&(Ie.string(t.uri)||Ie.undefined(t.uri))}}(u||(u={})),function(e){e.create=function(e,t,i,n){return{targetUri:e,targetRange:t,targetSelectionRange:i,originSelectionRange:n}},e.is=function(e){let t=e;return Ie.objectLiteral(t)&&c.is(t.targetRange)&&Ie.string(t.targetUri)&&c.is(t.targetSelectionRange)&&(c.is(t.originSelectionRange)||Ie.undefined(t.originSelectionRange))}}(l||(l={})),function(e){e.create=function(e,t,i,n){return{red:e,green:t,blue:i,alpha:n}},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&Ie.numberRange(t.red,0,1)&&Ie.numberRange(t.green,0,1)&&Ie.numberRange(t.blue,0,1)&&Ie.numberRange(t.alpha,0,1)}}(d||(d={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&c.is(t.range)&&d.is(t.color)}}(h||(h={})),function(e){e.create=function(e,t,i){return{label:e,textEdit:t,additionalTextEdits:i}},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&Ie.string(t.label)&&(Ie.undefined(t.textEdit)||R.is(t))&&(Ie.undefined(t.additionalTextEdits)||Ie.typedArray(t.additionalTextEdits,R.is))}}(g||(g={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(f||(f={})),function(e){e.create=function(e,t,i,n,r,o){const s={startLine:e,endLine:t};return Ie.defined(i)&&(s.startCharacter=i),Ie.defined(n)&&(s.endCharacter=n),Ie.defined(r)&&(s.kind=r),Ie.defined(o)&&(s.collapsedText=o),s},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&Ie.uinteger(t.startLine)&&Ie.uinteger(t.startLine)&&(Ie.undefined(t.startCharacter)||Ie.uinteger(t.startCharacter))&&(Ie.undefined(t.endCharacter)||Ie.uinteger(t.endCharacter))&&(Ie.undefined(t.kind)||Ie.string(t.kind))}}(p||(p={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){let t=e;return Ie.defined(t)&&u.is(t.location)&&Ie.string(t.message)}}(m||(m={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(v||(v={})),function(e){e.Unnecessary=1,e.Deprecated=2}(y||(y={})),function(e){e.is=function(e){const t=e;return Ie.objectLiteral(t)&&Ie.string(t.href)}}(C||(C={})),function(e){e.create=function(e,t,i,n,r,o){let s={range:e,message:t};return Ie.defined(i)&&(s.severity=i),Ie.defined(n)&&(s.code=n),Ie.defined(r)&&(s.source=r),Ie.defined(o)&&(s.relatedInformation=o),s},e.is=function(e){var t;let i=e;return Ie.defined(i)&&c.is(i.range)&&Ie.string(i.message)&&(Ie.number(i.severity)||Ie.undefined(i.severity))&&(Ie.integer(i.code)||Ie.string(i.code)||Ie.undefined(i.code))&&(Ie.undefined(i.codeDescription)||Ie.string(null===(t=i.codeDescription)||void 0===t?void 0:t.href))&&(Ie.string(i.source)||Ie.undefined(i.source))&&(Ie.undefined(i.relatedInformation)||Ie.typedArray(i.relatedInformation,m.is))}}(w||(w={})),function(e){e.create=function(e,t,...i){let n={title:e,command:t};return Ie.defined(i)&&i.length>0&&(n.arguments=i),n},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.string(t.title)&&Ie.string(t.command)}}(S||(S={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&Ie.string(t.newText)&&c.is(t.range)}}(R||(R={})),function(e){e.create=function(e,t,i){const n={label:e};return void 0!==t&&(n.needsConfirmation=t),void 0!==i&&(n.description=i),n},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&Ie.string(t.label)&&(Ie.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(Ie.string(t.description)||void 0===t.description)}}(_||(_={})),function(e){e.is=function(e){const t=e;return Ie.string(t)}}(b||(b={})),function(e){e.replace=function(e,t,i){return{range:e,newText:t,annotationId:i}},e.insert=function(e,t,i){return{range:{start:e,end:e},newText:t,annotationId:i}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){const t=e;return R.is(t)&&(_.is(t.annotationId)||b.is(t.annotationId))}}(k||(k={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){let t=e;return Ie.defined(t)&&M.is(t.textDocument)&&Array.isArray(t.edits)}}(D||(D={})),function(e){e.create=function(e,t,i){let n={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(n.options=t),void 0!==i&&(n.annotationId=i),n},e.is=function(e){let t=e;return t&&"create"===t.kind&&Ie.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Ie.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Ie.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||b.is(t.annotationId))}}(T||(T={})),function(e){e.create=function(e,t,i,n){let r={kind:"rename",oldUri:e,newUri:t};return void 0===i||void 0===i.overwrite&&void 0===i.ignoreIfExists||(r.options=i),void 0!==n&&(r.annotationId=n),r},e.is=function(e){let t=e;return t&&"rename"===t.kind&&Ie.string(t.oldUri)&&Ie.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Ie.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Ie.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||b.is(t.annotationId))}}(E||(E={})),function(e){e.create=function(e,t,i){let n={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(n.options=t),void 0!==i&&(n.annotationId=i),n},e.is=function(e){let t=e;return t&&"delete"===t.kind&&Ie.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Ie.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Ie.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||b.is(t.annotationId))}}(P||(P={})),function(e){e.is=function(e){let t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((e=>Ie.string(e.kind)?T.is(e)||E.is(e)||P.is(e):D.is(e))))}}(O||(O={}));class Te{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,i){let n,r;if(void 0===i?n=R.insert(e,t):b.is(i)?(r=i,n=k.insert(e,t,i)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(i),n=k.insert(e,t,r)),this.edits.push(n),void 0!==r)return r}replace(e,t,i){let n,r;if(void 0===i?n=R.replace(e,t):b.is(i)?(r=i,n=k.replace(e,t,i)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(i),n=k.replace(e,t,r)),this.edits.push(n),void 0!==r)return r}delete(e,t){let i,n;if(void 0===t?i=R.del(e):b.is(t)?(n=t,i=k.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),n=this.changeAnnotations.manage(t),i=k.del(e,n)),this.edits.push(i),void 0!==n)return n}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")}}class Ee{constructor(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let i;if(b.is(e)?i=e:(i=this.nextId(),t=e),void 0!==this._annotations[i])throw new Error(`Id ${i} is already in use.`);if(void 0===t)throw new Error(`No annotation provided for id ${i}`);return this._annotations[i]=t,this._size++,i}nextId(){return this._counter++,this._counter.toString()}}class Pe{constructor(e){this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new Ee(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((e=>{if(D.is(e)){const t=new Te(e.edits,this._changeAnnotations);this._textEditChanges[e.textDocument.uri]=t}}))):e.changes&&Object.keys(e.changes).forEach((t=>{const i=new Te(e.changes[t]);this._textEditChanges[t]=i}))):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(M.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");const t={uri:e.uri,version:e.version};let i=this._textEditChanges[t.uri];if(!i){const e=[],n={textDocument:t,edits:e};this._workspaceEdit.documentChanges.push(n),i=new Te(e,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}{if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let i=[];this._workspaceEdit.changes[e]=i,t=new Te(i),this._textEditChanges[e]=t}return t}}initDocumentChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new Ee,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let n,r,o;if(_.is(t)||b.is(t)?n=t:i=t,void 0===n?r=T.create(e,i):(o=b.is(n)?n:this._changeAnnotations.manage(n),r=T.create(e,i,o)),this._workspaceEdit.documentChanges.push(r),void 0!==o)return o}renameFile(e,t,i,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let r,o,s;if(_.is(i)||b.is(i)?r=i:n=i,void 0===r?o=E.create(e,t,n):(s=b.is(r)?r:this._changeAnnotations.manage(r),o=E.create(e,t,n,s)),this._workspaceEdit.documentChanges.push(o),void 0!==s)return s}deleteFile(e,t,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let n,r,o;if(_.is(t)||b.is(t)?n=t:i=t,void 0===n?r=P.create(e,i):(o=b.is(n)?n:this._changeAnnotations.manage(n),r=P.create(e,i,o)),this._workspaceEdit.documentChanges.push(r),void 0!==o)return o}}!function(e){e.create=function(e){return{uri:e}},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.string(t.uri)}}(x||(x={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.string(t.uri)&&Ie.integer(t.version)}}(I||(I={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.string(t.uri)&&(null===t.version||Ie.integer(t.version))}}(M||(M={})),function(e){e.create=function(e,t,i,n){return{uri:e,languageId:t,version:i,text:n}},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.string(t.uri)&&Ie.string(t.languageId)&&Ie.integer(t.version)&&Ie.string(t.text)}}(F||(F={})),function(e){e.PlainText="plaintext",e.Markdown="markdown",e.is=function(t){const i=t;return i===e.PlainText||i===e.Markdown}}(N||(N={})),function(e){e.is=function(e){const t=e;return Ie.objectLiteral(e)&&N.is(t.kind)&&Ie.string(t.value)}}(A||(A={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(L||(L={})),function(e){e.PlainText=1,e.Snippet=2}(q||(q={})),function(e){e.Deprecated=1}(W||(W={})),function(e){e.create=function(e,t,i){return{newText:e,insert:t,replace:i}},e.is=function(e){const t=e;return t&&Ie.string(t.newText)&&c.is(t.insert)&&c.is(t.replace)}}(j||(j={})),function(e){e.asIs=1,e.adjustIndentation=2}(U||(U={})),function(e){e.is=function(e){const t=e;return t&&(Ie.string(t.detail)||void 0===t.detail)&&(Ie.string(t.description)||void 0===t.description)}}(K||(K={})),function(e){e.create=function(e){return{label:e}}}($||($={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(H||(H={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){const t=e;return Ie.string(t)||Ie.objectLiteral(t)&&Ie.string(t.language)&&Ie.string(t.value)}}(z||(z={})),function(e){e.is=function(e){let t=e;return!!t&&Ie.objectLiteral(t)&&(A.is(t.contents)||z.is(t.contents)||Ie.typedArray(t.contents,z.is))&&(void 0===e.range||c.is(e.range))}}(V||(V={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(B||(B={})),function(e){e.create=function(e,t,...i){let n={label:e};return Ie.defined(t)&&(n.documentation=t),Ie.defined(i)?n.parameters=i:n.parameters=[],n}}(J||(J={})),function(e){e.Text=1,e.Read=2,e.Write=3}(G||(G={})),function(e){e.create=function(e,t){let i={range:e};return Ie.number(t)&&(i.kind=t),i}}(Y||(Y={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(X||(X={})),function(e){e.Deprecated=1}(Q||(Q={})),function(e){e.create=function(e,t,i,n,r){let o={name:e,kind:t,location:{uri:n,range:i}};return r&&(o.containerName=r),o}}(Z||(Z={})),function(e){e.create=function(e,t,i,n){return void 0!==n?{name:e,kind:t,location:{uri:i,range:n}}:{name:e,kind:t,location:{uri:i}}}}(ee||(ee={})),function(e){e.create=function(e,t,i,n,r,o){let s={name:e,detail:t,kind:i,range:n,selectionRange:r};return void 0!==o&&(s.children=o),s},e.is=function(e){let t=e;return t&&Ie.string(t.name)&&Ie.number(t.kind)&&c.is(t.range)&&c.is(t.selectionRange)&&(void 0===t.detail||Ie.string(t.detail))&&(void 0===t.deprecated||Ie.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(te||(te={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(ie||(ie={})),function(e){e.Invoked=1,e.Automatic=2}(ne||(ne={})),function(e){e.create=function(e,t,i){let n={diagnostics:e};return null!=t&&(n.only=t),null!=i&&(n.triggerKind=i),n},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.typedArray(t.diagnostics,w.is)&&(void 0===t.only||Ie.typedArray(t.only,Ie.string))&&(void 0===t.triggerKind||t.triggerKind===ne.Invoked||t.triggerKind===ne.Automatic)}}(re||(re={})),function(e){e.create=function(e,t,i){let n={title:e},r=!0;return"string"==typeof t?(r=!1,n.kind=t):S.is(t)?n.command=t:n.edit=t,r&&void 0!==i&&(n.kind=i),n},e.is=function(e){let t=e;return t&&Ie.string(t.title)&&(void 0===t.diagnostics||Ie.typedArray(t.diagnostics,w.is))&&(void 0===t.kind||Ie.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||S.is(t.command))&&(void 0===t.isPreferred||Ie.boolean(t.isPreferred))&&(void 0===t.edit||O.is(t.edit))}}(oe||(oe={})),function(e){e.create=function(e,t){let i={range:e};return Ie.defined(t)&&(i.data=t),i},e.is=function(e){let t=e;return Ie.defined(t)&&c.is(t.range)&&(Ie.undefined(t.command)||S.is(t.command))}}(se||(se={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){let t=e;return Ie.defined(t)&&Ie.uinteger(t.tabSize)&&Ie.boolean(t.insertSpaces)}}(ae||(ae={})),function(e){e.create=function(e,t,i){return{range:e,target:t,data:i}},e.is=function(e){let t=e;return Ie.defined(t)&&c.is(t.range)&&(Ie.undefined(t.target)||Ie.string(t.target))}}(ce||(ce={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){let i=t;return Ie.objectLiteral(i)&&c.is(i.range)&&(void 0===i.parent||e.is(i.parent))}}(ue||(ue={})),function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"}(le||(le={})),function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"}(de||(de={})),function(e){e.is=function(e){const t=e;return Ie.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(he||(he={})),function(e){e.create=function(e,t){return{range:e,text:t}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&Ie.string(t.text)}}(ge||(ge={})),function(e){e.create=function(e,t,i){return{range:e,variableName:t,caseSensitiveLookup:i}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&Ie.boolean(t.caseSensitiveLookup)&&(Ie.string(t.variableName)||void 0===t.variableName)}}(fe||(fe={})),function(e){e.create=function(e,t){return{range:e,expression:t}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&(Ie.string(t.expression)||void 0===t.expression)}}(pe||(pe={})),function(e){e.create=function(e,t){return{frameId:e,stoppedLocation:t}},e.is=function(e){const t=e;return Ie.defined(t)&&c.is(e.stoppedLocation)}}(me||(me={})),function(e){e.Type=1,e.Parameter=2,e.is=function(e){return 1===e||2===e}}(ve||(ve={})),function(e){e.create=function(e){return{value:e}},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&(void 0===t.tooltip||Ie.string(t.tooltip)||A.is(t.tooltip))&&(void 0===t.location||u.is(t.location))&&(void 0===t.command||S.is(t.command))}}(ye||(ye={})),function(e){e.create=function(e,t,i){const n={position:e,label:t};return void 0!==i&&(n.kind=i),n},e.is=function(e){const t=e;return Ie.objectLiteral(t)&&a.is(t.position)&&(Ie.string(t.label)||Ie.typedArray(t.label,ye.is))&&(void 0===t.kind||ve.is(t.kind))&&void 0===t.textEdits||Ie.typedArray(t.textEdits,R.is)&&(void 0===t.tooltip||Ie.string(t.tooltip)||A.is(t.tooltip))&&(void 0===t.paddingLeft||Ie.boolean(t.paddingLeft))&&(void 0===t.paddingRight||Ie.boolean(t.paddingRight))}}(Ce||(Ce={})),function(e){e.createSnippet=function(e){return{kind:"snippet",value:e}}}(we||(we={})),function(e){e.create=function(e,t,i,n){return{insertText:e,filterText:t,range:i,command:n}}}(Se||(Se={})),function(e){e.create=function(e){return{items:e}}}(Re||(Re={})),function(e){e.Invoked=0,e.Automatic=1}(_e||(_e={})),function(e){e.create=function(e,t){return{range:e,text:t}}}(be||(be={})),function(e){e.create=function(e,t){return{triggerKind:e,selectedCompletionInfo:t}}}(ke||(ke={})),function(e){e.is=function(e){const t=e;return Ie.objectLiteral(t)&&r.is(t.uri)&&Ie.string(t.name)}}(De||(De={}));const Oe=["\n","\r\n","\r"];var xe,Ie;!function(e){function t(e,i){if(e.length<=1)return e;const n=e.length/2|0,r=e.slice(0,n),o=e.slice(n);t(r,i),t(o,i);let s=0,a=0,c=0;for(;s<r.length&&a<o.length;){let t=i(r[s],o[a]);e[c++]=t<=0?r[s++]:o[a++]}for(;s<r.length;)e[c++]=r[s++];for(;a<o.length;)e[c++]=o[a++];return e}e.create=function(e,t,i,n){return new Me(e,t,i,n)},e.is=function(e){let t=e;return!!(Ie.defined(t)&&Ie.string(t.uri)&&(Ie.undefined(t.languageId)||Ie.string(t.languageId))&&Ie.uinteger(t.lineCount)&&Ie.func(t.getText)&&Ie.func(t.positionAt)&&Ie.func(t.offsetAt))},e.applyEdits=function(e,i){let n=e.getText(),r=t(i,((e,t)=>{let i=e.range.start.line-t.range.start.line;return 0===i?e.range.start.character-t.range.start.character:i})),o=n.length;for(let t=r.length-1;t>=0;t--){let i=r[t],s=e.offsetAt(i.range.start),a=e.offsetAt(i.range.end);if(!(a<=o))throw new Error("Overlapping edit");n=n.substring(0,s)+i.newText+n.substring(a,n.length),o=s}return n}}(xe||(xe={}));class Me{constructor(e,t,i,n){this._uri=e,this._languageId=t,this._version=i,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),i=this.offsetAt(e.end);return this._content.substring(t,i)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(void 0===this._lineOffsets){let e=[],t=this._content,i=!0;for(let n=0;n<t.length;n++){i&&(e.push(n),i=!1);let r=t.charAt(n);i="\r"===r||"\n"===r,"\r"===r&&n+1<t.length&&"\n"===t.charAt(n+1)&&n++}i&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),i=0,n=t.length;if(0===n)return a.create(0,e);for(;i<n;){let r=Math.floor((i+n)/2);t[r]>e?n=r:i=r+1}let r=i-1;return a.create(r,e-t[r])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let i=t[e.line],n=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(i+e.character,n),i)}get lineCount(){return this.getLineOffsets().length}}!function(e){const t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,i,n){return"[object Number]"===t.call(e)&&i<=e&&e<=n},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Ie||(Ie={}))},44335:function(e,t,i){"use strict";i.d(t,{j:function(){return o}});var n=i(82998),r=i(93125);function o(e,t,i){return new s(e,t,i)}class s extends r.Q8{constructor(e,t,i){super(e,i.keepIdleModels||!1,i.label,t),this._foreignModuleId=i.moduleId,this._foreignModuleCreateData=i.createData||null,this._foreignModuleHost=i.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||"function"!=typeof this._foreignModuleHost[e])return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(e){return Promise.reject(e)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then((e=>{const t=this._foreignModuleHost?(0,n.$E)(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then((t=>{this._foreignModuleCreateData=null;const i=(t,i)=>e.fmr(t,i),n=(e,t)=>function(){const i=Array.prototype.slice.call(arguments,0);return t(e,i)},r={};for(const e of t)r[e]=n(e,i);return r}))}))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then((e=>this.getProxy()))}}}}]);