(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1975],{93808:function(n,e,r){"use strict";r.d(e,{Z:function(){return N}});var u=r(77837),t=r(26304),o=r(62243),l=r(29385),i=r(80022),c=r(13692),s=r(93189),a=r(15544),d=r(82394),v=r(38860),f=r.n(v),p=r(82684),b=r(56663),m=r.n(b),h=r(40761),g=r(34661),O=r(36105),E=r(50178),k=r(69419),y=r(28598),w=["auth"];function R(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);e&&(u=u.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,u)}return r}function P(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R(Object(r),!0).forEach((function(e){(0,d.Z)(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function j(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var r,u=(0,a.Z)(n);if(e){var t=(0,a.Z)(this).constructor;r=Reflect.construct(u,arguments,t)}else r=u.apply(this,arguments);return(0,s.Z)(this,r)}}function N(n){return function(e){(0,c.Z)(a,e);var r,s=j(a);function a(){var n;(0,o.Z)(this,a);for(var e=arguments.length,r=new Array(e),u=0;u<e;u++)r[u]=arguments[u];return n=s.call.apply(s,[this].concat(r)),(0,d.Z)((0,i.Z)(n),"state",{auth:new h.Z(n.props.token)}),n}return(0,l.Z)(a,[{key:"componentDidMount",value:function(){this.setState({auth:new h.Z(this.props.token)})}},{key:"render",value:function(){var e=this.props,r=(e.auth,(0,t.Z)(e,w));return(0,y.jsx)(n,P({auth:this.state.auth},r))}}],[{key:"getInitialProps",value:(r=(0,u.Z)(f().mark((function e(r){var u,t,o,l,i,c,s,a,d;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=m()(r),t=(0,E.ex)(r),o=t.id,l=u[g.Mv],i=u[O.qt],c=new h.Z(l),s=P(P({},r),{},{auth:c,currentGroupId:o,theme:i}),(0,E.YB)(r)&&c.isExpired&&(console.log("OAuth token has expired."),a=P(P({},r.query),{},{redirect_url:r.asPath}),(0,k.nL)("/sign-in?".concat((0,k.uM)(a)),r.res)),!n.getInitialProps){e.next=12;break}return e.next=10,n.getInitialProps(s);case 10:return d=e.sent,e.abrupt("return",P(P({},d),{},{auth:c,currentGroupId:o,theme:i}));case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),function(n){return r.apply(this,arguments)})}]),a}(p.Component)}},47822:function(n,e,r){"use strict";r.d(e,{C:function(){return v}});var u=r(75582),t=r(82394),o=r(21831),l=r(44425),i=r(32080),c=r(86735),s=r(42122);function a(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);e&&(u=u.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,u)}return r}function d(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){(0,t.Z)(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function v(n,e){for(var r,t,a=[],v=[],p=function(){var e,r=[],u=[],t=0===a.length&&0===v.length,l=t?null!==(e=null==n?void 0:n.pipelines)&&void 0!==e?e:[]:v.shift();null==l||l.forEach((function(e){var l,i,s,a={};null==e||null===(l=e.blocks)||void 0===l||l.forEach((function(n){var e=n.downstream_blocks,r=n.upstream_blocks,u=n.uuid;a[u]={dn:[],up:[]},null==e||e.forEach((function(n){a[u].dn.push(n),a[n]||(a[n]={dn:[],up:[]}),a[n].up.push(u)})),null==r||r.forEach((function(n){a[u].up.push(n),a[n]||(a[n]={dn:[],up:[]}),a[n].dn.push(u)}))}));var v=null!==(i=null==e?void 0:e.pipelines)&&void 0!==i?i:[];(null==v?void 0:v.length)>=1&&v.forEach((function(n){var u,t,l=a[n.uuid]||{},i=l.dn,s=l.up;r.push(d(d({},n),{},{downstream_blocks:(0,c.Nb)(i),groups:(0,c.Nb)([].concat((0,o.Z)(null!==(u=n.groups)&&void 0!==u?u:[]),(0,o.Z)(null!==(t=e.groups)&&void 0!==t?t:[]))).filter((function(e){return e!==n.uuid})),upstream_blocks:(0,c.Nb)(s)}))})),u.push(d(d({},e),{},{groups:(0,c.Nb)([].concat((0,o.Z)(null!==(s=e.groups)&&void 0!==s?s:[]),(0,o.Z)(t?[n.uuid]:[]))).filter((function(n){return n!==e.uuid}))}))})),(null==r?void 0:r.length)>=1&&v.push((0,c.VF)(r)),a.push(u)};v.length>=1||n&&0===a.length;)p();var b=null!==(r=a[a.length-1])&&void 0!==r?r:[],m=(0,c.HK)(b,(function(n){return n.uuid})),h=[];null==b||b.forEach((function(n){var e,r=n.downstream_blocks,u=n.upstream_blocks,t=null!==(e=null==n?void 0:n.blocks)&&void 0!==e?e:[];(null==t?void 0:t.length)>=1&&t.forEach((function(e){(null==e||!e.downstream_blocks)&&(null==r?void 0:r.length)>=1?r.forEach((function(n){var r,u=m[n];null==u||null===(r=u.blocks)||void 0===r||r.forEach((function(n){null!=n&&n.upstream_blocks||(e.downstream_blocks||(e.downstream_blocks=[]),e.downstream_blocks=(0,c.Nb)([].concat((0,o.Z)(e.downstream_blocks),[n.uuid])),n.upstream_blocks||(n.upstream_blocks=[]),n.upstream_blocks=(0,c.Nb)([].concat((0,o.Z)(n.upstream_blocks),[e.uuid])))}))})):null!=e&&e.upstream_blocks||u.forEach((function(n){var r,u=m[n];null==u||null===(r=u.blocks)||void 0===r||r.forEach((function(n){null!=n&&n.downstream_blocks||(e.upstream_blocks||(e.upstream_blocks=[]),e.upstream_blocks=(0,c.Nb)([].concat((0,o.Z)(e.upstream_blocks),[n.uuid])),n.downstream_blocks||(n.downstream_blocks=[]),n.downstream_blocks=(0,c.Nb)([].concat((0,o.Z)(n.downstream_blocks),[e.uuid])))}))})),h.push(d(d({},e),{},{groups:[n.uuid]}))}))})),a.push(h);var g={},O=[];a.forEach((function(n){var e=[];n.forEach((function(n){var r=(0,s.GL)(n,["configuration","description","downstream_blocks","groups","name","upstream_blocks","uuid"]);e.push(r),g[r.uuid]=r})),O.push(e)}));var E=[];O.reverse().forEach((function(n,e){var r=[];n.forEach((function(n){var u=d({},n);if(e>=1){var t,o=E[0];u.children=null==o||null===(t=o.filter)||void 0===t?void 0:t.call(o,(function(n){var e;return null==n||null===(e=n.groups)||void 0===e?void 0:e.includes(u.uuid)}))}r.push(u)})),E.unshift(r)}));var k,y,w=(0,c.HK)(E.flatMap((function(n){return null==n?void 0:n.map((function(n){return d(d({},g[n.uuid]),n)}))})),(function(n){return n.uuid})),R=(0,c.HK)(f(e),(function(n){return n.uuid})),P=(0,i.sV)(e,R,{addPipelineToBlocks:!0,excludeBlockTypes:[l.tf.PIPELINE]}),j=(k=Object.values(P),y={},null==k||k.forEach((function(n){var e;null==n||null===(e=n.groups)||void 0===e||e.forEach((function(e){var r;y[r=e]||(y[r]={}),y[e][n.uuid]=n}))})),y);return null===(t=Object.entries(null!=P?P:{}))||void 0===t||t.forEach((function(n){var e,r=(0,u.Z)(n,2),t=r[0],l=r[1];null==l||null===(e=l.groups)||void 0===e||e.forEach((function(n){var e,r,u=w[n];(null!==(e=null==u?void 0:u.downstream_blocks)&&void 0!==e?e:[]).forEach((function(n){var e=j[n];l.downstream_blocks||(l.downstream_blocks=[]),l.downstream_blocks=(0,c.Nb)([].concat((0,o.Z)(l.downstream_blocks),(0,o.Z)(e?Object.keys(e):[])))})),(null!==(r=null==u?void 0:u.upstream_blocks)&&void 0!==r?r:[]).forEach((function(n){var e=j[n];l.upstream_blocks||(l.upstream_blocks=[]),l.upstream_blocks=(0,c.Nb)([].concat((0,o.Z)(l.upstream_blocks),(0,o.Z)(e?Object.keys(e):[])))})),null!=l&&l.pipeline&&(l.pipeline=(0,s.gR)(l.pipeline,["blocks","pipelines"])),P[t]=l}))})),{blockMapping:P,blocksByGroup:j,groupMapping:w,groupsByLevel:E}}function f(n){var e,r=[];return null==n||null===(e=n.pipelines)||void 0===e||e.forEach((function(n){r.push(n),r.push.apply(r,(0,o.Z)(f(n)))})),r}},27441:function(n,e,r){"use strict";r.d(e,{J:function(){return o},d:function(){return t}});var u=r(69419);function t(n,e,r){var t,o,l=(0,u.$o)(n,"/v2/pipelines/[uuid]/[...slug]").slug,i=(null===(t=Array.isArray(l)?l:[l])||void 0===t||null===(o=t.map((function(n){return(0,u.Uu)(n)})))||void 0===o?void 0:o.filter((function(n){return n!==(null==e?void 0:e.uuid)}))).reduce((function(n,e,u){var t,o=null==r||null===(t=r[u])||void 0===t?void 0:t.find((function(n){return n.uuid===e}));return n.concat(o)}),[]),c=i.findIndex((function(n){return!(null!=n&&n)}));return c>=0&&i.splice(c),i}function o(n,e){for(var r,t,o=[n],l=null!==(r=null===(t=o[0])||void 0===t?void 0:t.groups)&&void 0!==r?r:[];l.length>0;){var i,c,s=null===(i=l.map((function(n){return null==e?void 0:e[n]})))||void 0===i?void 0:i[0];if(s)o.unshift(s),l=null!==(c=null==s?void 0:s.groups)&&void 0!==c?c:[];else l=[]}var a=o.findIndex((function(n){return!(null!=n&&n)}));return a>=0&&o.splice(a),o.filter((function(n){return n.uuid})).map((function(n){return(0,u.wL)(n.uuid)}))}},20256:function(n,e,r){"use strict";r.d(e,{GK:function(){return l},W7:function(){return o},xU:function(){return t}});var u=r(10360);function t(n){return n&&(null==n||n.close()),u.Wk.CLOSED}function o(n){var e,r,t,o,l,i,c,s=null==n||null===(e=n.result)||void 0===e?void 0:e.status,a=null==n||null===(r=n.result)||void 0===r?void 0:r.type;return null!==(null!==(t=null!==(o=null==n?void 0:n.error)&&void 0!==o?o:null==n||null===(l=n.result)||void 0===l?void 0:l.error)&&void 0!==t?t:null==n||null===(i=n.result)||void 0===i||null===(c=i.process)||void 0===c?void 0:c.exitcode)||[u.YI.ERROR,u.YI.FAILURE,u.YI.INTERRUPTED].includes(s)||u.YI.READY===s&&a===u.XM.STATUS}function l(n){return null==n?void 0:n.find((function(n){return u.YI.ERROR===n.status}))}},10360:function(n,e,r){"use strict";r.d(e,{Vb:function(){return o},Wk:function(){return d},XM:function(){return i},YI:function(){return s},n2:function(){return v},nR:function(){return l}});var u,t,o,l,i,c,s,a=r(82394);!function(n){n.INTERRUPT="interrupt",n.RESTART="restart",n.TERMINATE="terminate"}(o||(o={})),function(n){n[n.CONNECTING=0]="CONNECTING",n[n.OPEN=1]="OPEN",n[n.CLOSED=2]="CLOSED"}(l||(l={})),function(n){n.DATA="data",n.OUTPUT="output",n.STATUS="status",n.STDOUT="stdout"}(i||(i={})),function(n){n.EXECUTION="execution",n.EXECUTION_STATUS="execution_status",n.TASK="task",n.TASK_STATUS="task_status"}(c||(c={})),function(n){n.CANCELLED="cancelled",n.ERROR="error",n.FAILURE="failure",n.INIT="init",n.INTERRUPTED="interrupted",n.READY="ready",n.RESTARTED="restarted",n.RUNNING="running",n.SUCCESS="success",n.TERMINATED="terminated"}(s||(s={}));var d,v=(u={},(0,a.Z)(u,s.CANCELLED,"cancelling"),(0,a.Z)(u,s.INIT,"initializing"),(0,a.Z)(u,s.INTERRUPTED,"interrupting"),(0,a.Z)(u,s.RESTARTED,"restarting"),(0,a.Z)(u,s.SUCCESS,"succeeded"),(0,a.Z)(u,s.TERMINATED,"terminating"),u);!function(n){n.CLOSED="closed",n.CONNECTING="connecting",n.OPEN="open",n.RECONNECTING="reconnecting"}(d||(d={}));t={},(0,a.Z)(t,l.CLOSED,d.CLOSED),(0,a.Z)(t,l.CONNECTING,d.CONNECTING),(0,a.Z)(t,l.OPEN,d.OPEN)},6593:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return L}});var u=r(77837),t=r(21831),o=r(38860),l=r.n(o),i=r(10360),c=r(5635),s=r(93808),a=r(82684),d=r(51774),v=r.n(d),f=r(82394),p=r(20256),b=r(4383),m=r(46042),h=r(95924),g=r(42122);function O(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);e&&(u=u.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,u)}return r}function E(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){(0,f.Z)(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}var k=1e3;function y(n){for(var e=["[CodeExecutionManager] ".concat(n)],r=arguments.length,u=new Array(r>1?r-1:0),t=1;t<r;t++)u[t-1]=arguments[t];Array.isArray(u)&&u.length>0&&e.push.apply(e,u)}function w(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoReconnect:!0,maxConnectionAttempts:10,throttle:1e3},e=n.autoReconnect,r=n.maxConnectionAttempts,u=(n.throttle,n.onError,n.onMessage),t=(n.onSuccess,(0,a.useRef)({})),o=(0,a.useRef)({}),l=(0,a.useRef)(null),c=(0,a.useRef)(null),s=(0,a.useRef)(null),d=(0,a.useRef)({}),v=((0,a.useRef)([]),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)({})),f=(0,a.useRef)([]),O=(0,m.Tu)({resource:"code_executions"},{handlers:{create:{onError:function(n,e){y("mutants.onError",[n,e]),f.current.push(n)},onSuccess:function(n,e){y("mutants.create.onSuccess",[n,e])}}}});function w(n){var e,r,t,o,l,i,s,a,d,f,p,b,m=function(n){var e,r,u,t,o,l=JSON.parse(null!==(e=n.data)&&void 0!==e?e:"{}");return{channel:null==l?void 0:l.uuid,source:null==l||null===(r=l.result)||void 0===r||null===(u=r.process)||void 0===u?void 0:u.source,stream:null==l||null===(t=l.result)||void 0===t||null===(o=t.process)||void 0===o?void 0:o.stream}}(n),h=m.channel,g=m.stream,O=JSON.parse(n.data);(null==c?void 0:c.current)&&(null==c||null===(e=c.current)||void 0===e||e.call(c,n)),u&&(null==u||u(O)),null==v||null===(r=v.current)||void 0===r||null===(t=r[h])||void 0===t||null===(o=t.streams[g])||void 0===o||null===(l=o.options)||void 0===l||null===(i=l.onMessage)||void 0===i||i.call(l,O);var E=null!==(s=null==v||null===(a=v.current)||void 0===a||null===(d=a[h])||void 0===d||null===(f=d.streams[g])||void 0===f?void 0:f.consumers)&&void 0!==s?s:{};y("useEventStreams.onmessage",n,O,null==v||null===(p=v.current)||void 0===p?void 0:p[h],Object.keys(null!=E?E:{})),null===(b=Object.values(null!=E?E:{}))||void 0===b||b.forEach((function(n){var e,r=n.options;null==r||null===(e=r.onMessage)||void 0===e||e.call(r,O)}))}function R(n,e){var r=P(n);if(r){var u;if(i.nR.OPEN===r.readyState)return clearTimeout(null==o||null===(u=o.current)||void 0===u?void 0:u[n]),r;var t,l,c,s,a,f,p=Object.keys(null!==(t=null===(l=v.current[n])||void 0===l?void 0:l.streams)&&void 0!==t?t:{}).length,m=Object.keys(null!==(c=null===(s=v.current[n])||void 0===s||null===(a=s.streams)||void 0===a||null===(f=a[e])||void 0===f?void 0:f.consumers)&&void 0!==c?c:{}).length;y("Closing inactive connection for channel ".concat(n," with ").concat(p," ")+"streams and ".concat(m," consumers")),N(n),r=null}if(r=P(n))return r;y("Connecting to server..."),function(n){var e=new EventSource((0,b.if)(n));j(e),d.current[n]=e}(n),r=P(n)}function P(n){var e=d.current[n];return j(e),d.current[n]=e,e}function j(n){null!=n&&n&&(n.onerror=function(n){!function(n){var e;(null==l?void 0:l.current)&&(null==l||null===(e=l.current)||void 0===e||e.call(l,n)),y("useEventStreams.onerror",n)}(n)},n.onmessage=function(n){w(n)},n.onopen=function(n){!function(n){var e,r=n.target;(null==s?void 0:s.current)&&(null==s||null===(e=s.current)||void 0===e||e.call(s,n)),y("useEventStreams.onopen",r)}(n)})}function N(n){n in v.current&&delete v.current[n];var e=P(n);e&&((0,p.xU)(e),delete d.current[n])}function T(){var n,e;return null===(n=Object.values(null!==(e=null==d?void 0:d.current)&&void 0!==e?e:[]))||void 0===n?void 0:n.filter((function(n){return null!=n&&n&&(null==n?void 0:n.readyState)===i.nR.OPEN}))}return{teardown:function(){Object.keys(null==d?void 0:d.current).length>0&&(y("Tearing down..."),Object.keys(null==d?void 0:d.current).forEach((function(n){N(n),y("Closed event stream connection for ".concat(n))})))},useExecuteCode:function(n,e){return{executeCode:function(r,u,t){var o,l=(0,h.I)();return O.create.mutate({onError:function(n){var e;(null==t?void 0:t.onError)&&(null==t||null===(e=t.onError)||void 0===e||e.call(t,n))},onSuccess:function(n){var e;(null==t?void 0:t.onSuccess)&&(null==t||null===(e=t.onSuccess)||void 0===e||e.call(t,n))},payload:E(E({},u),{},{message:r,message_request_uuid:null!==(o=null==u?void 0:u.message_request_uuid)&&void 0!==o?o:l,stream:e,timestamp:Number(new Date),uuid:n})}),l}}},useRegistration:function(n,u){return{subscribe:function(c,a){var f,p,b,m,h,O,w,j,_,I,S,C,A,Z=Object.keys(null!==(f=null==v||null===(p=v.current)||void 0===p||null===(b=p[n])||void 0===b||null===(m=b.streams)||void 0===m||null===(h=m[u])||void 0===h?void 0:h.consumers)&&void 0!==f?f:{});y("useRegistration.subscribe.before",n,u,c,a,Z),(0,g.mv)(null!==(O=null==v?void 0:v.current)&&void 0!==O?O:{},[n,"options"].join("."),a),(0,g.mv)(null!==(w=null==v?void 0:v.current)&&void 0!==w?w:{},[n,"streams",u,"options"].join("."),a),(0,g.mv)(null!==(j=null==v?void 0:v.current)&&void 0!==j?j:{},[n,"streams",u,"consumers",c,"options"].join("."),a),function(n,u){var c;n in d.current&&u in v.current[n].streams||(T().length>=k?y("Max open connections reached: ".concat(null===(c=T())||void 0===c?void 0:c.length," of ").concat(k)):function c(a){!function(d){var v,f=E(E({},a),d),p=f.onError,b=f.onOpen;s.current=function(n){y("useEventStreams.onopen",m,n);var e=i.Wk.OPEN;b&&(null==b||b(e,n))},l.current=function(l){var i,c;if(console.error("EventSource for channel ".concat(n," and stream ").concat(u," failed with error"),l),N(n),p&&(null==p||p(l)),e){(i=t.current)[n]||(i[n]=r),t.current[n]-=1;var s=t.current[n];s<=0||(clearTimeout(null==o||null===(c=o.current)||void 0===c?void 0:c[n]),o.current[n]=setTimeout((function(){y("Reconnecting to server with ".concat(s," attempt(s) remaining...")),R(n,u)}),1e3*(r-s+1)))}},t.current[n]=null!==(v=t.current[n])&&void 0!==v?v:r,R(n,u);var m=P(n);m?P(n):c()}({onError:function(n){var e;null!=a&&a.onError&&(null==a||null===(e=a.onError)||void 0===e||e.call(a,n))},onOpen:function(n,e){var r;null!=a&&a.onOpen&&(null==a||null===(r=a.onOpen)||void 0===r||r.call(a,n,e))}})}())}(n,u,E(E({},a),{},{onOpen:function(n,e){var r;null!=a&&a.onOpen&&(null==a||null===(r=a.onOpen)||void 0===r||r.call(a,n,e))}}));var D=Object.keys(null!==(_=null==v||null===(I=v.current)||void 0===I||null===(S=I[n])||void 0===S||null===(C=S.streams)||void 0===C||null===(A=C[u])||void 0===A?void 0:A.consumers)&&void 0!==_?_:{});y("useRegistration.subscribe.after",n,u,c,a,D)},unsubscribe:function(e){var r,t,o,l,i;null==v||(null===(r=v.current)||void 0===r||(null===(t=r[n])||void 0===t||(null===(o=t.streams)||void 0===o||(null===(l=o[u])||void 0===l||(null===(i=l.consumers)||void 0===i||delete i[e])))))}}}}}var R=r(28862),P=r(43406),j=r(21547),N=r(78151),T=r(69419),_=r(27441),I=r(47822),S=r(81728);function C(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);e&&(u=u.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,u)}return r}function A(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){(0,f.Z)(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function Z(n,e,r,u,t){for(var o,l,i=null!=t?t:{},c=i.changeRoute,s=i.pipeline,a={},d=u;d;){var v;a[d.uuid]=d,d=null===(v=d)||void 0===v?void 0:v.parent}var f=A(A({},n),{},{index:r,label:null!==(o=n.name)&&void 0!==o?o:n.uuid,level:e,onClick:function(e){var r=(0,_.J)(n,a);t.hideMenu(),c({route:{href:"/v2/pipelines/".concat(null==s?void 0:s.uuid,"/").concat(P.q6.RAG,"/").concat(r.join("/")),query:{slug:[(0,T.wL)(P.q6.RAG)].concat(r).filter(Boolean),uuid:null==s?void 0:s.uuid},pathname:"/v2/pipelines/[uuid]/[...slug]"}},{transitionOnly:!0})},parent:u}),p=null==n||null===(l=n.children)||void 0===l?void 0:l.map((function(n,r){return Z(n,e+1,r,(0,g.p$)(f),t)}));return A(A({},f),{},{items:p})}function D(n){var e=n.changeRoute,r=n.framework,u=n.pipeline,t=n.hideMenu,o=[];return(0,I.C)(r).groupsByLevel.forEach((function(n,l){var i=0===l?"".concat(r.name," pipelines"):1===l?"Stages":"Operations",c={Icon:0===l?R.vd:1===l?R.X53:R.pPy,label:i,uuid:(0,S.kE)(i)},s=n.map((function(n,r){return Z(n,l,r,(0,g.p$)(c),{changeRoute:e,pipeline:u,hideMenu:t})}));o.push(A(A({},c),{},{items:s}))})),o}var x=r(28598),M=v()((function(){return r.e(2510).then(r.bind(r,12510))}),{ssr:!1,loadableGenerated:{webpack:function(){return[12510]}}});function U(n){var e=n.slug,o=n.uuid,s=(0,a.useRef)(null),d=(0,a.useRef)(null),v=(0,a.useContext)(j.VY),f=v.changeRoute,p=v.header,b=v.page,h=(0,a.useContext)(c.pl),g=h.removeContextMenu,O=h.renderContextMenu,E=h.shouldPassControl,k=h.useMenu,y=(0,a.useState)(null),N=y[0],T=y[1],_=(0,a.useMemo)((function(){var n=null!=e?e:[];return Array.isArray(n)||(n=[n]),n}),[e])[0],I=(0,a.useMemo)((function(){return[o].concat((0,t.Z)(Array.isArray(e)?e:[e])).join("/")}),[e,o]),S=k({containerRef:d,contextMenuRef:s,uuid:I}).hideMenu,C=(0,m.Tu)({id:o,idParent:_,resource:"pipelines",resourceParent:"execution_frameworks"},{automaticAbort:!1,handlers:{detail:{onSuccess:function(n){var r,u,t,o,l,i,c,s;null==p||null===(r=p.setHeader)||void 0===r||r.call(p,{intraAppNavItems:D({changeRoute:f,framework:null==n?void 0:n.framework,pipeline:n,hideMenu:function(){return S("NavigationButtonGroup")}}),buildInterAppNavItems:function(){return[{Icon:R.nbx,linkProps:{href:"/pipelines"},uuid:"pipelines"},{Icon:R.IbL,linkProps:{href:"/v2/pipelines/[uuid]/[...slug]",as:"/v2/pipelines/".concat(null==N?void 0:N.uuid,"/").concat(null==e?void 0:e.join("/"))},uuid:"frameworks"}]},cacheKey:[n.uuid,null==n?void 0:n.framework.uuid].join(":"),navTag:null!==(u=null==n||null===(t=n.framework)||void 0===t?void 0:t.name)&&void 0!==u?u:null==n||null===(o=n.framework)||void 0===o||null===(l=o.uuid)||void 0===l?void 0:l.toUpperCase(),selectedNavItem:"frameworks",title:null!==(i=n.name)&&void 0!==i?i:n.uuid,uuid:I,version:1}),null==b||null===(c=b.setPage)||void 0===c||c.call(b,{title:null!==(s=P.qN[null==n?void 0:n.framework.uuid])&&void 0!==s?s:null==n?void 0:n.framework.uuid}),T(n)}}}}),A=(0,a.useRef)(0),Z=(0,a.useRef)(null),U=(0,a.useRef)(null),L=(0,a.useRef)(null),B=(0,a.useRef)(null),G=w({onMessage:function(n){var e,r,u,t,o;B.current||(B.current=b.title);var l,c=null==n||null===(e=n.result)||void 0===e?void 0:e.status;if(i.YI.INIT===c)return Z.current=null,U.current=null,L.current=null,void((null==b?void 0:b.setPage)&&(null==b||null===(l=b.setPage)||void 0===l||l.call(b,{busy:!1,error:!1,notice:!1,success:!1,title:B.current})));var s,a=null==n||null===(r=n.result)||void 0===r?void 0:r.type,d=null==n||null===(u=n.result)||void 0===u||null===(t=u.process)||void 0===t?void 0:t.message_request_uuid;null!=n&&null!==(o=n.result)&&void 0!==o&&o.error&&(Z.current=null==n||null===(s=n.result)||void 0===s?void 0:s.error);var v=i.YI.ERROR===c||i.YI.FAILURE===c||Z.current,f=i.YI.SUCCESS===c&&[i.XM.DATA,i.XM.OUTPUT].includes(a)&&(!L.current||!L.current.error||U.current!==d),p=[i.YI.CANCELLED,i.YI.INTERRUPTED,i.YI.TERMINATED].includes(c)&&i.XM.STATUS===a,m=i.YI.RUNNING===c&&i.XM.STATUS===a&&(!L.current||!L.current.error&&!L.current.success||U.current!==d);if(v||f||m||p){var h,g={busy:m,error:Boolean(v),notice:p,success:f,title:void 0};Z.current&&(g.title=Z.current.exception),(null==b?void 0:b.setPage)&&(null==b||null===(h=b.setPage)||void 0===h||h.call(b,g)),L.current=g}U.current=d}}),Y=G.teardown,X=G.useExecuteCode,q=G.useRegistration;return(0,a.useEffect)((function(){if(0===A.current&&!N){C.detail.mutate();var n=function(){var n=(0,u.Z)(l().mark((function n(){return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([r.e(1237),r.e(3528),r.e(3450)]).then(r.bind(r,3528)).then((function(n){n.Manager.loadServices(),A.current=2}));case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}var e=function(){var n=(0,u.Z)(l().mark((function n(){return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([r.e(1237),r.e(3528),r.e(3450)]).then(r.bind(r,3528)).then((function(n){n.Manager.dispose()}));case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return function(){e(),Y()}}),[N]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(M,{framework:null==N?void 0:N.framework,pipeline:N,useExecuteCode:X,useRegistration:q,containerRef:d,renderContextMenu:O,removeContextMenu:g,shouldPassControl:E}),(0,x.jsx)("div",{id:["pipeline-detail",I].join(":"),ref:s})]})}U.getInitialProps=function(){var n=(0,u.Z)(l().mark((function n(e){var r,u,t,o;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=null!==(r=e.query)&&void 0!==r?r:{slug:[],uuid:null},t=u.slug,o=u.uuid,n.abrupt("return",{slug:t,uuid:o,version:N.A.V2});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();var L=(0,s.Z)(U)},78151:function(n,e,r){"use strict";var u;r.d(e,{A:function(){return u}}),function(n){n.V2="v2"}(u||(u={}))},32080:function(n,e,r){"use strict";r.d(e,{nG:function(){return a},sV:function(){return d}});var u=r(75582),t=r(21831),o=r(82394),l=r(44425),i=r(61599);function c(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);e&&(u=u.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,u)}return r}function s(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){(0,o.Z)(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function a(n){var e,r={};return null==n||null===(e=n.blocks)||void 0===e||e.forEach((function(n){var e=n.catalog,u=n.type,t=n.uuid;if(l.tf.DATA_LOADER===u&&null!=e&&e.streams){var o,c=null==e||null===(o=e.streams)||void 0===o?void 0:o.filter((function(n){var e=n.replication_method;return i._B.INCREMENTAL===e}));(null==c?void 0:c.length)>=1&&(t in r||(r[t]={block:n,streams:[]}),r[t].streams.push(c))}})),r}function d(n,e,r,o){var i,c=r||{},a=c.addBlockDependenciesToNestedPipelineBlocks,v=void 0!==a&&a,f=c.addPipelineGroupsToBlocks,p=void 0!==f&&f,b=c.addPipelineToBlocks,m=void 0!==b&&b,h=c.excludeBlockTypes,g=o||{},O=g.downstreamBlocks,E=g.upstreamBlocks,k={};return null==n||null===(i=n.blocks)||void 0===i||i.forEach((function(o){var i,c,a=s({},o);(!O||null!=a&&a.downstream_blocks?!E||null!=a&&a.upstream_blocks||(a.upstream_blocks=E):a.downstream_blocks=O,m&&(a.pipeline=n),p)&&(a.groups=[].concat((0,t.Z)(null!==(i=n.groups)&&void 0!==i?i:[]),(0,t.Z)(null!==(c=a.groups)&&void 0!==c?c:[])));if(l.tf.PIPELINE===a.type){var f,b=e[a.uuid],g={};if(v)null===(f=[["downstreamBlocks",a.downstream_blocks],["upstreamBlocks",a.upstream_blocks]])||void 0===f||f.forEach((function(n){var r=(0,u.Z)(n,2),t=r[0],o=r[1];null==o||o.forEach((function(n){if(n in e){var r,u=e[n];g[t]||(g[t]=[]),null==u||null===(r=u.blocks)||void 0===r||r.forEach((function(n){var e,r;("downstreamBlocks"!==t||null!=n&&null!==(e=n.upstream_blocks)&&void 0!==e&&e.length)&&("upstreamBlocks"!==t||null!=n&&null!==(r=n.downstream_blocks)&&void 0!==r&&r.length)||g[t].push(null==n?void 0:n.uuid)}))}else g[t]||(g[t]=[]),g[t].push(n)}))}));k=s(s({},k),d(b,e,r,g))}h&&h.includes(a.type)||(k[a.uuid]=a)})),k}},91330:function(n,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/v2/pipelines/[uuid]/[...slug]",function(){return r(6593)}])}},function(n){n.O(0,[9635,3446,5070,5990,1041,2199,9774,2888,179],(function(){return e=91330,n(n.s=e);var e}));var e=n.O();_N_E=e}]);